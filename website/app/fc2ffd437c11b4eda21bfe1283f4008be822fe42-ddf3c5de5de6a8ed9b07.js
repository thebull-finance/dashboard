(self.webpackChunkzignaly_webapp=self.webpackChunkzignaly_webapp||[]).push([[700],{45893:function(e,t,n){"use strict";var r=n(54038),a=n(82277),i=n(91951),o=n(67294),l=n(2585),s=n(70628),c=n(20683),u=n(55786),m=n(63633),d=n(70802),p=n(40395),f=o.forwardRef((function(e,t){var n=e.children,c=e.classes,f=e.className,g=e.collapsedHeight,v=e.collapsedSize,h=void 0===v?"0px":v,y=e.component,E=void 0===y?"div":y,x=e.disableStrictModeCompat,b=void 0!==x&&x,P=e.in,Z=e.onEnter,I=e.onEntered,w=e.onEntering,_=e.onExit,S=e.onExited,C=e.onExiting,N=e.style,T=e.timeout,D=void 0===T?u.x9.standard:T,L=e.TransitionComponent,k=void 0===L?s.ZP:L,A=(0,i.Z)(e,["children","classes","className","collapsedHeight","collapsedSize","component","disableStrictModeCompat","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"]),z=(0,d.Z)(),O=o.useRef(),M=o.useRef(null),j=o.useRef(),F="number"==typeof(g||h)?"".concat(g||h,"px"):g||h;o.useEffect((function(){return function(){clearTimeout(O.current)}}),[]);var R=z.unstable_strictMode&&!b,B=o.useRef(null),V=(0,p.Z)(t,R?B:void 0),U=function(e){return function(t,n){if(e){var r=R?[B.current,t]:[t,n],i=(0,a.Z)(r,2),o=i[0],l=i[1];void 0===l?e(o):e(o,l)}}},W=U((function(e,t){e.style.height=F,Z&&Z(e,t)})),G=U((function(e,t){var n=M.current?M.current.clientHeight:0,r=(0,m.C)({style:N,timeout:D},{mode:"enter"}).duration;if("auto"===D){var a=z.transitions.getAutoHeightDuration(n);e.style.transitionDuration="".concat(a,"ms"),j.current=a}else e.style.transitionDuration="string"==typeof r?r:"".concat(r,"ms");e.style.height="".concat(n,"px"),w&&w(e,t)})),H=U((function(e,t){e.style.height="auto",I&&I(e,t)})),q=U((function(e){var t=M.current?M.current.clientHeight:0;e.style.height="".concat(t,"px"),_&&_(e)})),Q=U(S),Y=U((function(e){var t=M.current?M.current.clientHeight:0,n=(0,m.C)({style:N,timeout:D},{mode:"exit"}).duration;if("auto"===D){var r=z.transitions.getAutoHeightDuration(t);e.style.transitionDuration="".concat(r,"ms"),j.current=r}else e.style.transitionDuration="string"==typeof n?n:"".concat(n,"ms");e.style.height=F,C&&C(e)}));return o.createElement(k,(0,r.Z)({in:P,onEnter:W,onEntered:H,onEntering:G,onExit:q,onExited:Q,onExiting:Y,addEndListener:function(e,t){var n=R?e:t;"auto"===D&&(O.current=setTimeout(n,j.current||0))},nodeRef:R?B:void 0,timeout:"auto"===D?null:D},A),(function(e,t){return o.createElement(E,(0,r.Z)({className:(0,l.default)(c.root,c.container,f,{entered:c.entered,exited:!P&&"0px"===F&&c.hidden}[e]),style:(0,r.Z)({minHeight:F},N),ref:V},t),o.createElement("div",{className:c.wrapper,ref:M},o.createElement("div",{className:c.wrapperInner},n)))}))}));f.muiSupportAuto=!0,t.Z=(0,c.Z)((function(e){return{root:{height:0,overflow:"hidden",transition:e.transitions.create("height")},entered:{height:"auto",overflow:"visible"},hidden:{visibility:"hidden"},wrapper:{display:"flex"},wrapperInner:{width:"100%"}}}),{name:"MuiCollapse"})(f)},61986:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(67294),a=n(82245),i=n(45893),o=n(80951),l=n(49829),s=n(49599),c=function(e){var t=e.onClose,n=e.onClear,c=e.title,u=e.open,m=e.children;return r.createElement(s.Z,{condition:void 0!==u,wrapper:function(e){return r.createElement(i.Z,{in:u,unmountOnExit:!0},e)}},r.createElement(a.Z,{alignItems:"center",className:"customFilters",display:"flex",flexDirection:"row",justifyContent:"space-between"},r.createElement(a.Z,{alignItems:"center",className:"filters",display:"flex",flexDirection:"row",justifyContent:"flex-start"},c&&r.createElement("span",{className:"title"},c),m),r.createElement(a.Z,{alignItems:"center",className:"actions",display:"flex",flexDirection:"row",justifyContent:"space-between"},n&&r.createElement(l.Z,{className:"textPurple",onClick:function(){return n()},startIcon:r.createElement("img",{className:"icon iconPurple",src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNSIgdmlld0JveD0iMCAwIDI0IDI1Ij4KICAgIDxwYXRoIGZpbGw9IiM3NzBGQzgiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTE3LjMxOCAxNi45NThsLTQuMjA5LTQuMjA4IDQuMjA4LTQuMjA3Yy4yNDQtLjI0NC4yNDQtLjYzOSAwLS44ODNsLS45NzctLjk3N2MtLjI0NC0uMjQ0LS42MzktLjI0NC0uODgzIDBMMTEuMjUgMTAuODkgNy4wNDIgNi42ODNjLS4yNDMtLjI0My0uNjM4LS4yNDMtLjg4MiAwbC0uOTc3Ljk3OGMtLjI0NC4yNDMtLjI0NC42MzggMCAuODgyTDkuMzkgMTIuNzVsLTQuMjA4IDQuMjA4Yy0uMjQzLjI0My0uMjQzLjYzOCAwIC44ODJsLjk3Ny45NzdjLjI0NC4yNDQuNjM5LjI0NC44ODIgMGw0LjIwOC00LjIwNyA0LjIwOCA0LjIwN2MuMjQzLjI0NC42MzguMjQ0Ljg4MiAwbC45NzgtLjk3N2MuMjQzLS4yNDQuMjQzLS42MzkgMC0uODgyeiIvPgo8L3N2Zz4K"})},r.createElement(o.Z,{id:"fil.clearall"})),t&&r.createElement(l.Z,{className:"textPurple",onClick:function(){return t()},startIcon:r.createElement("img",{className:"icon iconPurple",src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNSIgaGVpZ2h0PSIyNSIgdmlld0JveD0iMCAwIDI1IDI1Ij4KICAgIDxwYXRoIGZpbGw9IiM3NzBGQzgiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTE4LjYwNCAxNC45NTZMMTIuNTMgOC44ODNjLS4yOTMtLjI5My0uNzY3LS4yOTMtMS4wNiAwbC02LjA3NCA2LjA3M2MtLjI5Mi4yOTMtLjI5Mi43NjggMCAxLjA2bC43MDkuNzFjLjI5Mi4yOTIuNzY2LjI5MiAxLjA2IDBMMTIgMTEuOTEzbDQuODM2IDQuODEzYy4yOTMuMjkyLjc2Ny4yOTIgMS4wNiAwbC43MDgtLjcxYy4yOTItLjI5Mi4yOTItLjc2NyAwLTEuMDZ6Ii8+Cjwvc3ZnPgo="})},r.createElement(o.Z,{id:"fil.hide"})))))}},23082:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var r=n(67294),a=n(82245),i=n(60454),o=n(49829),l=n(80951),s=n(59694),c=n(796),u=n(18415),m=function(e){var t=e.onClose,n=(0,c.Z)().exchanges;return r.createElement(a.Z,{alignItems:"center",className:"connectExchangeModal",display:"flex",flexDirection:"column"},r.createElement(i.Z,{variant:"h3"},r.createElement(l.Z,{id:"accounts.connect"})),r.createElement(i.Z,{variant:"body1"},r.createElement(l.Z,{id:"accounts.connect.first",values:{exchanges:(0,u.M)(n,"or")}})),r.createElement(a.Z,{className:"real",display:"flex",flexDirection:"column"},r.createElement(i.Z,{variant:"h4"},r.createElement(l.Z,{id:"accounts.create.or"})),r.createElement(o.Z,{className:"body2 bgPurple exchangeButton",onClick:function(){t&&t(),(0,s.navigate)("#exchangeAccounts")}},r.createElement(l.Z,{id:"accounts.connect.go"}))))}},18259:function(e,t,n){"use strict";n.d(t,{t5:function(){return mn},Vr:function(){return vn}});var r=n(48634),a=n(42656),i=n.n(a),o=n(67294),l=n(19199),s=n(82825),c=n(45850),u=n(55750),m=n(2580),d=n.n(m),p=n(51028),f=n(10928),g=n.n(f),v=n(41609),h=n.n(v);function y(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var x=function(){function e(e){this.symbolsData=e.symbolsData||null,this.exchange=e.exchange.exchangeName||"",this.baseUrl="https://zignaly.com/api".replace("/api",""),this.allCandles=[]}var t=e.prototype;return t.onReady=function(e){var t=["1","5","15","30","60","120","240","360","720","D","W"];setTimeout((function(){e({supports_marks:!1,supports_timescale_marks:!1,supports_time:!1,supported_resolutions:t})}),0)},t.resolveSymbol=function(e,t,n){for(var r,a=this,i=y(this.symbolsData);!(r=i()).done;){var o=r.value,l=o.base+o.quote,s=Math.round(1/o.limits.price.min);if(o.tradeViewSymbol.toLowerCase()===e.toLowerCase()){var c=function(){var e={base_name:[o.base],base:o.unitsAmount,quote:o.unitsInvestment,description:o.symbol,exchange:a.exchange,full_name:o.symbol,has_daily:!0,has_intraday:!0,has_weekly_and_monthly:!0,listed_exchange:a.exchange,minmov:1,name:o.symbol,pricescale:s,session:"24x7",data_status:"streaming",ticker:l,type:"spot"};return setTimeout((function(){t(e)}),0),{v:void 0}}();if("object"==typeof c)return c.v}}setTimeout((function(){n("not found")}))},t.getBarsRequest=function(e,t,n){throw new Error("must be implemented by subclass!")},t.getBars=function(e,t,n,r,a){var i=this,o=n.from,l=n.firstDataRequest;l&&(this.allCandles=[]);l&&(this.startDate=o),this.getBarsRequest(e,t,n).then((function(e){i.allCandles=i.allCandles.concat(e),function(e){0===e.length?r([],{noData:!0}):r(e,{noData:!1})}(e)})).catch((function(e){a("ERROR: "+e.message)}))},t.subscribeBars=function(e,t,n){var r=this;this.candleSubscription=setInterval((function(){r.refreshBarRequest(e,t).then((function(e){e&&n(e)})).catch((function(e){console.error("ERROR: "+e.message)}))}),15e3)},t.refreshBarRequest=function(e,t){throw new Error("must be implemented by subclass!")},t.unsubscribeBars=function(){clearInterval(this.candleSubscription)},t.getLastPrice=function(){return h()(this.allCandles)?null:g()(this.allCandles).close},e}(),b=x,P=function(e){function t(){return e.apply(this,arguments)||this}(0,u.Z)(t,e);var n=t.prototype;return n.getCandlesData=function(){var e=(0,r.Z)(i().mark((function e(t,n,r,a,o){var l,s,c,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l="/tradingview?lang=en&coin="+t+"&currency="+n+"&resolution="+r+"&from="+a,o&&(l+="&to="+o),s=this.baseUrl+l,e.prev=3,e.next=6,fetch(s);case 6:return c=e.sent,e.next=9,c.json();case 9:return u=e.sent,e.abrupt("return",u);case 13:e.prev=13,e.t0=e.catch(3),console.error("Get candles data error: "+e.t0.message);case 16:return e.abrupt("return",[]);case 17:case"end":return e.stop()}}),e,this,[[3,13]])})));return function(t,n,r,a,i){return e.apply(this,arguments)}}(),n.parseOHLCV=function(e){return{time:parseFloat(e.time),open:parseFloat(e.open),high:parseFloat(e.high),low:parseFloat(e.low),close:parseFloat(e.close),volume:parseFloat(e.volume)}},n.getBarsRequest=function(e,t,n){var r=this,a=n.from,i=n.to;return this.getCandlesData(e.base.toLowerCase(),e.quote.toLowerCase(),(0,p.Ly)(t),a,d().unix(i).startOf("minute").unix()).then((function(e){return e.map(r.parseOHLCV)}))},n.refreshBarRequest=function(e,t){var n=this;return this.getCandlesData(e.base.toLowerCase(),e.quote.toLowerCase(),(0,p.Ly)(t),this.startDate,d()().startOf("minute").unix()).then((function(e){if(e.length){var t=e[e.length-1];return n.parseOHLCV(t)}return{}}))},t}(b),Z=P,I=function(e){function t(){return e.apply(this,arguments)||this}(0,u.Z)(t,e);var n=t.prototype;return n.getCandlesData=function(){var e=(0,r.Z)(i().mark((function e(t,n,r,a,o){var l,s,c,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l="/tradingview/ascendex?symbol="+t+"/"+n+"&interval="+r+"&from="+a,o&&(l+="&to="+o),s=this.baseUrl+l,e.prev=3,e.next=6,fetch(s);case 6:return c=e.sent,e.next=9,c.json();case 9:return u=e.sent,e.abrupt("return",u);case 13:e.prev=13,e.t0=e.catch(3),console.error("Get candles data error: "+e.t0.message);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,this,[[3,13]])})));return function(t,n,r,a,i){return e.apply(this,arguments)}}(),n.parseOHLCV=function(e){return{time:parseFloat(e.ts),open:parseFloat(e.o),high:parseFloat(e.h),low:parseFloat(e.l),close:parseFloat(e.c),volume:parseFloat(e.v)}},n.getBarsRequest=function(e,t,n){var r=this,a=n.from,i=n.to;return this.getCandlesData(e.base.toUpperCase(),e.quote.toUpperCase(),t,1e3*a,d().unix(i).startOf("minute").valueOf()).then((function(e){return e?e.data.map((function(e){return r.parseOHLCV(e.data)})):[]}))},n.refreshBarRequest=function(e,t){var n=this;return this.getCandlesData(e.base.toUpperCase(),e.quote.toUpperCase(),t,1e3*this.startDate,d()().startOf("minute").valueOf()).then((function(e){if(e&&e.data.length){var t=e.data[e.data.length-1];return n.parseOHLCV(t.data)}return{}}))},t}(b),w=I;function _(e){var t=e.exchange,n=e.symbolsData,r=e.symbol,a=e.darkStyle,i=function(e){var t=null;return"vcce"===e.exchange.exchangeName.toLowerCase()?t=new Z(e):"ascendex"===e.exchange.exchangeName.toLowerCase()&&(t=new w(e)),t}({exchange:t,symbolsData:n});return Object.assign({},i&&{datafeed:i,library_path:"/app/charting_library/charting_library/"},{autosize:!0,charts_storage_api_version:"1.1",charts_storage_url:"https://saveload.tradingview.com",client_id:"tradingview.com",container_id:"trading_view_chart",disabled_features:["header_symbol_search"],enabled_features:["use_localstorage_for_settings","save_chart_properties_to_local_storage","countdown"],fullscreen:!1,hide_side_toolbar:!1,interval:"30",locale:"en",studies_overrides:{},symbol:r,theme:a?"dark":"light",user_id:"public_user_id",timezone:Intl.DateTimeFormat().resolvedOptions().timeZone})}var S=n(50308),C=n.n(S),N=n(62620),T=n.n(N),D=n(96026),L=n.n(D),k=n(13218),A=n.n(k),z=n(23560),O=n.n(z),M=n(57043),j=n.n(M),F=n(28583),R=n.n(F),B=(n(17727),n(66735)),V=n(80951),U=n(25444),W=n(82245),G=n(95563),H=n(82469),q=n(70899),Q=n(59761),Y=n(54846),J=n(66718),$=function(e,t){return e+e*t/100},K=function(e,t,n){var r=n.contractType,a=n.multiplier,i=void 0===a?1:a;return"inverse"===r?t*e/i:e/(t*i)},X=n(49829),ee=n(52628),te=n.n(ee),ne=n(12297),re=n.n(ne),ae=n(84238),ie=n.n(ae),oe=n(27049),le=n(60454),se=n(54612),ce=n(57053),ue=(0,ce.Z)(o.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"}),"AddCircle"),me=(0,ce.Z)(o.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11H7v-2h10v2z"}),"RemoveCircle"),de=n(67938),pe=n(4445),fe=function(e){var t=e.labelId,n=e.descriptionId,r=(0,B.Z)();return o.createElement(W.Z,{alignItems:"end",className:"help",display:"flex",flexDirection:"row"},o.createElement(pe.ZP,{arrow:!0,enterTouchDelay:50,placement:"left-end",title:r.formatMessage({id:n})},o.createElement(de.Z,null,o.createElement(V.Z,{id:t}))))},ge=o.memo(fe),ve=n(14536),he=function(e){var t=e.profitTarget,n=e.labelId,r=(0,B.Z)().formatMessage,a=G.O.darkGrey;if(!t)return o.createElement(W.Z,null);var i=r({id:"terminal.status.pending"});return!t.done&&t.orderId?(a=G.O.blue,i=r({id:"terminal.status.placed"},{orderId:t.orderId})):t.done?(i=r({id:"terminal.status.done"}),a=G.O.green):t.skipped&&(i=r({id:"terminal.status.failed"}),a=G.O.red),o.createElement(W.Z,{alignItems:"center",className:"targetStatus",display:"flex",justifyContent:"flex-end"},o.createElement(de.Z,null,o.createElement(V.Z,{id:n})),o.createElement(pe.ZP,{arrow:!0,enterTouchDelay:50,placement:"left-end",title:i},o.createElement(ve.Z,{style:{fill:a}})))},ye=o.memo(he),Ee=function(e){void 0===e&&(e=!1);var t=(0,o.useState)(e),n=t[0];return{expanded:n,expandClass:n?"expanded":"collapsed",setExpanded:t[1]}},xe=n(11700),be=n.n(xe),Pe=n(68929),Ze=n.n(Pe);function Ie(e){var t=document.getElementsByName(e)[0]||null;if(t&&t._valueTracker){t._valueTracker.setValue("");var n=new Event("input",{bubbles:!0});t.dispatchEvent(n)}}var we=function(e,t){void 0===t&&(t=1);var n=(0,o.useState)(t),r=n[0],a=n[1],i=(0,s.Gc)(),l=i.getValues,c=i.setValue,u=L()(1,r+1,1).map(String);(0,o.useEffect)((function(){a(t)}),[t]);var m=function(t,n){return Ze()(e)+be()(""+t+n)};return{cardinality:r,cardinalityRange:u,composeTargetPropertyName:m,getGroupTargetId:function(e){return e.target.closest(".targetGroup").getAttribute("data-target-id")},getTargetPropertyValue:function(e,t){var n=l(),r=m(e,t);return parseFloat(n[r])},getTargetPropertyRawValue:function(e,t){return l()[m(e,t)]},handleTargetAdd:function(){a(r+1)},handleTargetRemove:function(){r>0&&a(r-1)},setTargetPropertyValue:function(e,t,n){var r=m(e,t);return c(r,n)},simulateInputChangeEvent:Ie}},_e=o.createContext({});var Se=function(e){var t=(0,s.Gc)().watch,n=(0,o.useContext)(_e).lastPrice,r=t("price"),a=t("units"),i=t("positionSize"),l=t("priceDifference"),c=parseFloat(r)||n;return{getEntryPrice:function(){return e?e.buyPrice:c},getEntryPricePercentChange:function(){return e&&(l||e.priceDifference)||0},getEntrySize:function(){return e?e.amount:parseFloat(a)||0},getEntrySizeQuote:function(){return e?e.positionSizeQuote:parseFloat(i)||0},getProfitPercentage:function(){return e?e.profitPercentage:0}}},Ce=n(10551),Ne=n.n(Ce),Te=n(32304),De=n.n(Te),Le=function(){var e=(0,B.Z)().formatMessage;return{lessThan:function(t,n,r,a,i){void 0===i&&(i={});var o="LONG"===r.toUpperCase()?"lower":"greater";return("LONG"===r.toUpperCase()?De():Ne())(t,n)||e({id:a+"."+o},i)},greaterThan:function(t,n,r,a,i){void 0===i&&(i={});var o="LONG"===r.toUpperCase()?"greater":"lower";return("LONG"===r.toUpperCase()?Ne():De())(t,n)||e({id:a+"."+o},i)},validPercentage:function(t,n){return t>0&&t<=100||e({id:n})}}},ke=n(16991),Ae=function(e){var t=e.limits,n=e.contractType,r=(0,B.Z)().formatMessage;return{validateCostLimits:function(e,a){var i="inverse"===n?t.amount:t.cost;return!i||(i.min&&e<i.min?r({id:a+".mincost"},{value:i.min}):!(i.max&&e>i.max)||r({id:a+".maxcost"},{value:i.max}))},validateUnitsLimits:function(e,a){var i="inverse"===n?t.cost:t.amount;return!i||(i.min&&e<i.min?r({id:a+".minunits"},{value:i.min}):!(i.max&&e>i.max)||r({id:a+".maxunits"},{value:i.max}))},validateTargetPriceLimits:function(e,n){return!t.price||(t.price.min&&e<t.price.min?r({id:n+".minprice"},{value:t.price.min}):!(t.price.max&&e>t.price.max)||r({id:n+".maxprice"},{value:t.price.max}))}}},ze=n(96693),Oe=n(45685),Me=function(e){var t=e.name,n=void 0===t?"postOnly":t,r=e.disabled,a=void 0!==r&&r,i=e.exchange,l=(0,s.Gc)().control,c=(0,Q.Z)();return["vcce","kucoin"].includes((i||c.exchangeName).toLowerCase())?null:o.createElement(Oe.Z,{className:"customCheckbox",control:o.createElement(s.Qr,{control:l,defaultValue:!1,name:n,render:function(e){var t=e.onChange,n=e.value;return o.createElement(ze.Z,{checked:n,disabled:a,onChange:function(e){return t(e.target.checked)}})}}),label:o.createElement(ge,{descriptionId:"terminal.postonly.help",labelId:"terminal.postonly"})})},je=n(88475),Fe=function(e){var t=e.percentage,n=e.price,r=e.disabled,a=e.quote,i=e.priorityName,l=e.defaultPriority,c=void 0===l?"percentage":l,u=e.labelId,m=e.labelDescriptionId,d=e.status,p=(0,s.Gc)(),f=p.errors,g=p.register,v=p.watch,h=p.setValue,y=v(i,c),E=(0,B.Z)(),x=function(){r||h(i,"price"===y?"percentage":"price")};return o.createElement(W.Z,{className:"pricePercentageControl"},o.createElement(W.Z,{className:"pricePercentageInputs",display:"flex",flexDirection:"row",flexWrap:"wrap"},o.createElement(ge,{descriptionId:m,labelId:u}),d,o.createElement(W.Z,{alignItems:"center",className:"pricePercentageInput "+(r?"readOnly":"")+" "+("price"===y?"disabled":""),display:"flex",onClick:function(){return"price"===y&&x()}},o.createElement(je.Z,{allowNegative:Boolean(t.allowNegative),disabled:r||"price"===y,name:t.name,onChange:t.onChange,rules:{validate:t.validate||{positive:function(e){return e>=0||t.error}}},showErrorMessage:!1}),o.createElement(pe.ZP,{arrow:!0,enterTouchDelay:50,placement:"left-end",title:E.formatMessage({id:"terminal.percentage.priority.help"})},o.createElement("div",{className:"currencyBox"},"% ","price"!==y&&o.createElement("span",{className:"dot"})))),o.createElement(W.Z,{alignItems:"center",className:"pricePercentageInput "+(r?"readOnly":"")+" "+("price"!==y?"disabled":""),display:"flex",onClick:function(){return"price"!==y&&x()}},o.createElement(je.Z,{disabled:r||"price"!==y,name:n.name,onChange:n.onChange,rules:{validate:n.validate||{positive:function(e){return e>=0||n.error}}},showErrorMessage:!1}),o.createElement(pe.ZP,{arrow:!0,enterTouchDelay:50,placement:"left-end",title:E.formatMessage({id:"terminal.price.priority.help"})},o.createElement("div",{className:"currencyBox"},a," ","price"===y&&o.createElement("span",{className:"dot"})))),o.createElement("input",{name:i,ref:g,type:"hidden"})),f[t.name]&&o.createElement("span",{className:"errorText"},f[t.name].message),f[n.name]&&o.createElement("span",{className:"errorText"},f[n.name].message))},Re=function(e){var t=e.symbolData,n=e.positionEntity,r=void 0===n?null:n,a=e.isReadOnly,i=void 0!==a&&a,l=r?ie()(r.takeProfitTargets):0,c=L()(1,l+1,1),u=Ee(l>0),m=u.expanded,d=u.expandClass,p=u.setExpanded,f=Le(),g=f.greaterThan,v=f.validPercentage,h=Ae(t),y=h.validateTargetPriceLimits,E=h.validateCostLimits,x=h.validateUnitsLimits,b=(0,s.Gc)(),P=b.clearErrors,Z=b.errors,I=b.setValue,w=b.watch,_=b.getValues,S=b.trigger,C=b.formState.dirtyFields,N=we("takeProfit",r?Math.max(1,l):1),T=N.cardinality,D=N.cardinalityRange,k=N.composeTargetPropertyName,A=N.getGroupTargetId,z=N.getTargetPropertyValue,O=N.handleTargetAdd,M=N.handleTargetRemove,j=N.setTargetPropertyValue,F=N.simulateInputChangeEvent,R=r?r.side:w("entryType"),U=w("price"),G=w("units"),q=(0,o.useContext)(_e).providerService,Q=q&&"1"!==q.providerId||r&&r.isCopyTrader,Y=Se(r),J=Y.getEntryPrice,$=Y.getEntrySize,K=r?r.takeProfitTargetsCountSuccess:0,X=i||!!r&&T===K,ee=!!r&&r.closed,ne=(0,B.Z)().formatMessage,ae=function(e){var t=r?r.takeProfitTargets[parseInt(e)]:null;return t&&t.done||i},ce=function(){var e={};return c.forEach((function(t){var n=!1;((r?r.takeProfitTargets[t]:{done:!1}).done||i||ee)&&(n=!0),e[k("exitUnitsPercentage",t)]=n,e[k("exitUnits",t)]=n,e[k("targetPrice",t)]=n,e[k("targetPricePercentage",t)]=n,e[k("postOnly",t)]=n})),e}(),de=r?r.takeProfitTargets:{},pe=function(e){var t=J(),n=A(e),r=k("targetPrice",n),a=z("targetPricePercentage",n),i=k("targetPricePercentage",n);if(!Z[i]){var o=t*((a+100)/100);I(r,(0,H.T4)(o,"","")),S(r)}},fe=function(e){var t=J(),n=A(e),r=k("targetPricePercentage",n),a=z("targetPrice",n),i=k("targetPrice",n);if(!Z[i]){var o=(a-t)/t*100;I(r,(0,H.Vj)(o)),S(r)}},ve=function(){var e=D.map((function(e){return k("exitUnitsPercentage",e)})),t=_(e);return!(re()(te()(t).map(Number))>100)||ne({id:"terminal.takeprofit.limit.cumulative"})},he=function(e){var t=$(),n=k("exitUnits",e),r=k("exitUnitsPercentage",e),a=z("exitUnitsPercentage",e);if(!Z[r]){var i=t*(a/100);I(n,(0,H.T4)(i,"","")),C[r]&&S(n)}},xe=function(e){var t=$(),n=A(e),r=k("exitUnitsPercentage",n),a=z("exitUnits",n),i=k("exitUnits",n);if(!Z[i])if(t>0&&a>0){var o=100*(1-(t-a)/t);I(r,(0,H.Vj)(o))}else I(r,"")};(0,o.useEffect)((function(){m?r?r&&c.forEach((function(e){var t=r.takeProfitTargets[e],n=(0,H.Vj)(t.priceTargetPercentage),a=(0,H.T4)(t.priceTarget,"",""),i=(0,H.Vj)(t.amountPercentage);j("targetPricePercentage",e,n),j("targetPrice",e,a),j("priority",e,t.pricePriority),j("exitUnitsPercentage",e,i),j("postOnly",e,t.postOnly)})):be():D.forEach((function(e){P(k("exitUnitsPercentage",e)),P(k("exitUnits",e)),P(k("targetPrice",e)),P(k("targetPricePercentage",e)),I(k("targetPrice",e),"")}))}),[m]);var be=function(){m&&D.forEach((function(e){var t=z("targetPricePercentage",e),n=(0,H.Vj)(Math.abs(t)),r="SHORT"===R?"-":"";if(isNaN(t))j("targetPricePercentage",e,r);else{j("targetPricePercentage",e,""+r+n);var a=k("priority",e);"price"!==_()[a]?F(k("targetPricePercentage",e)):F(k("targetPrice",e))}}))};(0,ke.Z)(be,[R,U]);var Pe=$();(0,o.useEffect)((function(){m&&D.forEach((function(e){he(e)}))}),[m,G,Pe]);(0,o.useEffect)((function(){p(Boolean(l))}),[l]);var Ze=function(e,t){var n=k(e,t);return Z[n]?o.createElement("span",{className:"errorText"},Z[n].message):null},Ie=function(e){return g(parseFloat(e),0,R,"terminal.takeprofit.valid.pricepercentage",{value:0})};return o.createElement(W.Z,{className:"panel takeProfitPanel "+d},o.createElement(W.Z,{alignItems:"center",className:"panelHeader",display:"flex",flexDirection:"row"},!ee&&o.createElement(se.Z,{checked:m,onChange:function(e){return p(e.target.checked)},size:"small"}),o.createElement(W.Z,{alignItems:"center",className:"title",display:"flex",flexDirection:"row"},o.createElement(le.Z,{variant:"h5"},o.createElement(V.Z,{id:"terminal.takeprofit"})))),m&&o.createElement(W.Z,{className:"panelContent",display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-around"},D.map((function(e){return o.createElement(W.Z,{className:"targetGroup","data-target-id":e,key:"target"+e},o.createElement(W.Z,{className:"targetPrice"},o.createElement(Fe,{disabled:ae(e),labelDescriptionId:"terminal.takeprofit.help",labelId:"terminal.target",percentage:{name:k("targetPricePercentage",e),validate:Ie,onChange:pe,allowNegative:!0},price:{name:k("targetPrice",e),onChange:fe,validate:function(e){return y(e,"terminal.takeprofit.limit")}},priorityName:k("priority",e),quote:t.quote,status:o.createElement(ye,{labelId:"terminal.status",profitTarget:de[Number(e)]||null})})),o.createElement(W.Z,{className:"targetUnits",display:"flex",flexDirection:"row",flexWrap:"wrap"},o.createElement(ge,{descriptionId:"terminal.unitstoexit.help",labelId:"terminal.unitstoexit"}),o.createElement(W.Z,{alignItems:"center",display:"flex"},o.createElement(je.Z,{disabled:ae(e),name:k("exitUnitsPercentage",e),onChange:function(){return he(e)},rules:ce[k("exitUnitsPercentage",e)]?null:{validate:{percentage:function(e){return v(e,"terminal.takeprofit.valid.unitspercentage")},sum:ve}},showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},"%")),!Q&&o.createElement(o.Fragment,null,o.createElement(W.Z,{alignItems:"center",display:"flex"},o.createElement(je.Z,{disabled:ae(e),name:k("exitUnits",e),onChange:xe,rules:ce[k("exitUnits",e)]?null:{validate:{positive:function(e){return e>=0||ne({id:"terminal.takeprofit.valid.units"})},limit:function(e){return x(e,"terminal.takeprofit.limit")},cost:function(){return function(e){var t=z("targetPrice",e),n=z("exitUnits",e),r=Math.abs(t*n);return E(r,"terminal.takeprofit.limit")}(e)}}},showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},t.unitsAmount))),Ze("exitUnitsPercentage",e),!Q&&Ze("exitUnits",e)),o.createElement(W.Z,{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"start"},o.createElement(Me,{disabled:ae(e),exchange:null==r?void 0:r.exchange,name:k("postOnly",e)})))})),o.createElement(W.Z,{className:"targetActions",display:"flex",flexDirection:"row",flexWrap:"wrap"},!X&&o.createElement(oe.Z,{className:"removeTarget",onClick:M},o.createElement(me,null),o.createElement(V.Z,{id:"terminal.target.remove"})),!i&&o.createElement(oe.Z,{className:"addTarget",onClick:O},o.createElement(ue,null),o.createElement(V.Z,{id:"terminal.target.add"})))))},Be=o.memo(Re),Ve=n(3674),Ue=n.n(Ve),We=n(18446),Ge=n.n(We),He=n(87022),qe=n(54569),Qe=n(38966),Ye=function(e){var t=e.dcaTarget,n=e.labelId,r=(0,B.Z)().formatMessage,a=G.O.darkGrey,i=r({id:"terminal.status.pending"});return t?(t.done||t.skipped||t.cancel||!t.orderId?t.done&&!t.skipped&&!t.cancel&&t.orderId?(i=r({id:"terminal.status.done"}),a=G.O.green):(t.skipped||t.cancel)&&t.errorMSG&&(i=t.errorMSG||r({id:"terminal.status.failed"}),a=G.O.red):(i=r({id:"terminal.status.placed"},{orderId:t.orderId}),a=G.O.blue),o.createElement(W.Z,{alignItems:"center",className:"targetStatus",display:"flex",justifyContent:"flex-end"},o.createElement(de.Z,null,o.createElement(V.Z,{id:n})),o.createElement(pe.ZP,{arrow:!0,enterTouchDelay:50,placement:"left-end",title:i},o.createElement(ve.Z,{style:{fill:a}})))):o.createElement(W.Z,null)},Je=o.memo(Ye),$e=function(e,t){var n,r;(0,o.useEffect)(e,(n=t,r=(0,o.useRef)(),Ge()(n,r.current)||(r.current=n),r.current))},Ke=function(e){var t=e.positionEntity,n=e.symbolData,r=e.isReadOnly,a=void 0!==r&&r,i=(0,s.Gc)(),l=i.clearErrors,c=i.errors,u=i.register,m=i.setValue,d=i.watch,p=i.trigger,f=i.getValues,g=i.formState.dirtyFields,v=t?t.reBuyTargets:{},h=Se(t),y=h.getEntryPrice,E=h.getEntrySizeQuote,x=(0,B.Z)().formatMessage,b=Le().lessThan,P=function(){var e=Ue()(v).map(Number),n=e.filter((function(e){return e<1e3})),r=e.filter((function(e){return e>=1e3}));return{dcaRebuyDoneCount:(t?n.map((function(e){return v[e]})):[]).filter((function(e){return!0===e.done})).length,dcaAllIndexes:e.map(String),dcaRebuyIndexes:n.map(String),dcaIncreaseIndexes:r.map(String)}}(),Z=P.dcaRebuyDoneCount,I=P.dcaAllIndexes,w=P.dcaRebuyIndexes,_=P.dcaIncreaseIndexes,S=(0,o.useState)(_),C=S[0],N=S[1],T=t?Math.max(_.length?0:1,ie()(w)):1,D=Ee(ie()(I)>0),L=D.expanded,k=D.expandClass,A=D.setExpanded,z=we("dca",T),O=z.cardinality,M=z.cardinalityRange,j=z.composeTargetPropertyName,F=z.getTargetPropertyValue,R=z.handleTargetAdd,U=z.handleTargetRemove,G=z.setTargetPropertyValue,q=Ae(n),Q=q.validateTargetPriceLimits,Y=q.validateCostLimits,J=q.validateUnitsLimits,X=!!t&&t.closed,ee=a||O>=1&&O-1<Z||0===O,te=t?t.side:d("entryType"),ne=d("price"),re=d("positionSize"),ae="percentage";t&&ie()(t.reBuyTargets)&&(ae=Object.values(t.reBuyTargets)[0].pricePriority);var ce=d("DCAPriority",ae),pe=function(e){var t=e.currentTarget.getAttribute("data-target-id"),n=C.filter((function(e){return e!==t}));N(n)},fe=function(e){return Boolean(xe[e])||a},ve=function(e){var t=y(),n=parseFloat(e),r=$(t,n);return Q(r,"terminal.dca.limit")},he=function(e,t){var n=j(e,t);return c[n]?o.createElement("span",{className:"errorText"},c[n].message):null};$e((function(){L&&(t?t&&(Ge()(C,_)||N(_),I.forEach((function(e){var n=t.reBuyTargets[Number(e)],r=(0,Qe.C2)(n.triggerPercentage),a=(0,H.T4)(n.priceTarget),i=(0,Qe.C2)(n.quantity);G("targetPricePercentage",e,r),G("rebuyPrice",e,a),G("rebuyPercentage",e,i),G("postOnly",e,n.postOnly)}))):ye())}),[L,v]);(0,o.useEffect)((function(){M.forEach((function(e){l([j("targetPricePercentage",e),j("rebuyPrice",e)]);var n=ce;if(t){var r=t.reBuyTargets[Number(e)];r&&xe[e]&&(n=r.pricePriority)}G("rebuyPriority",e,n)}))}),[ce]);var ye=function(){L&&M.forEach((function(e){var t=F("targetPricePercentage",e),n=(0,Qe.C2)(Math.abs(t)),r="LONG"===te?"-":"";if(isNaN(t))G("targetPricePercentage",e,r);else{G("targetPricePercentage",e,""+r+n);var a=j("targetPricePercentage",e);!xe[e]&&g[a]&&p(a)}}))};(0,ke.Z)(ye,[O,te,ne]);(0,o.useEffect)((function(){A(Boolean(I.length))}),[I.length]);(0,o.useEffect)((function(){var e=j("rebuyPercentage",1);L&&O>0&&!xe[1]&&g[e]&&p(e)}),[L,re]);(0,o.useEffect)((function(){L||M.forEach((function(e){l(j("targetPricePercentage",e)),l(j("rebuyPrice",e)),l(j("rebuyPercentage",e)),m(j("targetPricePercentage",e),"")}))}),[L]);var xe=function(){var e={};return I.forEach((function(n){if(t){var r=t.reBuyTargets[Number(n)];e[n]=!1,(r.done||r.skipped)&&(e[n]=!0)}})),e}(),be=function(){var e={};return I.forEach((function(t){var n=!1;(xe[t]||a)&&(n=!0),e[j("rebuyPercentage",t)]=n,e[j("targetPricePercentage",t)]=n,e[j("rebuyPrice",t)]=n,e[j("postOnly",t)]=n})),e}(),Pe=function(e){return f()[j("rebuyPriority",e)]},Ze=function(e){var r=parseInt(e),a=!be[j("targetPricePercentage",e)]&&e!==M[M.length-1];return o.createElement(W.Z,{className:"targetGroup","data-target-id":e,key:"target"+e},o.createElement(W.Z,{className:"targetPrice",display:"flex",flexDirection:"row",flexWrap:"wrap"},o.createElement(ge,{descriptionId:"price"===Pe(e)?"terminal.dca.help":"terminal.dca.percentage.help",labelId:"terminal.target"}),o.createElement(Je,{dcaTarget:v[Number(e)]||null,labelId:"terminal.status"}),o.createElement("input",{defaultValue:ce,name:j("rebuyPriority",e),ref:u,type:"hidden"}),o.createElement(W.Z,{alignItems:"center",display:"price"!==Pe(e)?"flex":"none"},o.createElement(je.Z,{allowNegative:!0,disabled:fe(e),name:j("targetPricePercentage",e),rules:{validate:function(t){return!(!be[j("targetPricePercentage",e)]&&"percentage"===ce)||(b(parseFloat(t),0,te,"terminal.dca.valid.pricepercentage")||ve)}},showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},"%")),he("targetPricePercentage",e),o.createElement(W.Z,{alignItems:"center",display:"price"===Pe(e)?"flex":"none"},o.createElement(je.Z,{disabled:fe(e),name:j("rebuyPrice",e),rules:{validate:function(t){return!(!be[j("rebuyPrice",e)]&&"price"===ce)||Q(parseFloat(t),"terminal.dca.limit")}},showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},n.quote)),he("rebuyPrice",e),o.createElement(ge,{descriptionId:"terminal.rebuy.help",labelId:"terminal.rebuy"}),o.createElement(W.Z,{alignItems:"center",display:"flex"},o.createElement(je.Z,{disabled:fe(e),name:j("rebuyPercentage",e),rules:be[j("rebuyPercentage",e)]?null:{validate:{positive:function(e){return e>0||x({id:"terminal.dca.valid.unitspercentage"})},limit:function(){return function(e){var t=E(),r=t*(F("rebuyPercentage",e)/100),a=y(),i=F("targetPricePercentage",e),o=K(r,a*(1-i/100),n);return!("1"===e&&t>0)||J(o,"terminal.dca.limit")}(e)},cost:function(){return function(e){var t=E(),n=F("rebuyPercentage",e);return!("1"===e&&t>0)||Y(t*(n/100),"terminal.dca.limit")}(e)}}},showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},"%"))),he("rebuyPercentage",e),o.createElement(W.Z,{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"start"},o.createElement(Me,{disabled:fe(e),exchange:null==t?void 0:t.exchange,name:j("postOnly",e)})),a&&o.createElement(W.Z,{className:"targetActions",display:"flex",flexDirection:"row",flexWrap:"wrap"},o.createElement(oe.Z,{className:"removeTarget","data-target-id":r,onClick:r>=1e3?pe:U},o.createElement(me,null),o.createElement(V.Z,{id:"terminal.target.remove"}))))};return o.createElement(W.Z,{className:"panel dcaPanel "+k},o.createElement(W.Z,{alignItems:"center",className:"panelHeader",display:"flex",flexDirection:"row"},!X&&o.createElement(se.Z,{checked:L,onChange:function(e){return A(e.target.checked)},size:"small"}),o.createElement(W.Z,{alignItems:"center",className:"title",display:"flex",flexDirection:"row"},o.createElement(le.Z,{variant:"h5"},o.createElement(V.Z,{id:"terminal.dca"})))),L&&o.createElement(W.Z,{className:"panelContent",display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-around"},o.createElement(W.Z,{className:"priorityType"},o.createElement(ge,{descriptionId:"terminal.rebuy.type.help",labelId:"terminal.rebuy.type"}),o.createElement(s.Qr,{defaultValue:ce,name:"DCAPriority",render:function(e){var t=e.onChange,n=e.value;return o.createElement(He.Z,{"aria-label":"type",className:"customRadio",onChange:t,row:!0,value:n},o.createElement(Oe.Z,{control:o.createElement(qe.Z,{disabled:a}),label:o.createElement(de.Z,null,o.createElement(V.Z,{id:"terminal.percentage"})),value:"percentage"}),o.createElement(Oe.Z,{control:o.createElement(qe.Z,{disabled:a}),label:o.createElement(de.Z,null,o.createElement(V.Z,{id:"terminal.rebuy.fixedprice"})),value:"price"}))}})),M.map((function(e){return Ze(e)})),o.createElement(W.Z,{className:"targetActions",display:"flex",flexDirection:"row",flexWrap:"wrap"},!ee&&o.createElement(oe.Z,{className:"removeTarget",onClick:U},o.createElement(me,null),o.createElement(V.Z,{id:"terminal.target.remove"})),!a&&o.createElement(oe.Z,{className:"addTarget",onClick:R},o.createElement(ue,null),o.createElement(V.Z,{id:"terminal.target.add"}))),C.length?o.createElement(le.Z,{className:"callout1 increaseDCATitle"},o.createElement(V.Z,{id:"terminal.dca.increase"})):null,C.map((function(e){return Ze(e)}))))},Xe=o.memo(Ke),et=n(59704),tt=n.n(et),nt=n(81763),rt=n.n(nt),at=n(29093),it=function(e){var t=e.orderId,n=(0,B.Z)().formatMessage,r=G.O.darkGrey,a=n({id:"terminal.status.pending"});return t&&(a=n({id:"terminal.status.placed"},{orderId:t}),r=G.O.blue),o.createElement(W.Z,{alignItems:"center",className:"targetStatus",display:"flex",justifyContent:"flex-end"},o.createElement(de.Z,null,o.createElement(V.Z,{id:"terminal.status"})),o.createElement(pe.ZP,{arrow:!0,enterTouchDelay:50,placement:"left-end",title:a},o.createElement(ve.Z,{style:{fill:r}})))},ot=o.memo(it),lt=n(1469),st=n.n(lt),ct=function(e,t){void 0===t&&(t=null);var n=e.limits,r=e.contractType,a=e.multiplier||1,i=(0,s.Gc)(),l=i.errors,c=i.getValues,u=i.setValue,m=i.watch,d=i.trigger,p=m("leverage",t),f=m("entryType"),g=m("entryStrategy"),v=(0,o.useContext)(_e),h=v.lastPrice,y=v.providerService,E=m("price"),x=parseFloat(E)||h,b=0;if("multi"===g){var P=m("priceShort");b=parseFloat(P)||h}var Z=y?y.providerPayableBalance:0,I=(0,B.Z)().formatMessage;var w=function(t){var n=K(t,x,e);if(u("units",n.toFixed(8)),d("units"),"multi"===g){var r=K(t,b,e);u("unitsShort",r.toFixed(8)),d("unitsShort")}};return(0,o.useEffect)((function(){Ie("realInvestment")}),[f,p]),{positionSizeChange:function(){if(!l.positionSize){var e=c(),t=parseFloat(e.positionSize);w(t);var n=parseFloat(e.positionSize)/p;u("realInvestment",n.toFixed(8))}},positionSizePercentageChange:function(){if(!l.positionSizePercentage){var e=c(),t=parseFloat(e.positionSizePercentage);u("positionSizeAllocated",(t*Z/100).toFixed(8))}},priceChange:function(){var e=c();parseFloat(e.positionSize)>0&&Ie("positionSize"),d("price"),d("priceShort")},realInvestmentChange:function(){if(!l.realInvestment){var e=c(),t=parseFloat(e.realInvestment)*p;u("positionSize",t),d("positionSize").then((function(e){e&&w(t)}))}},unitsChange:function(){var t=c(),n=parseFloat(t.units);if(!isNaN(n)){var r=n*x;"inverse"===e.contractType?r=n/x*a:"quanto"!==e.contractType&&"linear"!==e.contractType||(r*=a),u("positionSize",r.toFixed(8)),d("positionSize").then((function(e){e&&u("realInvestment",(r/p).toFixed(8))}))}},validatePositionSize:function(e){var t=parseFloat(e),a="inverse"===r?n.amount:n.cost;return a.min&&t<a.min?I({id:"terminal.positionsize.limit.min"},{value:a.min}):a.max&&t>a.max?I({id:"terminal.positionsize.limit.max"},{value:a.max}):t>0||I({id:"terminal.positionsize.limit.zero"})},validatePrice:function(e,t){var r=parseFloat(e),a=n.price.min,i=n.price.max;return t&&("long"===t?i=b:a=x),a&&r<a?"short"===t?I({id:"terminal.positionprice.multi.short"}):I({id:"terminal.positionprice.limit.min"},{value:a}):i&&r>i?"long"===t?I({id:"terminal.positionprice.multi.long"}):I({id:"terminal.positionprice.limit.max"},{value:i}):r>0||I({id:"terminal.positionprice.limit.zero"})},validateUnits:function(e){var t=parseFloat(e),a="inverse"===r?n.cost:n.amount;return a.min&&t<a.min?I({id:"terminal.positionunits.limit.min"},{value:a.min}):a.max&&t>a.max?I({id:"terminal.positionunits.limit.max"},{value:a.max}):!isNaN(e)||I({id:"terminal.positionsize.limit.zero"})},validateSellAmount:function(e){var t=Wt(c());if(st()(t)&&t.length)return!0;var a="inverse"===r?n.amount:n.cost;return!a||(!(a.min&&e<a.min)||I({id:"terminal.sell.mincost"},{value:a.min}))}}},ut=function(e){var t=e.symbolData,n=e.positionEntity,r=e.isReadOnly,a=void 0!==r&&r,i=!!n&&(rt()(n.stopLossPrice)&&rt()(n.stopLossPercentage)),l=Ee(i),c=l.expanded,u=l.expandClass,m=l.setExpanded,d=(0,s.Gc)(),p=d.clearErrors,f=d.errors,g=d.getValues,v=d.register,h=d.setValue,y=d.watch,E=d.trigger,x=d.control,b=Le().lessThan,P=Se(n),Z=P.getEntryPrice,I=(0,P.getEntrySizeQuote)(),w=ct(t).validateSellAmount,_=(0,B.Z)().formatMessage,S=n?n.side:y("entryType"),C="fixed";n&&(n.stopLossFollowsTakeProfit?C="stopLossFollowsTakeProfit":n.stopLossToBreakEven&&(C="stopLossToBreakEven"));var N=y("price"),T=!!n&&n.closed,D=n&&tt()(n.takeProfitTargets,(function(e){return e.done})),L=[{label:_({id:"terminal.stoploss.type.fixed"}),val:"fixed"},{label:_({id:"terminal.stoploss.type.followtp"}),val:"stopLossFollowsTakeProfit"},{label:_({id:"terminal.stoploss.type.breakeven"}),val:"stopLossToBreakEven"}],k=function(){var e={},t=!1;return a&&(t=!0),e.stopLossPrice=t,e.stopLossPercentage=t,e.stopLossType=t||D,e}();(0,ke.Z)((function(){E("stopLossPercentage")}),[I]);(0,o.useEffect)((function(){c?(n&&n.stopLossPercentage&&(h("stopLossPriority",n.stopLossPriority),h("stopLossPrice",(0,H.T4)(n.stopLossPrice,"","")),h("stopLossPercentage",(0,H.Vj)(n.stopLossPercentage))),A()):(h("stopLossPrice",""),f.stopLossPercentage&&p("stopLossPercentage"),f.stopLossPrice&&p("stopLossPrice"))}),[c]);var A=function(){var e=g(),t=n?n.stopLossPercentage:null,r=parseFloat(e.stopLossPercentage)||t,a="SHORT"===S?"":"-";if(rt()(r)){var i=(0,H.Vj)(t||Math.abs(r));h("stopLossPercentage",(0,H.Vj)(i))}else h("stopLossPercentage",a)};return(0,o.useEffect)(A,[S,N]),o.createElement(W.Z,{className:"panel stopLossPanel "+u},o.createElement(W.Z,{alignItems:"center",className:"panelHeader",display:"flex",flexDirection:"row"},!T&&o.createElement(se.Z,{checked:c,onChange:function(e){return m(e.target.checked)},size:"small"}),o.createElement(W.Z,{alignItems:"center",className:"title",display:"flex",flexDirection:"row"},o.createElement(le.Z,{variant:"h5"},o.createElement(V.Z,{id:"terminal.stoploss"})),o.createElement("input",{name:"unrealizedProfitLossesPercentage",ref:v,type:"hidden"}))),c&&o.createElement(W.Z,{className:"panelContent",display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-around"},o.createElement(W.Z,{className:"stopLoss"},o.createElement(Fe,{disabled:a,labelDescriptionId:"terminal.stoploss.help",labelId:"terminal.stoploss",percentage:{name:"stopLossPercentage",validate:function(){var e=g(),t=parseFloat(e.stopLossPercentage),r=!0;return n||(r=b(t,0,S,"terminal.stoploss.valid.percentage",{value:0})),!0===r&&I&&t&&(r=w(I*(100+t)/100)),r},onChange:function(){if(!f.stopLossPercentage){var e=g(),t=Z(),n=t*(100+parseFloat(e.stopLossPercentage))/100;!isNaN(t)&&t>0?h("stopLossPrice",(0,H.T4)(n,"","")):h("stopLossPrice",""),E("stopLossPrice")}},allowNegative:!0},price:{name:"stopLossPrice",onChange:function(){if(!f.stopLossPrice){var e=g(),t=Z(),n=parseFloat(e.stopLossPrice)-t;if(isNaN(n)||0===n)h("stopLossPercentage","");else{var r=n/t*100;h("stopLossPercentage",(0,H.Vj)(r))}E("stopLossPercentage")}},error:_({id:"terminal.stoploss.limit.zero"})},priorityName:"stopLossPriority",quote:t.quote,status:n&&"futures"===n.exchangeType&&["binance","zignaly"].includes(n.exchange.toLowerCase())&&n.stopLossPercentage?o.createElement(ot,{orderId:n.stopLossOrderId}):o.createElement("span",null)})),o.createElement(W.Z,{alignItems:"center",className:"title",display:"flex",flexDirection:"row",mt:"12px"},o.createElement(de.Z,null,o.createElement(V.Z,{id:"terminal.stoploss.type"})),o.createElement(s.Qr,{as:o.createElement(at.Z,{disabled:k.stopLossType,label:"",onChange:function(){},options:L}),control:x,defaultValue:C,name:"stopLossType"}))))},mt=o.memo(ut),dt=function(e){var t=e.symbolData,n=e.positionEntity,r=e.isReadOnly,a=void 0!==r&&r,i=!!n&&Boolean(n.trailingStopPercentage),l=Ee(i),c=l.expanded,u=l.expandClass,m=l.setExpanded,d=(0,s.Gc)(),p=d.clearErrors,f=d.errors,g=d.getValues,v=d.trigger,h=d.setValue,y=d.watch,E=d.formState.dirtyFields,x=y("trailingStopDistance",n?n.trailingStopPercentage:0),b=parseFloat(x),P=y("trailingStopPercentage",n?n.trailingStopTriggerPercentage:0),Z=parseFloat(P),I=Ae(t).validateTargetPriceLimits,w=Le(),_=w.lessThan,S=w.greaterThan,C=Se(n),N=C.getEntryPrice,T=(0,C.getEntrySizeQuote)(),D=!!n&&n.closed,L=n?n.side:y("entryType"),k=y("price"),A=ct(t).validateSellAmount,z=function(){var e=!!n&&n.trailingStopTriggered,t={};return t.trailingStopPercentage=a||e,t.trailingStopPrice=a||e,t.trailingStopDistance=a,t}();(0,o.useEffect)((function(){v("trailingStopPercentage")}),[T,b]);(0,o.useEffect)((function(){if(c){var e=(0,H.Vj)(Math.abs(Z)),t=(0,H.Vj)(Math.abs(b)),r="SHORT"===L?"-":"",a="SHORT"===L?"":"-";b?(h("trailingStopDistance",""+a+t),E.trailingStopDistance&&v("trailingStopDistance")):h("trailingStopDistance",a),Z?(h("trailingStopPercentage",""+r+e),n&&(h("trailingStopPrice",n.trailingStopTriggerPrice),h("trailingStopTriggerPriority",n.trailingStopTriggerPriority))):h("trailingStopPercentage",r)}else h("trailingStopPrice",""),f.trailingStopPercentage&&p("trailingStopPercentage"),f.trailingStopPrice&&p("trailingStopPrice")}),[c,L,k]);var O;return o.createElement(W.Z,{className:"panel trailingStopPanel "+u},o.createElement(W.Z,{alignItems:"center",className:"panelHeader",display:"flex",flexDirection:"row"},!D&&o.createElement(se.Z,{checked:c,onChange:function(e){return m(e.target.checked)},size:"small"}),o.createElement(W.Z,{alignItems:"center",className:"title",display:"flex",flexDirection:"row"},o.createElement(le.Z,{variant:"h5"},o.createElement(V.Z,{id:"terminal.trailingstop"})))),c&&o.createElement(W.Z,{className:"panelContent",display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-around"},o.createElement(Fe,{disabled:z.trailingStopPercentage,labelDescriptionId:"terminal.trailingstop.help",labelId:"terminal.trailingstop",percentage:{name:"trailingStopPercentage",validate:function(e){var t=parseFloat(e),r=!0;(n&&S(e,0,L,"terminal.trailingstop.valid.percentage",{value:0}),!0===r)&&(t&&T&&(r=A(T*(100+t)/100*(100+b)/100)));return r},onChange:function(){var e=N();if(e>0){var t=g(),n=e*(100+parseFloat(t.trailingStopPercentage))/100;h("trailingStopPrice",(0,H.T4)(n,"",""))}else h("trailingStopPrice","");v("trailingStopPrice")},allowNegative:!0},price:{name:"trailingStopPrice",onChange:function(){var e=g(),t=N(),n=parseFloat(e.trailingStopPrice)-t;if(isNaN(n)||0===n)h("trailingStopPercentage","");else{var r=n/t*100;h("trailingStopPercentage",(0,H.Vj)(r))}v("trailingStopPercentage")},validate:function(e){return I(e,"terminal.trailingstop.limit")}},priorityName:"trailingStopTriggerPriority",quote:t.quote}),o.createElement(W.Z,null,o.createElement(ge,{descriptionId:"terminal.distance.help",labelId:"terminal.distance"}),o.createElement(W.Z,{alignItems:"center",display:"flex"},o.createElement(je.Z,{allowNegative:!0,disabled:z.trailingStopDistance,name:"trailingStopDistance",rules:{validate:function(e){return _(parseFloat(e),0,L,"terminal.trailingstop.limit.zero")}},showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},"%")),f[O="trailingStopDistance"]?o.createElement("span",{className:"errorText"},f[O].message):null)))},pt=o.memo(dt),ft=n(30789),gt=n(85935),vt=n(71949),ht=function(e){var t=(0,o.useState)(!1),n=t[0],r=t[1],a=(0,Q.Z)(),i=(0,o.useState)([]),s=i[0],u=i[1],m=(0,B.Z)().formatMessage,d=(0,l.I0)();return(0,o.useEffect)((function(){var t={internalExchangeId:e||a.internalId};r(!0),c.Z.ownedCopyTradersProvidersOptions(t).then((function(e){if(Array.isArray(e)){var t=e.map((function(e){return 1===e.providerId?Object.assign({},e,{providerName:m({id:"terminal.provider.manual"})}):e}));u(t)}})).catch((function(e){d((0,J.jx)(e))})).finally((function(){r(!1)}))}),[a.internalId]),{ownCopyTraderProviders:s,loading:n}},yt=function(e){var t=e.symbolData,n=e.positionEntity,r=(0,o.useState)(!1),a=r[0],i=r[1],l=a?"expanded":"collapsed",c=(0,s.Gc)(),u=c.control,m=c.errors,d=c.register,p=c.watch,f=c.reset,g=c.getValues,v=(0,B.Z)().formatMessage,h=(0,Q.Z)(),y=ct(t,n.leverage),E=y.positionSizeChange,x=y.validateUnits,b=y.priceChange,P=y.realInvestmentChange,Z=y.unitsChange,I=y.validatePositionSize,w=y.positionSizePercentageChange,_=(0,ft.Z)(h),S=_.balance,C=_.loading,N=(0,Y.zJ)().find((function(e){return e.internalId===n.internalExchangeId})),T=ht(N?N.internalId:""),D=T.loading,L=T.ownCopyTraderProviders,k=S&&S[t.base]||0,A=S&&S[t.quote]||0,z=p("entryStrategy","limit"),O=(0,o.useContext)(_e),M=O.lastPrice,j=O.updatedAt,F=O.providerService,R=O.setProviderService,U=F?F.providerPayableBalance:0,G=F?F.providerConsumedBalance:0,q=F?F.providerConsumedBalancePercentage:0,J=[{label:v({id:"terminal.strategy.limit"}),val:"limit"},{label:v({id:"terminal.strategy.market"}),val:"market"},{label:v({id:"terminal.strategy.stoplimit"}),val:"stop_limit"}];(0,o.useEffect)((function(){j&&i(!1)}),[j]);(0,ke.Z)((function(){a||f(Object.assign({},g(),{stopPrice:"",price:"",realInvestment:"",positionSize:"",positionSizePercentage:"",units:""}))}),[a]),(0,o.useEffect)((function(){if(L){var e=L.find((function(e){return e.providerId===n.providerId}));R(e)}}),[L]);var $=!!n&&n.isCopyTrader;return o.createElement(W.Z,{className:"panel strategyPanel "+l},o.createElement(W.Z,{alignItems:"center",className:"panelHeader",display:"flex",flexDirection:"row"},o.createElement(se.Z,{checked:a,onChange:function(e){var t=e.currentTarget;i(t.checked)},size:"small"}),o.createElement(le.Z,{variant:"h5"},o.createElement(V.Z,{id:"terminal.increasestrategy"}))),a&&o.createElement(W.Z,{className:"panelContent",display:"flex",flexDirection:"row",flexWrap:"wrap"},o.createElement(gt.Z,{className:"entryType"},o.createElement(ge,{descriptionId:"terminal.increasestrategy.help",labelId:"terminal.entrytype"}),o.createElement(s.Qr,{as:o.createElement(at.Z,{label:"",onChange:function(){},options:J}),control:u,defaultValue:"limit",name:"entryStrategy"})),"stop_limit"===z&&o.createElement(gt.Z,null,o.createElement(ge,{descriptionId:"terminal.stopprice.help",labelId:"terminal.stopprice"}),o.createElement(W.Z,{alignItems:"center",display:"flex"},o.createElement(je.Z,{name:"stopPrice"}),o.createElement("div",{className:"currencyBox"},t.quote))),"market"!==z?o.createElement(gt.Z,null,o.createElement(ge,{descriptionId:"terminal.price.help",labelId:"terminal.price"}),o.createElement(W.Z,{alignItems:"center",display:"flex"},o.createElement(je.Z,{defaultValue:M,name:"price",onChange:b,rules:{validate:function(e){return!isNaN(e)&&parseFloat(e)>0}},showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},t.quote)),m.price&&o.createElement("span",{className:"errorText"},m.price.message)):o.createElement("input",{defaultValue:M,name:"price",ref:d,type:"hidden"}),"futures"===n.exchangeType&&!n.isCopyTrader&&o.createElement(gt.Z,null,o.createElement(ge,{descriptionId:"terminal.realinvest.help",labelId:"terminal.realinvest"}),o.createElement(W.Z,{alignItems:"center",display:"flex"},o.createElement(je.Z,{name:"realInvestment",onChange:P,placeholder:"0",rules:{validate:function(e){return!isNaN(e)&&parseFloat(e)>=0}},showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},t.unitsInvestment)),o.createElement(de.Z,null,o.createElement(V.Z,{id:"terminal.available"})," ",C?o.createElement(vt.Z,{color:"primary",size:20}):o.createElement("span",{className:"balance"},A))),!$&&o.createElement(gt.Z,null,o.createElement(ge,{descriptionId:"terminal.position.size.help",labelId:"terminal.position.size"}),o.createElement(W.Z,{alignItems:"center",display:"flex"},o.createElement(je.Z,{name:"positionSize",onChange:E,placeholder:"0",rules:{validate:I},showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},t.unitsInvestment)),o.createElement(de.Z,null,o.createElement(V.Z,{id:"terminal.available"})," ",C?o.createElement(vt.Z,{color:"primary",size:20}):o.createElement("span",{className:"balance"},A)),m.positionSize&&o.createElement("span",{className:"errorText"},m.positionSize.message)),$&&o.createElement(o.Fragment,null,o.createElement(ge,{descriptionId:"terminal.position.sizepercentage.help",labelId:"terminal.position.sizepercentage"}),o.createElement(W.Z,{className:"positionSizePercentage",display:"flex",flexDirection:"row"},o.createElement(W.Z,{display:"flex",flexDirection:"row"},o.createElement(je.Z,{name:"positionSizePercentage",onChange:w,placeholder:"0",rules:{required:v({id:"terminal.positionsize.percentage.required"}),validate:function(e){return e>0&&e<=100||v({id:"terminal.positionsize.valid.percentage"})}},showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},"%")),o.createElement(W.Z,{display:"flex",flexDirection:"row"},o.createElement(je.Z,{name:"positionSizeAllocated",placeholder:"0",readOnly:!0}),o.createElement("div",{className:"currencyBox"},t.unitsInvestment))),o.createElement(de.Z,null,o.createElement(V.Z,{id:"terminal.provider.allocated"})," ",D?o.createElement(vt.Z,{color:"primary",size:20}):o.createElement("span",{className:"balance"},(0,H.T4)(U)," "),o.createElement(V.Z,{id:"terminal.provider.consumed"})," ",!D&&o.createElement("span",{className:"balance"},(0,H.T4)(G)," "),o.createElement(V.Z,{id:"terminal.provider.available"})," ",!D&&o.createElement("span",{className:"balance"},(0,Qe.C2)(100-q),"%")),m.positionSizePercentage&&o.createElement("span",{className:"errorText"},m.positionSizePercentage.message)),!$&&o.createElement(gt.Z,null,o.createElement(ge,{descriptionId:"terminal.units.help",labelId:"terminal.units"}),o.createElement(W.Z,{alignItems:"center",display:"flex"},o.createElement(je.Z,{name:"units",onChange:Z,placeholder:"0",rules:{validate:x},showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},t.unitsAmount)),o.createElement(de.Z,null,o.createElement(V.Z,{id:"terminal.available"})," ",C?o.createElement(vt.Z,{color:"primary",size:15}):o.createElement("span",{className:"balance"},k)),m.units&&o.createElement("span",{className:"errorText"},m.units.message)),["limit","stop_limit"].includes(z)&&o.createElement(W.Z,{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"start"},o.createElement(Me,{exchange:null==n?void 0:n.exchange}))))},Et=o.memo(yt),xt=function(e){var t=e.order,n=e.labelId,r=(0,B.Z)().formatMessage,a=G.O.darkGrey,i=r({id:"terminal.status.pending"});return!t.done&&t.orderId?(i=r({id:"terminal.status.placed"},{orderId:t.orderId}),a=G.O.blue):t.done&&t.orderId?(i=r({id:"terminal.status.done"}),a=G.O.green):t.errorMSG&&(i=t.errorMSG,a=G.O.red),o.createElement(W.Z,{alignItems:"center",className:"targetStatus",display:"flex",justifyContent:"flex-end"},o.createElement(de.Z,null,o.createElement(V.Z,{id:n})),o.createElement(pe.ZP,{arrow:!0,enterTouchDelay:50,placement:"left-end",title:i},o.createElement(ve.Z,{style:{fill:a}})))},bt=function(e){var t=e.positionEntity,n=e.isReadOnly,r=void 0!==n&&n,a=(0,s.Gc)(),i=a.setValue,l=a.watch,c=a.control,u=a.register,m=a.unregister,d=te()(t.reduceOrders),p=Ee(ie()(d)>0),f=p.expanded,g=p.expandClass,v=p.setExpanded,h=!!t&&t.closed,y=l("removeReduceOrder",[]),E=Boolean(d.find((function(e){return(e.recurring||e.persistent)&&!y.includes(e.targetId)})));(0,o.useEffect)((function(){if(!f){var e=d.map((function(e){return e.targetId}));i("removeReduceOrder",e)}}),[f]);(0,o.useEffect)((function(){return u("removeReduceOrder"),function(){return m("removeReduceOrder")}}),[u,m]);(0,o.useEffect)((function(){v(Boolean(d.length))}),[d.length]);var x=function(e){if(y.find((function(t){return t===e.targetId})))return null;var n=!e.done&&!r;return o.createElement(W.Z,{className:"targetGroup",key:e.targetId},o.createElement(W.Z,{className:"targetPrice",display:"flex",flexDirection:"row",flexWrap:"wrap"},o.createElement(ge,{descriptionId:"terminal.reducestrategy.targetpercentage.help",labelId:"terminal.target"}),o.createElement(xt,{labelId:"terminal.status",order:e}),o.createElement(W.Z,{alignItems:"center",className:"percentageBox",display:"flex"},o.createElement(je.Z,{disabled:!0,name:"",value:(0,Qe.C2)(e.targetPercentage)}),o.createElement("div",{className:"currencyBox"},"%")),o.createElement(W.Z,{alignItems:"center",className:"valueBox",display:"flex"},o.createElement(je.Z,{disabled:!0,name:"",value:(0,H.T4)(e.price)}),o.createElement("div",{className:"currencyBox"},t.quote))),o.createElement(W.Z,{className:"targetUnits",display:"flex",flexDirection:"row",flexWrap:"wrap"},o.createElement(ge,{descriptionId:"terminal.reducestrategy.availablePercentage.help",labelId:"terminal.reducestrategy.availablePercentage"}),o.createElement(W.Z,{alignItems:"center",className:"percentageBox",display:"flex"},o.createElement(je.Z,{disabled:!0,name:"",value:(0,Qe.C2)(e.availablePercentage)}),o.createElement("div",{className:"currencyBox"},"%")),o.createElement(W.Z,{alignItems:"center",className:"valueBox",display:"flex"},o.createElement(je.Z,{disabled:!0,name:"",value:(0,H.T4)(e.amount)}),o.createElement("div",{className:"currencyBox"},t.base))),n&&o.createElement(W.Z,{className:"targetActions",display:"flex",flexDirection:"row",flexWrap:"wrap"},o.createElement(oe.Z,{className:"removeTarget",onClick:function(){return t=e.targetId,n=y.concat(t),void i("removeReduceOrder",n);var t,n}},o.createElement(me,null),o.createElement(V.Z,{id:"terminal.target.remove"}))))};return o.createElement(W.Z,{className:"panel reduceOrders "+g},o.createElement(W.Z,{alignItems:"center",className:"panelHeader",display:"flex",flexDirection:"row"},!h&&o.createElement(se.Z,{checked:f,onChange:function(e){return v(e.target.checked)},size:"small"}),o.createElement(W.Z,{alignItems:"center",className:"title",display:"flex",flexDirection:"row"},o.createElement(le.Z,{variant:"h5"},o.createElement(V.Z,{id:"terminal.reduceorders"})))),f&&o.createElement(W.Z,{className:"panelContent",display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-around"},d.map((function(e){return x(e)})),o.createElement(W.Z,{className:"targetActions",display:"flex",flexDirection:"row",flexWrap:"wrap"},E&&o.createElement(Oe.Z,{className:"customCheckbox",control:o.createElement(s.Qr,{control:c,defaultValue:!0,name:"reduceRecurringPersistent",render:function(e){var t=e.onChange,n=e.value;return o.createElement(ze.Z,{checked:n,onChange:function(e){return t(e.target.checked)}})}}),label:o.createElement(V.Z,{id:"terminal.reducestrategy.persistentrecurring"})}))))},Pt=o.memo(bt),Zt=n(45749),It=function(e){var t=e.symbolData,n=e.positionEntity,r=(0,o.useState)(!1),a=r[0],i=r[1],l=a?"expanded":"collapsed",c=(0,s.Gc)(),u=c.control,m=c.errors,d=c.watch,p=c.getValues,f=c.setValue,g=c.reset,v=(0,B.Z)().formatMessage,h=Se(n).getEntryPrice,y=(0,o.useState)(""),E=y[0],x=y[1],b=(0,o.useState)(""),P=b[0],Z=b[1],I=Le().validPercentage,w=(0,o.useContext)(_e).updatedAt,_=n.remainAmount,S=d("reduceRecurring"),C=d("reduceOrderType","limit");(0,o.useEffect)((function(){w&&i(!1)}),[w]);(0,ke.Z)((function(){a||(g(Object.assign({},p(),{reduceOrderType:"",reduceTargetPercentage:"",reduceAvailablePercentage:"",reduceRecurring:"",reducePersistent:""})),Z(""))}),[a]);var N=[{label:v({id:"terminal.strategy.limit"}),val:"limit"}];return S||N.push({label:v({id:"terminal.strategy.market"}),val:"market"}),o.createElement(W.Z,{className:"panel reduceStrategyPanel "+l},o.createElement(W.Z,{alignItems:"center",className:"panelHeader",display:"flex",flexDirection:"row"},o.createElement(se.Z,{checked:a,onChange:function(e){var t=e.currentTarget;i(t.checked)},size:"small"}),o.createElement(le.Z,{variant:"h5"},o.createElement(V.Z,{id:"terminal.reducestrategy"}))),a&&o.createElement(W.Z,{className:"panelContent",display:"flex",flexDirection:"row",flexWrap:"wrap"},o.createElement(Zt.Z,{className:"tpsWarning",severity:"warning"},o.createElement(V.Z,{id:"terminal.reducestrategy.tpwarning"})),o.createElement(ge,{descriptionId:"terminal.reducestrategy.help",labelId:"terminal.entrytype"}),o.createElement(s.Qr,{as:o.createElement(at.Z,{label:"",onChange:function(){},options:N}),control:u,defaultValue:"limit",name:"reduceOrderType"}),"market"!==C&&o.createElement(W.Z,{className:"targetPrice",display:"flex",flexDirection:"row",flexWrap:"wrap"},o.createElement(ge,{descriptionId:"terminal.reducestrategy.targetpercentage.help",labelId:"terminal.target"}),o.createElement(W.Z,{alignItems:"center",display:"flex"},o.createElement(je.Z,{allowNegative:!0,name:"reduceTargetPercentage",onChange:function(){var e=h(),t=p(),n=e+parseFloat(t.reduceTargetPercentage)/100*e;x((0,H.T4)(n.toString()))},rules:{validate:function(e){return!isNaN(e)||v({id:"terminal.reducestrategy.percentage.error"})}},showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},"%")),o.createElement(W.Z,{alignItems:"center",display:"flex"},o.createElement(je.Z,{disabled:!0,name:"",value:E}),o.createElement("div",{className:"currencyBox"},t.unitsInvestment))),m.reduceTargetPercentage&&o.createElement("span",{className:"errorText"},m.reduceTargetPercentage.message),o.createElement(W.Z,{alignItems:"flex-start",className:"targetUnits",display:"flex",flexDirection:"row",flexWrap:"wrap"},o.createElement(ge,{descriptionId:"terminal.reducestrategy.availablePercentage.help",labelId:"terminal.reducestrategy.availablePercentage"}),o.createElement(W.Z,{alignItems:"center",display:"flex"},o.createElement(je.Z,{name:"reduceAvailablePercentage",onChange:function(){if(!m.reduceAvailablePercentage){var e=p(),t=parseFloat(e.reduceAvailablePercentage);Z((t/100*_).toString())}},rules:{validate:{percentage:function(e){return I(e,"terminal.reducestrategy.percentage.limit")}}},showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},"%")),o.createElement(W.Z,{alignItems:"flex-start",display:"flex",flexDirection:"column"},o.createElement(W.Z,{display:"flex",flexDirection:"row"},o.createElement(je.Z,{disabled:!0,name:"",value:P}),o.createElement("div",{className:"currencyBox"},t.unitsAmount)),o.createElement(de.Z,null,o.createElement(V.Z,{id:"terminal.available"})," ",o.createElement("span",{className:"balance"},(0,H.T4)(n.availableAmount)))),m.reduceAvailablePercentage&&o.createElement("span",{className:"errorText"},m.reduceAvailablePercentage.message)),o.createElement(Oe.Z,{className:"customCheckbox",control:o.createElement(s.Qr,{control:u,defaultValue:!1,name:"reduceRecurring",render:function(e){var t=e.onChange,n=e.value;return o.createElement(ze.Z,{checked:n,onChange:function(e){f("reduceOrderType","limit"),t(e.target.checked)}})}}),label:o.createElement(ge,{descriptionId:"terminal.reducestrategy.recurring.help",labelId:"terminal.reducestrategy.recurring"})}),o.createElement(Oe.Z,{className:"customCheckbox",control:o.createElement(s.Qr,{control:u,defaultValue:!1,name:"reducePersistent",render:function(e){var t=e.onChange,n=e.value;return o.createElement(ze.Z,{checked:n,onChange:function(e){return t(e.target.checked)}})}}),label:o.createElement(ge,{descriptionId:"terminal.reducestrategy.persistent.help",labelId:"terminal.reducestrategy.persistent"})}),["limit"].includes(C)&&o.createElement(W.Z,{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"start"},o.createElement(Me,{exchange:null==n?void 0:n.exchange,name:"reducePostOnly"}))))},wt=o.memo(It),_t=function(e){var t=e.positionEntity,n=e.selectedSymbol,r=e.isReadOnly;return o.createElement(o.Fragment,null,o.createElement(Be,{isReadOnly:r,positionEntity:t,symbolData:n}),o.createElement(Xe,{isReadOnly:r,positionEntity:t,symbolData:n}),o.createElement(mt,{isReadOnly:r,positionEntity:t,symbolData:n}),o.createElement(pt,{isReadOnly:r,positionEntity:t,symbolData:n}),!r&&o.createElement(Et,{positionEntity:t,symbolData:n}),o.createElement(Pt,{isReadOnly:r,positionEntity:t}),!r&&o.createElement(wt,{positionEntity:t,symbolData:n}))},St=o.memo(_t),Ct=n(52996),Nt=n(44292),Tt=function(e){var t=e.min,n=e.max,r=e.leverage,a=e.setValue,i=e.onClose,l=(0,o.useState)(r),s=l[0],c=l[1],u=(0,Nt.Z)().darkStyle;return o.createElement(W.Z,{className:"leverageForm",display:"flex",flexDirection:"column",justifyContent:"space-between"},o.createElement(le.Z,{className:"title",id:"range-slider",variant:"h3"},o.createElement(V.Z,{id:"terminal.leverage.adjust"})),o.createElement(W.Z,{className:"inputValue",display:"flex",flexDirection:"row",justifyContent:"space-between"},o.createElement("button",{className:u?"dark":"light",onClick:function(){var e;(e=s-1)>=t&&c(e)},type:"button"},""),o.createElement("input",{className:u?"dark":"light",onBlur:function(){s<t?c(t):s>n&&c(n)},onChange:function(e){var t=e.currentTarget;c(Number(t.value))},value:s}),o.createElement("button",{className:u?"dark":"light",onClick:function(){var e;(e=s+1)<=n&&c(e)},type:"button"},"+")),o.createElement(Ct.Z,{"aria-labelledby":"range-slider",className:"slider",classes:{mark:"mark",thumb:"thumb",track:"track",markLabel:"markLabel"},marks:[{value:1,label:"1"},{value:25,label:"25"},{value:50,label:"50"},{value:75,label:"75"},{value:100,label:"100"},{value:125,label:"125"}],max:n,min:t,onChange:function(e,t){c(t)},step:1,value:s}),n>25&&s>=25&&o.createElement("span",{className:"errorText"},o.createElement(V.Z,{id:"terminal.leverage.alert"})),o.createElement(W.Z,{alignItems:"center",className:"formActions",display:"flex",flexDirection:"row",justifyContent:"space-between"},o.createElement(X.Z,{className:"textDefault",onClick:function(){i()}},o.createElement(V.Z,{id:"terminal.leverage.cancel"})),o.createElement(X.Z,{className:"submitButton",onClick:function(){a("leverage",s),i()}},o.createElement(V.Z,{id:"terminal.leverage.confirm"}))))},Dt=o.memo(Tt),Lt=n(13470),kt=function(e){var t=e.symbolData,n=(0,s.Gc)(),r=n.register,a=n.watch,i=n.setValue,l=a("leverage"),c=a("marginMode"),u=(0,o.useState)(!1),m=u[0],d=u[1],p=(0,Q.Z)(),f="bitmex"===p.exchangeName.toLowerCase(),g="cross"!==c||"bitmex"!==p.exchangeName.toLowerCase();return o.createElement(W.Z,{className:"marginControl"},o.createElement(ge,{descriptionId:"terminal.leverage.help",labelId:"terminal.leverage"}),o.createElement(W.Z,{alignItems:"center",display:"flex",flexDirection:"row"},o.createElement(W.Z,{className:"leverageButton",display:"flex",flexDirection:"column",justifyContent:"flex-end"},o.createElement(Lt.Z,{onClose:function(){return d(!1)},persist:!1,size:"small",state:m},o.createElement(Dt,{leverage:parseInt(l),max:t.maxLeverage,min:1,onClose:function(){d(!1)},setValue:i})),g&&o.createElement(oe.Z,{onClick:function(){return d(!0)}},"cross"===c?"bitmex"===p.exchangeName.toLowerCase()?"Cross":"Cross "+l+"x":l+"x"),o.createElement("input",{name:"leverage",ref:r,type:"hidden"}),o.createElement("input",{name:"marginMode",ref:r,type:"hidden"})),f&&o.createElement(W.Z,{alignItems:"center",className:"mode",display:"flex",flexDirection:"row"},o.createElement(le.Z,{className:"callout1"},o.createElement(V.Z,{id:"terminal.leverage.isolated"})),o.createElement(se.Z,{checked:"cross"===c,onChange:function(e){i("marginMode",e.target.checked?"cross":"isolated")}}),o.createElement(le.Z,{className:"callout1"},o.createElement(V.Z,{id:"terminal.leverage.cross"})))))},At=function(e){var t=e.multiSide,n=e.symbolData,r=(0,s.Gc)(),a=r.errors,i=(0,r.watch)("entryStrategy"),l=(0,o.useContext)(_e).lastPrice,c=ct(n),u=c.validatePrice,m=c.priceChange,d="short"===t?"priceShort":"price",p="multi"===i?"terminal.price."+t:"terminal.price";return o.createElement(gt.Z,null,o.createElement(ge,{descriptionId:"terminal.price.help",labelId:p}),o.createElement(W.Z,{alignItems:"center",display:"flex"},o.createElement(je.Z,{defaultValue:l,name:d,onChange:m,rules:{validate:function(e){return u(e,t)}},showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},n.quote)),a[d]&&o.createElement("span",{className:"errorText"},a[d].message))},zt=function(e){var t=e.multiSide,n=e.symbolData,r=e.loading,a=e.baseBalance,i=(0,s.Gc)(),l=i.errors,c=i.watch,u=ct(n),m=u.unitsChange,d=u.validateUnits,p=c("entryStrategy"),f="short"===t?"unitsShort":"units",g="multi"===p?"terminal.units."+t:"terminal.units";return o.createElement(gt.Z,null,o.createElement(ge,{descriptionId:"terminal.units.help",labelId:g}),o.createElement(W.Z,{alignItems:"center",display:"flex"},o.createElement(je.Z,{name:f,onChange:m,placeholder:"0",readOnly:"multi"===p,rules:{validate:d},showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},n.unitsAmount)),o.createElement(de.Z,null,o.createElement(V.Z,{id:"terminal.available"})," ",r?o.createElement(vt.Z,{color:"primary",size:15}):o.createElement("span",{className:"balance"},(0,H.T4)(a))),l[f]&&o.createElement("span",{className:"errorText"},l[f].message))},Ot=function(e){var t=e.symbolData,n=(0,s.Gc)(),r=n.control,a=n.errors,i=n.register,l=n.watch,c=(0,B.Z)().formatMessage,u=(0,Q.Z)(),m=(0,ft.Z)(u),d=m.balance,p=m.loading,f=d&&d[t.unitsAmount]||0,g=d&&d[t.unitsInvestment]||0,v=ct(t),h=v.positionSizeChange,y=v.realInvestmentChange,E=v.validatePositionSize,x=v.positionSizePercentageChange,b=l("entryType"),P=l("entryStrategy"),Z=(0,o.useContext)(_e).providerService,I=Z?Z.providerConsumedBalance:0,w=Z?Z.providerPayableBalance:0,_=Z?Z.providerConsumedBalancePercentage:0,S=Z&&"1"!==Z.providerId,C=[{label:c({id:"terminal.strategy.limit"}),val:"limit"},{label:c({id:"terminal.strategy.market"}),val:"market"},{label:c({id:"terminal.strategy.stoplimit"}),val:"stop_limit"}];return"futures"===u.exchangeType&&C.push({label:c({id:"terminal.strategy.multi"}),val:"multi"}),S||C.push({label:c({id:"terminal.strategy.import"}),val:"import"}),o.createElement(W.Z,{bgcolor:"grid.main",className:"panel strategyPanel expanded"},o.createElement(W.Z,{alignItems:"center",className:"panelHeader",display:"flex",flexDirection:"row"},o.createElement(W.Z,{alignItems:"center",className:"title",display:"flex",flexDirection:"row"},o.createElement(le.Z,{variant:"h5"},o.createElement(V.Z,{id:"terminal.strategy"})),o.createElement(s.Qr,{as:o.createElement(at.Z,{label:"",onChange:function(){},options:C}),control:r,defaultValue:"limit",name:"entryStrategy"}))),o.createElement(W.Z,{className:"panelContent",display:"flex",flexDirection:"row",flexWrap:"wrap"},"futures"===u.exchangeType&&"multi"!==P&&o.createElement(gt.Z,{className:"entryType"},o.createElement(s.Qr,{as:o.createElement(He.Z,{"aria-label":c({id:"terminal.entrytype"})},o.createElement(Oe.Z,{control:o.createElement(qe.Z,null),label:o.createElement(V.Z,{id:"col.side.long"}),value:"LONG"}),o.createElement(Oe.Z,{control:o.createElement(qe.Z,null),label:o.createElement(V.Z,{id:"col.side.short"}),value:"SHORT"})),control:r,defaultValue:b,name:"entryType"})),"stop_limit"===P&&o.createElement(gt.Z,null,o.createElement(ge,{descriptionId:"terminal.stopprice.help",labelId:"terminal.stopprice"}),o.createElement(W.Z,{alignItems:"center",display:"flex"},o.createElement(je.Z,{name:"stopPrice",rules:{validate:function(e){return!isNaN(e)&&parseFloat(e)>0}},showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},t.quote))),"multi"===P&&o.createElement(Zt.Z,{severity:"info"},o.createElement(V.Z,{id:"terminal.strategy.multi.info"}),o.createElement("br",null),o.createElement(V.Z,{id:"terminal.strategy.multi.strategy"})),"market"!==P?"multi"===P?o.createElement(o.Fragment,null,o.createElement(At,{multiSide:"long",symbolData:t}),o.createElement(At,{multiSide:"short",symbolData:t})):o.createElement(At,{symbolData:t}):o.createElement("input",{name:"price",ref:i,type:"hidden"}),"futures"===u.exchangeType&&!S&&o.createElement(gt.Z,null,o.createElement(ge,{descriptionId:"terminal.realinvest.help",labelId:"terminal.realinvest"}),o.createElement(W.Z,{alignItems:"center",display:"flex"},o.createElement(je.Z,{name:"realInvestment",onChange:y,placeholder:"0",showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},t.unitsInvestment)),o.createElement(de.Z,null,o.createElement(V.Z,{id:"terminal.available"})," ",p?o.createElement(vt.Z,{color:"primary",size:15}):o.createElement("span",{className:"balance"},(0,H.T4)(g)))),!S&&o.createElement(gt.Z,null,o.createElement(ge,{descriptionId:"terminal.position.size.help",labelId:"terminal.position.size"}),o.createElement(W.Z,{alignItems:"center",display:"flex"},o.createElement(je.Z,{name:"positionSize",onChange:h,placeholder:"0",rules:{required:c({id:"terminal.positionsize.required"}),validate:E},showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},t.unitsInvestment)),o.createElement(de.Z,null,o.createElement(V.Z,{id:"terminal.available"})," ",p?o.createElement(vt.Z,{color:"primary",size:15}):o.createElement("span",{className:"balance"},(0,H.T4)(g))),a.positionSize&&o.createElement("span",{className:"errorText"},a.positionSize.message)),S&&o.createElement(gt.Z,null,o.createElement(ge,{descriptionId:"terminal.position.sizepercentage.help",labelId:"terminal.position.sizepercentage"}),o.createElement(W.Z,{className:"positionSizePercentage",display:"flex",flexDirection:"row"},o.createElement(W.Z,{display:"flex",flexDirection:"row"},o.createElement(je.Z,{name:"positionSizePercentage",onChange:x,placeholder:"0",rules:{required:c({id:"terminal.positionsize.percentage.required"}),validate:function(e){return e>0&&e<=100||c({id:"terminal.positionsize.valid.percentage"})}},showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},"%")),o.createElement(W.Z,{display:"flex",flexDirection:"row"},o.createElement(je.Z,{name:"positionSizeAllocated",placeholder:"0",readOnly:!0}),o.createElement("div",{className:"currencyBox"},t.unitsInvestment))),o.createElement(de.Z,null,o.createElement(V.Z,{id:"terminal.provider.allocated"})," ",o.createElement("span",null,(0,H.T4)(w),", "),o.createElement(V.Z,{id:"terminal.provider.consumed"})," ",o.createElement("span",null,(0,H.T4)(I),", "),o.createElement(V.Z,{id:"terminal.provider.available"})," ",o.createElement("span",null,(0,Qe.C2)(100-_),"%")),a.positionSizePercentage&&o.createElement("span",{className:"errorText"},a.positionSizePercentage.message)),!S&&("multi"===P?o.createElement(o.Fragment,null,o.createElement(zt,{baseBalance:f,loading:p,multiSide:"long",symbolData:t}),o.createElement(zt,{baseBalance:f,loading:p,multiSide:"short",symbolData:t})):o.createElement(zt,{baseBalance:f,loading:p,symbolData:t})),"futures"===u.exchangeType&&o.createElement(kt,{symbolData:t}),["limit","multi"].includes(P)&&o.createElement(W.Z,{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"start"},o.createElement(Me,null))))},Mt=o.memo(Ot),jt=function(){var e,t=Ee(),n=t.expanded,r=t.expandClass,a=t.setExpanded,i=(0,s.Gc)(),l=i.clearErrors,c=i.errors,u=(0,B.Z)().formatMessage;return(0,o.useEffect)((function(){n||l("entryExpiration")}),[n]),o.createElement(W.Z,{className:"panel entryExpirationPanel "+r},o.createElement(W.Z,{alignItems:"center",className:"panelHeader",display:"flex",flexDirection:"row"},o.createElement(se.Z,{checked:n,onChange:function(e){return a(e.target.checked)},size:"small"}),o.createElement(W.Z,{alignItems:"center",className:"title",display:"flex",flexDirection:"row"},o.createElement(le.Z,{variant:"h5"},o.createElement(V.Z,{id:"terminal.entryexpiration"})))),n&&o.createElement(W.Z,{className:"panelContent",display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-around"},o.createElement(W.Z,{className:"entryExpiration",display:"flex",flexDirection:"row",flexWrap:"wrap"},o.createElement(ge,{descriptionId:"terminal.entryexpiration.help",labelId:"terminal.entryexpiration"}),o.createElement(W.Z,{alignItems:"center",display:"flex"},o.createElement(je.Z,{name:"entryExpiration",rules:{validate:function(e){return e>0||u({id:"terminal.expiration.limit.zero"})}},showErrorMessage:!1}),o.createElement("div",{className:"currencyBox"},o.createElement(V.Z,{id:"terminal.minutes"}))),c[e="entryExpiration"]?o.createElement("span",{className:"errorText"},c[e].message):null)))},Ft=o.memo(jt),Rt=function(){var e,t=Ee(),n=t.expanded,r=t.expandClass,a=t.setExpanded,i=(0,s.Gc)(),l=i.clearErrors,c=i.errors;return(0,o.useEffect)((function(){n||l("autoclose")}),[n]),o.createElement(W.Z,{className:"panel autoclosePanel "+r},o.createElement(W.Z,{alignItems:"center",className:"panelHeader",display:"flex",flexDirection:"row"},o.createElement(se.Z,{checked:n,onChange:function(e){return a(e.target.checked)},size:"small"}),o.createElement(W.Z,{alignItems:"center",className:"title",display:"flex",flexDirection:"row"},o.createElement(le.Z,{variant:"h5"},o.createElement(V.Z,{id:"terminal.timeautoclose"})))),n&&o.createElement(W.Z,{className:"panelContent",display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-around"},o.createElement(W.Z,{className:"autoclose",display:"flex",flexDirection:"row",flexWrap:"wrap"},o.createElement(ge,{descriptionId:"terminal.timeautoclose.help",labelId:"terminal.timeautoclose"}),o.createElement(W.Z,{alignItems:"center",display:"flex"},o.createElement(je.Z,{name:"autoclose"}),o.createElement("div",{className:"currencyBox"},o.createElement(V.Z,{id:"terminal.hours"}))),c[e="autoclose"]?o.createElement("span",{className:"errorText"},c[e].message):null)))},Bt=o.memo(Rt),Vt=function(e){var t=e.selectedSymbol;return o.createElement(o.Fragment,null,o.createElement(Mt,{symbolData:t}),o.createElement(Be,{symbolData:t}),o.createElement(Xe,{symbolData:t}),o.createElement(mt,{symbolData:t}),o.createElement(pt,{symbolData:t}),o.createElement(Ft,null),o.createElement(Bt,null))},Ut=o.memo(Vt),Wt=function(e){var t=[],n=function(n){var r=e["dcaTargetPricePercentage"+n],a=e["dcaRebuyPercentage"+n],i=e["dcaRebuyPrice"+n],o=e["dcaRebuyPriority"+n],l=e["dcaPostOnly"+n];a&&t.push({targetId:n,priceTargetPercentage:parseFloat(r),priceTarget:parseFloat(i),pricePriority:o,amountPercentage:parseFloat(a),postOnly:l})};return L()(1,51,1).forEach(n),L()(1e3,1051,1).forEach(n),!h()(t)&&t},Gt=function(e){var t=e.lastPrice,n=e.notifyPositionUpdate,r=void 0===n?C():n,a=e.selectedSymbol,i=e.tradingViewWidget,u=e.positionEntity,m=void 0===u?null:u,d=A()(m),f=(0,s.Gc)(),g=f.errors,v=f.handleSubmit,y=f.reset,E=f.watch,x=f.setValue,b=(0,Q.Z)(),P=(0,Y.AP)(),Z=(0,l.I0)(),I=(0,o.useState)(!1),w=I[0],_=I[1],S=(0,B.Z)().formatMessage,N=(0,o.useState)({price:null,stopLossPrice:null,trailingStopPrice:null,dcaTargetPrice1:null,profitTargetPrice1:null}),D=N[0],k=N[1];function z(e){var t=D[e]||null;t&&(t.remove(),D[e]=null,k(Object.assign({},D)))}function M(e){var t,n=e.id,r=e.price,a=e.label,o=e.color,l=D[n]||null;if(!i||!O()(i.chart))return null;if(0===r)return null;if(l)return r!==l.getPrice()&&(l.setPrice(r),l.setQuantity(r)),l;var s=i.chart().createPositionLine({}).setPrice(r).setQuantity(""+r).setText(a).setLineColor(o).setBodyTextColor(o).setBodyBorderColor(o).setQuantityBackgroundColor(o).setQuantityBorderColor(o);return k(Object.assign({},D,((t={})[n]=s,t))),s}var F=function(e){var t=L()(1,10,1),n=[];return t.forEach((function(t){var r=e["takeProfitTargetPricePercentage"+t],a=e["takeProfitTargetPrice"+t],i=e["takeProfitPriority"+t],o=e["takeProfitExitUnitsPercentage"+t],l=e["takeProfitPostOnly"+t];o&&n.push({targetId:t,priceTargetPercentage:parseFloat(r),priceTarget:parseFloat(a),pricePriority:i,amountPercentage:parseFloat(o),postOnly:l})})),!h()(n)&&n},K=function(e){var n=parseFloat(e.positionSize)||0,r=Object.assign({buyType:(0,q.s_)(e.entryStrategy),type:(0,q.s_)(e.entryStrategy),positionSize:n,positionSizeQuote:a.quote,realInvestment:parseFloat(e.realInvestment)||n,limitPrice:e.price||t},"multi"===e.entryStrategy&&{limitPrice_long:e.price,limitPrice_short:e.priceShort,orderType_long:"limit",orderType_short:"limit"});return e.positionSizePercentage?R()(r,{positionSizePercentage:parseFloat(e.positionSizePercentage)||0,providerId:e.providerService||"",providerName:e.providerName||""}):r},ee=function(e){return R()(function(e){var t=b.exchangeName||b.name||"",n=parseFloat(e.entryExpiration),r=parseFloat(e.autoclose);return{pair:a.zignalyId,positionSizeQuote:a.unitsInvestment,side:(0,q.Zp)(e.entryType),stopLossPercentage:void 0!==e.stopLossPercentage&&parseFloat(e.stopLossPercentage),stopLossPrice:parseFloat(e.stopLossPrice),stopLossPriority:e.stopLossPriority||"percentage",stopLossFollowsTakeProfit:"stopLossFollowsTakeProfit"===e.stopLossType,stopLossToBreakEven:"stopLossToBreakEven"===e.stopLossType,buyTTL:(0,p.Ym)(n)||!1,buyStopPrice:parseFloat(e.stopPrice)||0,sellByTTL:(0,p.tv)(r)||0,takeProfitTargets:F(e),reBuyTargets:Wt(e),trailingStopTriggerPercentage:void 0!==e.trailingStopPercentage&&parseFloat(e.trailingStopPercentage),trailingStopTriggerPrice:parseFloat(e.trailingStopPrice)||!1,trailingStopPercentage:parseFloat(e.trailingStopDistance)||!1,trailingStopTriggerPriority:e.trailingStopTriggerPriority||"percentage",providerId:1,providerName:"Manual Trading",exchangeName:t,internalExchangeId:b.internalId,postOnly:e.postOnly}}(e),K(e),{leverage:parseInt(e.leverage)||1,marginMode:e.marginMode||""})};(0,o.useEffect)((function(){x("price",t),x("priceShort",t)}),[t]);var te=E("price"),ne=m?m.buyPrice:parseFloat(te);(0,o.useEffect)((function(){M({id:"price",price:ne||0,label:S({id:"terminal.line.price.label"}),color:G.O.purple})}),[te]);var re=E("stopLossPrice");(0,o.useEffect)((function(){var e=parseFloat(re);e?M({id:"stopLossPrice",price:e||0,label:S({id:"terminal.line.stoploss.label"}),color:G.O.yellow}):z("stopLossPrice")}),[re]);var ae=E("trailingStopPrice");(0,o.useEffect)((function(){var e=parseFloat(ae);e?M({id:"trailingStopPrice",price:e||0,label:S({id:"terminal.line.trailingstop.label"}),color:G.O.blue}):z("trailingStopPrice")}),[ae]);var ie=E(j()(L()(1,51,1),L()(1e3,1051,1)).map((function(e){return"takeProfitTargetPrice"+e})));(0,o.useEffect)((function(){T()(ie,(function(e,t){var n=t.substr(t.length-1),r=parseFloat(e);r?M({id:t,price:r||0,label:S({id:"terminal.line.takeprofit.label"},{index:n}),color:G.O.green}):z(t)}))}),[ie]);var oe=E("dcaTargetPricePercentage1");(0,o.useEffect)((function(){var e=parseFloat(oe);if(oe){var t=$(ne,e);M({id:"dcaTargetPricePercentage1",price:Number((0,H.T4)(t,"",""))||0,label:S({id:"terminal.line.dca.label"},{index:1}),color:G.O.black})}else z("dcaTargetPricePercentage1")}),[oe]);var le=!!m&&m.closed,se=!!m&&m.isCopyTrading,ce=!!m&&m.providerOwnerUserId===P.userId,ue=!!m&&m.updating,me=!!m&&1===m.status,de=se&&!ce||le||ue||me;return o.createElement(W.Z,{bgcolor:"grid.content",className:"strategyForm",textAlign:"center"},o.createElement("form",{method:"post",onSubmit:v((function(e){if(m){var t=function(e){var t=a.quote,n=e.positionSize||e.positionSizePercentage?K(e):{};return R()({positionSizeQuote:t,side:(0,q.Zp)(e.entryType),stopLossPercentage:void 0!==e.stopLossPercentage&&parseFloat(e.stopLossPercentage),stopLossPrice:parseFloat(e.stopLossPrice),stopLossPriority:e.stopLossPriority||"percentage",stopLossFollowsTakeProfit:"stopLossFollowsTakeProfit"===e.stopLossType,stopLossToBreakEven:"stopLossToBreakEven"===e.stopLossType,buyStopPrice:parseFloat(e.stopPrice)||0,takeProfitTargets:!e.reduceTargetPercentage&&F(e),reBuyTargets:Wt(e),trailingStopTriggerPercentage:void 0!==e.trailingStopPercentage&&parseFloat(e.trailingStopPercentage),trailingStopPercentage:parseFloat(e.trailingStopDistance)||!1,trailingStopTriggerPrice:parseFloat(e.trailingStopPrice)||!1,trailingStopTriggerPriority:e.trailingStopTriggerPriority||"percentage",providerId:1,providerName:"Manual Trading",internalExchangeId:m.internalExchangeId,positionId:m.positionId,reduceTargetPercentage:parseFloat(e.reduceTargetPercentage),reduceAvailablePercentage:parseFloat(e.reduceAvailablePercentage),reduceOrderType:e.reduceOrderType,reduceRecurring:e.reduceRecurring,reducePersistent:e.reducePersistent,removeReduceRecurringPersistent:!1===e.reduceRecurringPersistent,removeReduceOrder:e.removeReduceOrder,postOnly:e.postOnly},n)}(e);!function(e){_(!0),c.Z.manualPositionUpdate(e).then((function(){Z((0,J.O7)("terminal.updated.title",S({id:"terminal.updated.body"},{positionId:m.positionId}))),r()})).catch((function(e){Z((0,J.jx)(e))})).finally((function(){_(!1)}))}(t)}else{!function(e){_(!0),c.Z.manualPositionCreate(e).then((function(e){y(),Z((0,J.O7)("",S({id:"terminal.open.success"}))),(0,U.navigate)("/position/"+e)})).catch((function(e){Z((0,J.jx)(e))})).finally((function(){_(!1)}))}(ee(e))}}))},d?o.createElement(St,{isReadOnly:de,positionEntity:m,selectedSymbol:a}):o.createElement(Ut,{selectedSymbol:a}),!de&&o.createElement(X.Z,{className:"full submitButton",disabled:!h()(g)||w,loading:w,type:"submit"},d?o.createElement(V.Z,{id:"terminal.update"}):o.createElement(V.Z,{id:"terminal.open"}))))},Ht=o.memo(Gt),qt=n(61169),Qt=n(54193),Yt=function(e){var t=e.symbolsList,n=e.handleSymbolChange,r=e.selectedSymbol,a=(0,s.Gc)(),i=a.control,c=a.watch,u=ht().ownCopyTraderProviders,m=(0,B.Z)().formatMessage,d=(0,Nt.Z)(),p=(0,l.I0)(),f=(0,o.useContext)(_e),g=f.providerService,v=f.setProviderService,h=c("providerService"),y=(0,o.useState)(null),E=y[0],x=y[1],b=(0,Q.Z)(),P=u.map((function(e){return{label:e.providerName,val:String(e.providerId)}})),Z=P.find((function(e){return e.val===d.tradingTerminal.provider}))?d.tradingTerminal.provider:P[0]?P[0].val:"";(0,o.useEffect)((function(){if(u){var e=u.find((function(e){return e.providerId===h}))||{providerPayableBalance:0,providerConsumedBalance:0,providerConsumedBalancePercentage:0,providerName:m({id:"terminal.provider.manual"}),providerQuote:"",providerId:"1"};v(e)}}),[h,u]),(0,o.useEffect)((function(){t&&x(t.reduce((function(e,t){var n=!0;if(g&&h&&"1"!==h&&"bitmex"!==b.exchangeName.toLowerCase()){var r=g.providerQuote;r||t.short.includes("/"+r)||(n=!1)}return n&&e.push(t.short),e}),[]))}),[h]);return(0,ke.Z)((function(){p((0,Qt.KL)({exchangeId:b.exchangeId,pair:r}))}),[r]),o.createElement(W.Z,{bgcolor:"grid.content",className:"controlsBar",display:"flex",flexDirection:"row"},g&&E&&o.createElement(o.Fragment,null,o.createElement(W.Z,{alignContent:"left",className:"symbolsSelector",display:"flex",flexDirection:"column"},o.createElement(le.Z,{variant:"body1"},o.createElement(V.Z,{id:"terminal.browsecoins"})),o.createElement(qt.ZP,{label:"",onChange:n,options:E,search:!0,value:r})),ie()(u)>1&&o.createElement(W.Z,{alignContent:"left",className:"providersSelector",display:"flex",flexDirection:"column"},o.createElement(le.Z,{variant:"body1"},o.createElement(V.Z,{id:"terminal.providers"})),o.createElement(s.Qr,{control:i,defaultValue:Z,name:"providerService",render:function(e){var t=e.onChange,n=e.value;return o.createElement(qt.ZP,{label:"",onChange:function(e){p((0,Qt.dA)(e)),t(e)},options:P,value:n})}}))))},Jt=n(23082),$t=n(47037),Kt=n.n($t);function Xt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return en(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return en(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function en(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function tn(e,t){var n=Object.assign({},e);for(var r in t)"object"!=typeof e[r]||null===e[r]||Array.isArray(e[r])?void 0!==t[r]&&(n[r]=t[r]):n[r]=tn(e[r],t[r]);return n}var nn={mobile:{disabled_features:["left_toolbar","header_widget","timeframes_toolbar","edit_buttons_in_legend","context_menus","control_bar","border_around_the_chart"],enabled_features:[]}},rn={width:800,height:500,interval:"1D",timezone:"Etc/UTC",container:"",library_path:"",locale:"en",widgetbar:{details:!1,watchlist:!1,watchlist_settings:{default_symbols:[]}},overrides:{"mainSeriesProperties.showCountdown":!1},studies_overrides:{},trading_customization:{position:{},order:{}},brokerConfig:{configFlags:{}},fullscreen:!1,autosize:!1,disabled_features:[],enabled_features:[],debug:!1,logo:{},time_frames:[{text:"5y",resolution:"1W"},{text:"1y",resolution:"1W"},{text:"6m",resolution:"120"},{text:"3m",resolution:"60"},{text:"1m",resolution:"30"},{text:"5d",resolution:"5"},{text:"1d",resolution:"1"}],client_id:"0",user_id:"0",charts_storage_api_version:"1.0",favorites:{intervals:[],chartTypes:[]}};var an=function(){function e(e){if(this._id="tradingview_"+(1048576*(1+Math.random())|0).toString(16).substring(1),this._ready=!1,this._readyHandlers=[],this._onWindowResize=this._autoResizeChart.bind(this),!e.datafeed)throw new Error("Datafeed is not defined");if(this._options=tn(rn,e),e.preset){var t=nn[e.preset];t?(void 0!==this._options.disabled_features?this._options.disabled_features=this._options.disabled_features.concat(t.disabled_features):this._options.disabled_features=t.disabled_features,void 0!==this._options.enabled_features?this._options.enabled_features=this._options.enabled_features.concat(t.enabled_features):this._options.enabled_features=t.enabled_features):console.warn("Unknown preset: `"+e.preset+"`")}"Dark"===this._options.theme&&void 0===this._options.loading_screen&&(this._options.loading_screen={backgroundColor:"#131722"}),this._create()}var t=e.prototype;return t.onChartReady=function(e){this._ready?e.call(this):this._readyHandlers.push(e)},t.headerReady=function(){var e=this;return this._innerWindowLoaded.then((function(){return e._innerWindow().headerReady()}))},t.onGrayedObjectClicked=function(e){this._innerAPI().onGrayedObjectClicked(e)},t.onShortcut=function(e,t){this._innerWindow().createShortcutAction(e,t)},t.subscribe=function(e,t){this._innerAPI().subscribe(e,t)},t.unsubscribe=function(e,t){this._innerAPI().unsubscribe(e,t)},t.chart=function(e){return this._innerAPI().chart(e)},t.getLanguage=function(){return this._options.locale},t.setSymbol=function(e,t,n){this._innerAPI().changeSymbol(e,t,n)},t.remove=function(){window.removeEventListener("resize",this._onWindowResize),this._readyHandlers.splice(0,this._readyHandlers.length),delete window[this._id],this._iFrame.parentNode&&this._iFrame.parentNode.removeChild(this._iFrame)},t.closePopupsAndDialogs=function(){this._innerAPI().closePopupsAndDialogs()},t.selectLineTool=function(e){this._innerAPI().selectLineTool(e)},t.selectedLineTool=function(){return this._innerAPI().selectedLineTool()},t.save=function(e){this._innerAPI().saveChart(e)},t.load=function(e,t){this._innerAPI().loadChart({json:e,extendedData:t})},t.getSavedCharts=function(e){this._innerAPI().getSavedCharts(e)},t.loadChartFromServer=function(e){this._innerAPI().loadChartFromServer(e)},t.saveChartToServer=function(e,t,n){this._innerAPI().saveChartToServer(e,t,n)},t.removeChartFromServer=function(e,t){this._innerAPI().removeChartFromServer(e,t)},t.onContextMenu=function(e){this._innerAPI().onContextMenu(e)},t.createButton=function(e){return this._innerWindow().createButton(e)},t.showNoticeDialog=function(e){this._innerAPI().showNoticeDialog(e)},t.showConfirmDialog=function(e){this._innerAPI().showConfirmDialog(e)},t.showLoadChartDialog=function(){this._innerAPI().showLoadChartDialog()},t.showSaveAsChartDialog=function(){this._innerAPI().showSaveAsChartDialog()},t.symbolInterval=function(){return this._innerAPI().getSymbolInterval()},t.mainSeriesPriceFormatter=function(){return this._innerAPI().mainSeriesPriceFormatter()},t.getIntervals=function(){return this._innerAPI().getIntervals()},t.getStudiesList=function(){return this._innerAPI().getStudiesList()},t.addCustomCSSFile=function(e){this._innerWindow().addCustomCSSFile(e)},t.applyOverrides=function(e){this._options=tn(this._options,{overrides:e}),this._innerWindow().applyOverrides(e)},t.applyStudiesOverrides=function(e){this._innerWindow().applyStudiesOverrides(e)},t.watchList=function(){return this._innerAPI().watchlist()},t.activeChart=function(){return this._innerAPI().activeChart()},t.chartsCount=function(){return this._innerAPI().chartsCount()},t.layout=function(){return this._innerAPI().layout()},t.setLayout=function(e){this._innerAPI().setLayout(e)},t.layoutName=function(){return this._innerAPI().layoutName()},t.changeTheme=function(e,t){this._innerWindow().changeTheme(e,t)},t.getTheme=function(){return this._innerWindow().getTheme()},t.takeScreenshot=function(){this._innerAPI().takeScreenshot()},t.lockAllDrawingTools=function(){return this._innerAPI().lockAllDrawingTools()},t.hideAllDrawingTools=function(){return this._innerAPI().hideAllDrawingTools()},t.drawOnAllCharts=function(e){this._innerAPI().drawOnAllCharts(e)},t.magnetEnabled=function(){return this._innerAPI().magnetEnabled()},t.magnetMode=function(){return this._innerAPI().magnetMode()},t.undoRedoState=function(){return this._innerAPI().undoRedoState()},t.setIntervalLinkingEnabled=function(e){this._innerAPI().setIntervalLinkingEnabled(e)},t.setTimeFrame=function(e){this._innerAPI().setTimeFrame(e)},t.symbolSync=function(){return this._innerAPI().symbolSync()},t.intervalSync=function(){return this._innerAPI().intervalSync()},t.crosshairSync=function(){return this._innerAPI().crosshairSync()},t.timeSync=function(){return this._innerAPI().timeSync()},t.getAllFeatures=function(){return this._innerWindow().getAllFeatures()},t.clearUndoHistory=function(){return this._innerAPI().clearUndoHistory()},t.undo=function(){return this._innerAPI().undo()},t.redo=function(){return this._innerAPI().redo()},t.startFullscreen=function(){this._innerAPI().startFullscreen()},t.exitFullscreen=function(){this._innerAPI().exitFullscreen()},t.takeClientScreenshot=function(e){return this._innerAPI().takeClientScreenshot(e)},t._innerAPI=function(){return this._innerWindow().tradingViewApi},t._innerWindow=function(){return this._iFrame.contentWindow},t._autoResizeChart=function(){this._options.fullscreen&&(this._iFrame.style.height=window.innerHeight+"px")},t._create=function(){var e=this,t=this._render();this._options.container_id&&console.warn("`container_id` is now deprecated. Please use `container` instead to either still pass a string or an `HTMLElement`.");var n=this._options.container_id||this._options.container,r="string"==typeof n?document.getElementById(n):n;if(null===r)throw new Error("There is no such element - #"+this._options.container);r.innerHTML=t,this._iFrame=r.querySelector("#"+this._id);var a=this._iFrame;(this._options.autosize||this._options.fullscreen)&&(a.style.width="100%",this._options.fullscreen||(a.style.height="100%")),window.addEventListener("resize",this._onWindowResize),this._onWindowResize(),this._innerWindowLoaded=new Promise((function(e){a.addEventListener("load",(function t(){a.removeEventListener("load",t,!1),e()}),!1)})),this._innerWindowLoaded.then((function(){e._innerWindow().widgetReady((function(){e._ready=!0;for(var n,r=Xt(e._readyHandlers);!(n=r()).done;){var a=n.value;try{a.call(e)}catch(t){console.error(t)}}e._innerWindow().initializationFinished()}))}))},t._render=function(){var e=window;if(e[this._id]={datafeed:this._options.datafeed,customFormatters:this._options.custom_formatters||this._options.customFormatters,brokerFactory:this._options.broker_factory||this._options.brokerFactory,overrides:this._options.overrides,studiesOverrides:this._options.studies_overrides,tradingCustomization:this._options.trading_customization,disabledFeatures:this._options.disabled_features,enabledFeatures:this._options.enabled_features,brokerConfig:this._options.broker_config||this._options.brokerConfig,restConfig:this._options.restConfig,favorites:this._options.favorites,logo:this._options.logo,numeric_formatting:this._options.numeric_formatting,rss_news_feed:this._options.rss_news_feed,newsProvider:this._options.news_provider,loadLastChart:this._options.load_last_chart,saveLoadAdapter:this._options.save_load_adapter,loading_screen:this._options.loading_screen,settingsAdapter:this._options.settings_adapter,getCustomIndicators:this._options.custom_indicators_getter,additionalSymbolInfoFields:this._options.additional_symbol_info_fields,headerWidgetButtonsMode:this._options.header_widget_buttons_mode},this._options.saved_data)e[this._id].chartContent={json:this._options.saved_data},this._options.saved_data_meta_info&&(e[this._id].chartContentExtendedData=this._options.saved_data_meta_info);else if(!this._options.load_last_chart&&!this._options.symbol)throw new Error("Symbol is not defined: either 'symbol' or 'load_last_chart' option must be set");var t=(this._options.library_path||"")+(encodeURIComponent(this._options.locale)+"-tv-chart.93881eb6.html#symbol=")+encodeURIComponent(this._options.symbol||"")+"&interval="+encodeURIComponent(this._options.interval)+(this._options.timeframe?"&timeframe="+encodeURIComponent(this._options.timeframe):"")+(this._options.toolbar_bg?"&toolbarbg="+encodeURIComponent(this._options.toolbar_bg.replace("#","")):"")+(this._options.studies_access?"&studiesAccess="+encodeURIComponent(JSON.stringify(this._options.studies_access)):"")+"&widgetbar="+encodeURIComponent(JSON.stringify(this._options.widgetbar))+(this._options.drawings_access?"&drawingsAccess="+encodeURIComponent(JSON.stringify(this._options.drawings_access)):"")+"&timeFrames="+encodeURIComponent(JSON.stringify(this._options.time_frames))+"&locale="+encodeURIComponent(this._options.locale)+"&uid="+encodeURIComponent(this._id)+"&clientId="+encodeURIComponent(String(this._options.client_id))+"&userId="+encodeURIComponent(String(this._options.user_id))+(this._options.charts_storage_url?"&chartsStorageUrl="+encodeURIComponent(this._options.charts_storage_url):"")+(this._options.charts_storage_api_version?"&chartsStorageVer="+encodeURIComponent(this._options.charts_storage_api_version):"")+(this._options.custom_css_url?"&customCSS="+encodeURIComponent(this._options.custom_css_url):"")+(this._options.auto_save_delay?"&autoSaveDelay="+encodeURIComponent(String(this._options.auto_save_delay)):"")+"&debug="+encodeURIComponent(String(this._options.debug))+(this._options.snapshot_url?"&snapshotUrl="+encodeURIComponent(this._options.snapshot_url):"")+(this._options.timezone?"&timezone="+encodeURIComponent(this._options.timezone):"")+(this._options.study_count_limit?"&studyCountLimit="+encodeURIComponent(String(this._options.study_count_limit)):"")+(this._options.symbol_search_request_delay?"&ssreqdelay="+encodeURIComponent(String(this._options.symbol_search_request_delay)):"")+(this._options.compare_symbols?"&compareSymbols="+encodeURIComponent(JSON.stringify(this._options.compare_symbols)):"")+(this._options.theme?"&theme="+encodeURIComponent(String(this._options.theme)):"")+(this._options.header_widget_buttons_mode?"&header_widget_buttons_mode="+encodeURIComponent(String(this._options.header_widget_buttons_mode)):"")+(this._options.time_scale?"&time_scale="+encodeURIComponent(JSON.stringify(this._options.time_scale)):"");return'<iframe id="'+this._id+'" name="'+this._id+'"  src="'+t+'"'+(this._options.autosize||this._options.fullscreen?"":' width="'+this._options.width+'" height="'+this._options.height+'"')+' frameborder="0" allowTransparency="true" scrolling="no" allowfullscreen style="display:block;"></iframe>'},e}();window.TradingView=window.TradingView||{},window.TradingView.version=function(){return"CL v20.030 (internal id 93881eb6 @ 2021-10-01T13:05:17.158Z)"};var on=function(e){var t=(0,o.useState)({widget:null,options:null,isSelfHosted:!1}),n=t[0],r=t[1],a=(0,o.useRef)(null);(0,o.useEffect)((function(){return function(){a.current&&(window.removeEventListener("message",a.current),a.current=null),n.widget&&i()}}),[]);var i=function(){n&&n.widget&&n.widget.remove(),r((function(e){return Object.assign({},e,{widget:null})}))};return{instantiateWidget:function(t){if(Boolean(t.datafeed)){var n=new an(t);n.onChartReady((function(){r({widget:n,options:t,isSelfHosted:!0});var a=t.datafeed.getLastPrice();e(parseFloat(a))}))}else var i=setInterval((function(){Boolean(window.TradingView&&window.TradingView.widget)&&(!function(t){var n=new window.TradingView.widget(t),i="",o=function(a){if(Kt()(a.data))try{var o=JSON.parse(a.data);if("widgetReady"===o.name&&r({widget:n,options:t,isSelfHosted:!1}),"quoteUpdate"===o.name&&o.data&&i!==o.data.original_name){var l=rt()(o.data.last_price)?(0,H.T4)(o.data.last_price,"",""):o.data.last_price;e(l),i=o.data.original_name}}catch(tn){return}A()(a.data)&&"tv-widget-no-data"===a.data.name&&(r({widget:n,options:t,isSelfHosted:!1}),e(null))};a.current=o,window.addEventListener("message",o)}(t),clearInterval(i))}),100)},tradingViewWidget:n.widget,changeSymbol:function(t,r){if(n.widget&&(n.isSelfHosted||n.widget.iframe))if(n.widget.iframe){var a=function(e,t){var n=e+("bitmex"!==t.exchangeName.toLowerCase()&&"futures"===t.exchangeType?"PERP":"");return function(e){if(!e)return"BINANCE";var t=e.toUpperCase();return"ZIGNALY"===t?"BINANCE":t}(t.exchangeName||t.name)+":"+n}(t,r);n.widget.iframe.contentWindow.postMessage({name:"set-symbol",data:{symbol:a}},"*")}else{n.widget.chart().setSymbol(t,(function(){var t=n.options.datafeed.getLastPrice();e(parseFloat(t))}))}else console.error("LOG: tradingViewWidget wasn't initialized before symbol change")},removeWidget:i,isSelfHosted:n.isSelfHosted}},ln=function(){var e=(0,o.useState)(null),t=e[0],n=e[1],r=(0,o.useState)(null),a=r[0],i=r[1],l=(0,o.useState)(null);return{providerService:t,setProviderService:n,updatedAt:a,setUpdatedAt:i,lastPrice:l[0],setLastPrice:l[1]}},sn={kucoin:"BTC/USDT",binance:"BTC/USDT",zignaly:"BTC/USDT",bitmex:"XBTUSD",fallback:"BTC/USDT"},cn=function(){var e=ln(),t=e.lastPrice,n=e.setLastPrice,a=on(n),u=a.instantiateWidget,m=a.tradingViewWidget,d=a.changeSymbol,p=a.removeWidget,f=a.isSelfHosted,g=(0,Nt.Z)(),v=(0,o.useState)(null),h=v[0],y=v[1],E=(0,l.I0)(),x=(0,Q.Z)(),b=function(){var e=(0,r.Z)(i().mark((function e(){var t,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={exchangeInternalId:x.internalId},e.prev=1,e.next=4,c.Z.exchangeConnectionMarketDataGet(t);case 4:n=e.sent,y(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),E((0,J.jx)(e.t0));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),P=x.exchangeName||x.name,Z=function(e){return e&&h?h.find((function(t){return t.short===e})):null},I=(0,o.useState)(null),w=I[0],S=I[1];(0,o.useEffect)((function(){h&&S(function(){for(var e=0,t=[g.tradingTerminal.pair[x.exchangeId],sn[P.toLowerCase()],sn.fallback];e<t.length;e++){var n=t[e];if(n){var r=Z(n);if(r)return r}}return null}())}),[h]);var C=(0,o.useState)(x.internalId),N=C[0],T=C[1],D=null===m||null===w,L=null===t;(0,o.useEffect)((function(){y(null),S(null),b(),N!==x.internalId&&(n(null),p(),T(N))}),[N]),(0,o.useEffect)((function(){p(),k()}),[g.darkStyle]);var k=function(){if(w&&!m){var e=_({exchange:x,symbolsData:h,symbol:w.tradeViewSymbol,darkStyle:g.darkStyle});u(e)}};(0,o.useEffect)(k,[m,w]),(0,o.useEffect)((function(){if(!f&&m)var e=setInterval((function(){m&&m.iframe&&m.iframe.contentWindow&&w&&(d(w.tradeViewSymbol,x),clearInterval(e))}),100)}),[m]);var A=(0,s.cI)({mode:"onChange",defaultValues:{entryType:"LONG",leverage:1,positionSize:"",realInvestment:"",stopLossPrice:"",trailingStopPrice:"",units:"",dcaTargetPricePercentage1:""}});return o.createElement(_e.Provider,{value:e},o.createElement(s.RV,A,o.createElement(W.Z,{className:"tradingTerminal",display:"flex",flexDirection:"column",width:1},!D&&o.createElement(Yt,{handleSymbolChange:function(e){var t=Z(e);S(t),d(t.tradeViewSymbol,x)},selectedSymbol:w.short,symbolsList:h}),o.createElement(W.Z,{className:"tradingViewContainer",display:"flex",flexDirection:"row",flexWrap:"wrap",width:1},D&&o.createElement(W.Z,{className:"loadProgress",display:"flex",flexDirection:"row",justifyContent:"center"},o.createElement(vt.Z,{disableShrink:!0})),o.createElement(W.Z,{className:"tradingViewChart"},o.createElement("div",{id:"trading_view_chart"}),!D&&o.createElement(le.Z,{color:"textSecondary"},o.createElement("a",{href:"https://www.tradingview.com/symbols/"+w.tradeViewSymbol,target:"_blank",rel:"noreferrer"},w.symbol," by TradingView"))),!D&&!L&&t&&o.createElement(Ht,{lastPrice:t,selectedSymbol:w,tradingViewWidget:m})))))},un=function(){var e=(0,Q.Z)();return(0,Y.rP)().loaded?e.internalId?o.createElement(cn,null):o.createElement(Jt.Z,null):o.createElement(W.Z,{alignItems:"center",className:"loadingBox",display:"flex",flexDirection:"row",justifyContent:"center"},o.createElement(vt.Z,{size:50}))},mn=o.memo(un),dn=n(78718),pn=n.n(dn),fn=n(23495),gn=function(e){var t=e.positionId,n=ln(),r=n.setLastPrice,a=n.lastPrice,i=n.setUpdatedAt,u=on(r),m=u.instantiateWidget,d=u.tradingViewWidget,p=u.isSelfHosted,f=u.changeSymbol,g=u.removeWidget,v=(0,o.useState)(null),h=v[0],y=v[1],E=(0,o.useState)(null),x=E[0],b=E[1],P=(0,o.useState)(null),Z=P[0],I=P[1],w=(0,o.useState)(!1),S=w[0],C=w[1],N=(0,o.useState)((0,q.Sq)()),T=N[0],D=N[1],L=(0,Nt.Z)(),k=(0,Q.Z)(),A=(0,Y.zJ)(),z=(0,Y.AP)(),O=(0,l.I0)(),M=function(){var e={positionId:t,internalExchangeId:k.internalId};c.Z.positionGet(e).then((function(e){var t,n,r,a;y(e),n={exchangeInternalId:(t=e).exchangeInternalId,exchange:t.exchange,exchangeType:t.exchangeType},c.Z.exchangeConnectionMarketDataGet(n).then((function(e){var n=e.find((function(e){return e.short===t.short}));n||(n=Object.assign({},(0,q.ud)(),{id:t.symbol,base:t.base,baseId:t.base,quote:t.quote,quoteId:t.quote,short:t.short,tradeViewSymbol:t.tradeViewSymbol,limits:{}})),I(n)})).catch((function(e){O((0,J.jx)(e))})),r=e.internalExchangeId,(a=A.find((function(e){return e.internalId===r})))&&D(a)})).catch((function(e){O((0,J.jx)(e))})),z.isAdmin&&c.Z.positionRawGet(e).then((function(e){b(e)}))};(0,o.useEffect)((function(){M()}),[]),(0,o.useEffect)((function(){g(),F()}),[L.darkStyle]);var j=!h||!Z&&!(void 0===Z),F=function(){if(Z&&!d){var e=_({exchange:k,symbolsData:[Z],symbol:h.tradeViewSymbol,darkStyle:L.darkStyle});m(e)}};(0,o.useEffect)(F,[Z,d]);(0,o.useEffect)((function(){if(!p&&d)var e=setInterval((function(){d&&d.iframe&&d.iframe.contentWindow&&Z&&(f(Z.tradeViewSymbol,T),clearInterval(e))}),100)}),[d]);var R=(0,s.cI)({mode:"onChange",defaultValues:{entryType:"LONG",leverage:1,positionSize:"",realInvestment:"",stopLossPrice:"",trailingStopPrice:"",units:"",dcaTargetPricePercentage1:"",dcaRebuyPercentage1:"",priceDifference:0}});return o.createElement(_e.Provider,{value:n},o.createElement(s.RV,R,o.createElement(W.Z,{className:"tradingTerminal",display:"flex",flexDirection:"column",width:1},h&&o.createElement(fn.Z,{notifyPositionsUpdate:function(e){if(st()(e)){var t=e[0],n=["updating","closed","status","reBuyTargets","positionSizeQuote","reduceOrders"];!Ge()(pn()(h,n),pn()(t,n))&&y(t),R.setValue("priceDifference",t.priceDifference)}},positionEntity:h,type:h.closed&&"closed"===h.type?"closed":h.closed&&"log"===h.type?"log":"open"}),o.createElement(W.Z,{bgcolor:"grid.content",className:"tradingViewContainer",display:"flex",flexDirection:"row",flexWrap:"wrap",width:1},j&&o.createElement(W.Z,{className:"loadProgress",display:"flex",flexDirection:"row",justifyContent:"center"},o.createElement(vt.Z,{disableShrink:!0})),o.createElement(W.Z,{className:"tradingViewChart"},o.createElement("div",{id:"trading_view_chart"}),!j&&o.createElement(le.Z,{color:"textSecondary"},o.createElement("a",{href:"https://www.tradingview.com/symbols/"+Z.tradeViewSymbol,target:"_blank",rel:"noreferrer"},Z.symbol," by TradingView"))),!j&&o.createElement(Ht,{lastPrice:a,notifyPositionUpdate:function(){M(),i(new Date)},positionEntity:h,selectedSymbol:Z,tradingViewWidget:d})),z.isAdmin&&t&&o.createElement(W.Z,{marginTop:2,maxWidth:"300px",minWidth:"300px"},o.createElement(X.Z,{className:"submitButton",loading:S,onClick:function(){C(!0);var e={internalExchangeId:k.internalId,positionId:t};c.Z.recoverPosition(e).then((function(){O((0,J.O7)("","request submitted to recover position"))})).catch((function(e){O((0,J.jx)(e))})).finally((function(){C(!1)}))}},"Recover Position")),x&&o.createElement(W.Z,{alignItems:"center",display:"flex",flexDirection:"column",mt:"24px"},o.createElement(le.Z,{variant:"h6"},"Debug"),o.createElement("pre",null,JSON.stringify(x,null,2))))))},vn=o.memo(gn)},30789:function(e,t,n){"use strict";n(17727);var r=n(67294),a=n(45850),i=n(19199),o=n(66718);t.Z=function(e,t){void 0===t&&(t=!0);var n=(0,r.useState)({}),l=n[0],s=n[1],c=(0,r.useState)(!1),u=c[0],m=c[1],d=(0,i.I0)();return(0,r.useEffect)((function(){e.internalId&&!e.paperTrading&&t&&(m(!0),a.Z.userAvailableBalanceGet(e.internalId).then((function(e){s(e)})).catch((function(e){d((0,o.jx)(e))})).finally((function(){m(!1)})))}),[e.internalId]),{balance:l,loading:u}}},82579:function(e,t,n){"use strict";var r=n(18446),a=n.n(r),i=n(28583),o=n.n(i),l=n(67294),s=n(54193),c=n(19199),u=n(29093);t.Z=function(e,t,n,r){var i=function(){var r={};return Object.keys(e).forEach((function(a){if(r[a]=e[a],t&&t[a]){var i=typeof t[a]==typeof e[a],o=!Boolean(n[a]&&n[a].length)||n[a].find((function(e){return(0,u.$)(e)===(0,u.$)(t[a])}));i&&o&&(r[a]=t[a])}})),r},m=(0,l.useState)(i()),d=m[0],p=m[1],f=(0,c.I0)(),g=(0,l.useRef)(n),v=d;a()(g.current,n)||(v=i(),g.current=n,p(v));var h,y=function(e){f((0,s.rr)({filters:e,page:r}))};return{filters:v,setFilters:function(e){var t=o()({},d,e);p(t),y(t)},clearFilters:function(){var t={};Object.keys(d).forEach((function(n){t[n]=e[n]})),p(t),y(t)},modifiedFilters:(h=0,Object.entries(d).forEach((function(t){var n=t[0];t[1]!==e[n]&&h++})),h)}}},62663:function(e){e.exports=function(e,t,n,r){var a=-1,i=null==e?0:e.length;for(r&&i&&(n=e[++a]);++a<i;)n=t(n,e[a],a,e);return n}},49029:function(e){var t=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;e.exports=function(e){return e.match(t)||[]}},53325:function(e){e.exports=function(e,t){return e>t}},70433:function(e){e.exports=function(e,t){return e<t}},25970:function(e,t,n){var r=n(63012),a=n(79095);e.exports=function(e,t){return r(e,t,(function(t,n){return a(e,n)}))}},18674:function(e){e.exports=function(e){return function(t){return null==e?void 0:e[t]}}},40098:function(e){var t=Math.ceil,n=Math.max;e.exports=function(e,r,a,i){for(var o=-1,l=n(t((r-e)/(a||1)),0),s=Array(l);l--;)s[i?l:++o]=e,e+=a;return s}},5076:function(e,t,n){var r=n(89881);e.exports=function(e,t){var n;return r(e,(function(e,r,a){return!(n=t(e,r,a))})),!!n}},67762:function(e){e.exports=function(e,t){for(var n,r=-1,a=e.length;++r<a;){var i=t(e[r]);void 0!==i&&(n=void 0===n?i:n+i)}return n}},47415:function(e,t,n){var r=n(29932);e.exports=function(e,t){return r(t,(function(t){return e[t]}))}},54290:function(e,t,n){var r=n(6557);e.exports=function(e){return"function"==typeof e?e:r}},35393:function(e,t,n){var r=n(62663),a=n(53816),i=n(58748),o=RegExp("[']","g");e.exports=function(e){return function(t){return r(i(a(t).replace(o,"")),e,"")}}},47445:function(e,t,n){var r=n(40098),a=n(16612),i=n(18601);e.exports=function(e){return function(t,n,o){return o&&"number"!=typeof o&&a(t,n,o)&&(n=o=void 0),t=i(t),void 0===n?(n=t,t=0):n=i(n),o=void 0===o?t<n?1:-1:i(o),r(t,n,o,e)}}},92994:function(e,t,n){var r=n(14841);e.exports=function(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=r(t),n=r(n)),e(t,n)}}},69389:function(e,t,n){var r=n(18674)({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"});e.exports=r},99021:function(e,t,n){var r=n(85564),a=n(45357),i=n(30061);e.exports=function(e){return i(a(e,void 0,r),e+"")}},93157:function(e){var t=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;e.exports=function(e){return t.test(e)}},2757:function(e){var t="\\u2700-\\u27bf",n="a-z\\xdf-\\xf6\\xf8-\\xff",r="A-Z\\xc0-\\xd6\\xd8-\\xde",a="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",i="["+a+"]",o="\\d+",l="[\\u2700-\\u27bf]",s="["+n+"]",c="[^\\ud800-\\udfff"+a+o+t+n+r+"]",u="(?:\\ud83c[\\udde6-\\uddff]){2}",m="[\\ud800-\\udbff][\\udc00-\\udfff]",d="["+r+"]",p="(?:"+s+"|"+c+")",f="(?:"+d+"|"+c+")",g="(?:['](?:d|ll|m|re|s|t|ve))?",v="(?:['](?:D|LL|M|RE|S|T|VE))?",h="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",y="[\\ufe0e\\ufe0f]?",E=y+h+("(?:\\u200d(?:"+["[^\\ud800-\\udfff]",u,m].join("|")+")"+y+h+")*"),x="(?:"+[l,u,m].join("|")+")"+E,b=RegExp([d+"?"+s+"+"+g+"(?="+[i,d,"$"].join("|")+")",f+"+"+v+"(?="+[i,d+p,"$"].join("|")+")",d+"?"+p+"+"+g,d+"+"+v,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",o,x].join("|"),"g");e.exports=function(e){return e.match(b)||[]}},68929:function(e,t,n){var r=n(48403),a=n(35393)((function(e,t,n){return t=t.toLowerCase(),e+(n?r(t):t)}));e.exports=a},57043:function(e,t,n){var r=n(62488),a=n(21078),i=n(278),o=n(1469);e.exports=function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),n=arguments[0],l=e;l--;)t[l-1]=arguments[l];return r(o(n)?i(n):[n],a(t,1))}},53816:function(e,t,n){var r=n(69389),a=n(79833),i=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,o=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");e.exports=function(e){return(e=a(e))&&e.replace(i,r).replace(o,"")}},85564:function(e,t,n){var r=n(21078);e.exports=function(e){return(null==e?0:e.length)?r(e,1):[]}},62620:function(e,t,n){var r=n(28483),a=n(54290),i=n(81704);e.exports=function(e,t){return null==e?e:r(e,a(t),i)}},10551:function(e,t,n){var r=n(53325),a=n(92994)(r);e.exports=a},81763:function(e,t,n){var r=n(44239),a=n(37005);e.exports=function(e){return"number"==typeof e||a(e)&&"[object Number]"==r(e)}},10928:function(e){e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},32304:function(e,t,n){var r=n(70433),a=n(92994)(r);e.exports=a},78718:function(e,t,n){var r=n(25970),a=n(99021)((function(e,t){return null==e?{}:r(e,t)}));e.exports=a},96026:function(e,t,n){var r=n(47445)();e.exports=r},59704:function(e,t,n){var r=n(82908),a=n(67206),i=n(5076),o=n(1469),l=n(16612);e.exports=function(e,t,n){var s=o(e)?r:i;return n&&l(e,t,n)&&(t=void 0),s(e,a(t,3))}},12297:function(e,t,n){var r=n(67762),a=n(6557);e.exports=function(e){return e&&e.length?r(e,a):0}},52628:function(e,t,n){var r=n(47415),a=n(3674);e.exports=function(e){return null==e?[]:r(e,a(e))}},58748:function(e,t,n){var r=n(49029),a=n(93157),i=n(79833),o=n(2757);e.exports=function(e,t,n){return e=i(e),void 0===(t=n?void 0:t)?a(e)?o(e):r(e):e.match(t)||[]}}}]);
//# sourceMappingURL=fc2ffd437c11b4eda21bfe1283f4008be822fe42-ddf3c5de5de6a8ed9b07.js.map