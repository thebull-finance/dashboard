{"version":3,"file":"fc2ffd437c11b4eda21bfe1283f4008be822fe42-ddf3c5de5de6a8ed9b07.js","mappings":"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,IAAM,IAAU,IAAK,IAAU,IAAK,IAAU,IACxD,IAAU,IAAM,IAAU,IAAK,IAAU,IAAK,IAAU,IACxD,IAAU,IAAM,IAAU,IAAK,IAAU,IAAK,IAAU,IACxD,IAAU,IAAM,IAAU,IAAK,IAAU,IAAK,IAAU,IAAK,IAAU,IACvE,IAAU,IAAM,IAAU,IAAK,IAAU,IAAK,IAAU,IAAK,IAAU,IACvE,IAAU,IAAM,IAAU,IAAK,IAAU,IAAK,IAAU,IACxD,IAAU,IAAM,IAAU,IAAK,IAAU,IAAK,IAAU,IACxD,IAAU,IAAM,IAAU,IAAK,IAAU,IAAK,IAAU,IACxD,IAAU,IAAM,IAAU,IAAK,IAAU,IAAK,IAAU,IAAK,IAAU,IACvE,IAAU,IAAM,IAAU,IAAK,IAAU,IAAK,IAAU,IAAK,IAAU,IACvE,IAAU,IAAM,IAAU,IAC1B,IAAU,IAAM,IAAU,IAAK,IAAU,IACzC,IAAU,IAAM,IAAU,IAAK,IAAU,IAAK,IAAU,IAAK,IAAU,IACvE,IAAU,IAAM,IAAU,IAAK,IAAU,IAAK,IAAU,IAAK,IAAU,IACvE,IAAU,IAAM,IAAU,IAAK,IAAU,IAAK,IAAU,IACxD,IAAU,IAAM,IAAU,IAAK,IAAU,IAAK,IAAU,IACxD,IAAU,IAAM,IAAU,IAAK,IAAU,IACzC,IAAU,IAAM,IAAU,IAAK,IAAU,IACzC,IAAU,IAAM,IAAU,IAAK,IAAU,IACzC,IAAU,IAAM,IAAU,IAAK,IAAU,IACzC,IAAU,IAAM,IAAU,IAAK,IAAU,IAAK,IAAU,IACxD,IAAU,IAAM,IAAU,IAAK,IAAU,IAAK,IAAU,IACxD,IAAU,IAAM,IAAU,IAAK,IAAU,IACzC,IAAU,IAAM,IAAU,IAAK,IAAU,IACzC,IAAU,IAAM,IAAU,IAAK,IAAU,IAAK,IAAU,IAAK,IAAU,IAAK,IAAU,IACtF,IAAU,IAAM,IAAU,IAAK,IAAU,IAAK,IAAU,IAAK,IAAU,IAAK,IAAU,IACtF,IAAU,IAAM,IAAU,IAC1B,IAAU,IAAM,IAAU,IAAK,IAAU,IACzC,IAAU,IAAM,IAAU,IAAK,IAAU,IACzC,IAAU,IAAM,IAAU,IAAK,IAAU,IACzC,IAAU,KAAM,IAAU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","sources":["webpack://zignaly-webapp/./node_modules/@material-ui/core/esm/Collapse/Collapse.js","webpack://zignaly-webapp/./src/components/CustomFilters/CustomFilters.js","webpack://zignaly-webapp/./src/images/filters/close.svg","webpack://zignaly-webapp/./src/images/filters/chevron-right.svg","webpack://zignaly-webapp/./src/components/Modal/ConnectExchange/ConnectExchange.js","webpack://zignaly-webapp/./src/services/dataFeed/dataFeed.js","webpack://zignaly-webapp/./src/services/dataFeed/vcceDataFeed.js","webpack://zignaly-webapp/./src/services/dataFeed/ascendexDataFeed.js","webpack://zignaly-webapp/./src/tradingView/tradingViewOptions.js","webpack://zignaly-webapp/./src/utils/calculations.js","webpack://zignaly-webapp/./node_modules/@material-ui/icons/esm/AddCircle.js","webpack://zignaly-webapp/./node_modules/@material-ui/icons/esm/RemoveCircle.js","webpack://zignaly-webapp/./src/components/TradingTerminal/HelperLabel/HelperLabel.js","webpack://zignaly-webapp/./src/components/TradingTerminal/ProfitTargetStatus/ProfitTargetStatus.js","webpack://zignaly-webapp/./src/hooks/useExpandable.js","webpack://zignaly-webapp/./src/utils/events.js","webpack://zignaly-webapp/./src/hooks/useTargetGroup.js","webpack://zignaly-webapp/./src/components/TradingTerminal/TradingView/TradingViewContext.js","webpack://zignaly-webapp/./src/hooks/usePositionEntry.js","webpack://zignaly-webapp/./src/hooks/useValidation.js","webpack://zignaly-webapp/./src/hooks/useSymbolLimitsValidate.js","webpack://zignaly-webapp/./src/components/TradingTerminal/Controls/PostOnlyControl/PostOnlyControl.js","webpack://zignaly-webapp/./src/components/TradingTerminal/Controls/PricePercentageControl/PricePercentageControl.js","webpack://zignaly-webapp/./src/components/TradingTerminal/TakeProfitPanel/TakeProfitPanel.js","webpack://zignaly-webapp/./src/components/TradingTerminal/DCATargetStatus/DCATargetStatus.js","webpack://zignaly-webapp/./src/hooks/useDeepCompareEffect.js","webpack://zignaly-webapp/./src/components/TradingTerminal/DCAPanel/DCAPanel.js","webpack://zignaly-webapp/./src/components/TradingTerminal/StopLossStatus/StopLossStatus.js","webpack://zignaly-webapp/./src/hooks/usePositionSizeHandlers.js","webpack://zignaly-webapp/./src/components/TradingTerminal/StopLossPanel/StopLossPanel.js","webpack://zignaly-webapp/./src/components/TradingTerminal/TrailingStopPanel/TrailingStopPanel.js","webpack://zignaly-webapp/./src/hooks/useOwnCopyTraderProviders.js","webpack://zignaly-webapp/./src/components/TradingTerminal/IncreaseStrategyPanel/IncreaseStrategyPanel.js","webpack://zignaly-webapp/./src/components/TradingTerminal/ReduceOrders/ReduceOrders.js","webpack://zignaly-webapp/./src/components/TradingTerminal/ReduceStrategyPanel/ReduceStrategyPanel.js","webpack://zignaly-webapp/./src/components/TradingTerminal/StrategyForm/SidebarEditPanels.js","webpack://zignaly-webapp/./src/components/TradingTerminal/LeverageForm/LeverageForm.js","webpack://zignaly-webapp/./src/components/TradingTerminal/Controls/MarginControl/MarginControl.js","webpack://zignaly-webapp/./src/components/TradingTerminal/StrategyPanel/StrategyPanel.js","webpack://zignaly-webapp/./src/components/TradingTerminal/EntryExpirationPanel/EntryExpirationPanel.js","webpack://zignaly-webapp/./src/components/TradingTerminal/AutoclosePanel/AutoclosePanel.js","webpack://zignaly-webapp/./src/components/TradingTerminal/StrategyForm/SidebarCreatePanels.js","webpack://zignaly-webapp/./src/components/TradingTerminal/StrategyForm/StrategyForm.js","webpack://zignaly-webapp/./src/components/TradingTerminal/TradingView/TradingViewHeader.js","webpack://zignaly-webapp/./src/tradingView/charting_library/charting_library.esm.js","webpack://zignaly-webapp/./src/hooks/useTradingTerminal.js","webpack://zignaly-webapp/./src/hooks/useTradingViewContext.js","webpack://zignaly-webapp/./src/components/TradingTerminal/TradingView/TradingView.js","webpack://zignaly-webapp/./src/components/TradingTerminal/TradingView/TradingViewEdit.js","webpack://zignaly-webapp/./src/hooks/useAvailableBalance.js","webpack://zignaly-webapp/./src/hooks/useFilters.js","webpack://zignaly-webapp/./node_modules/lodash/_arrayReduce.js","webpack://zignaly-webapp/./node_modules/lodash/_asciiWords.js","webpack://zignaly-webapp/./node_modules/lodash/_baseGt.js","webpack://zignaly-webapp/./node_modules/lodash/_baseLt.js","webpack://zignaly-webapp/./node_modules/lodash/_basePick.js","webpack://zignaly-webapp/./node_modules/lodash/_basePropertyOf.js","webpack://zignaly-webapp/./node_modules/lodash/_baseRange.js","webpack://zignaly-webapp/./node_modules/lodash/_baseSome.js","webpack://zignaly-webapp/./node_modules/lodash/_baseSum.js","webpack://zignaly-webapp/./node_modules/lodash/_baseValues.js","webpack://zignaly-webapp/./node_modules/lodash/_castFunction.js","webpack://zignaly-webapp/./node_modules/lodash/_createCompounder.js","webpack://zignaly-webapp/./node_modules/lodash/_createRange.js","webpack://zignaly-webapp/./node_modules/lodash/_createRelationalOperation.js","webpack://zignaly-webapp/./node_modules/lodash/_deburrLetter.js","webpack://zignaly-webapp/./node_modules/lodash/_flatRest.js","webpack://zignaly-webapp/./node_modules/lodash/_hasUnicodeWord.js","webpack://zignaly-webapp/./node_modules/lodash/_unicodeWords.js","webpack://zignaly-webapp/./node_modules/lodash/camelCase.js","webpack://zignaly-webapp/./node_modules/lodash/concat.js","webpack://zignaly-webapp/./node_modules/lodash/deburr.js","webpack://zignaly-webapp/./node_modules/lodash/flatten.js","webpack://zignaly-webapp/./node_modules/lodash/forIn.js","webpack://zignaly-webapp/./node_modules/lodash/gt.js","webpack://zignaly-webapp/./node_modules/lodash/isNumber.js","webpack://zignaly-webapp/./node_modules/lodash/last.js","webpack://zignaly-webapp/./node_modules/lodash/lt.js","webpack://zignaly-webapp/./node_modules/lodash/pick.js","webpack://zignaly-webapp/./node_modules/lodash/range.js","webpack://zignaly-webapp/./node_modules/lodash/some.js","webpack://zignaly-webapp/./node_modules/lodash/sum.js","webpack://zignaly-webapp/./node_modules/lodash/values.js","webpack://zignaly-webapp/./node_modules/lodash/words.js"],"sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport { chainPropTypes } from '@material-ui/utils';\nimport { Transition } from 'react-transition-group';\nimport withStyles from '../styles/withStyles';\nimport { duration } from '../styles/transitions';\nimport deprecatedPropType from '../utils/deprecatedPropType';\nimport { getTransitionProps } from '../transitions/utils';\nimport useTheme from '../styles/useTheme';\nimport { useForkRef } from '../utils';\nexport var styles = function styles(theme) {\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      height: 0,\n      overflow: 'hidden',\n      transition: theme.transitions.create('height')\n    },\n\n    /* Styles applied to the root element when the transition has entered. */\n    entered: {\n      height: 'auto',\n      overflow: 'visible'\n    },\n\n    /* Styles applied to the root element when the transition has exited and `collapsedSize` != 0px. */\n    hidden: {\n      visibility: 'hidden'\n    },\n\n    /* Styles applied to the outer wrapper element. */\n    wrapper: {\n      // Hack to get children with a negative margin to not falsify the height computation.\n      display: 'flex'\n    },\n\n    /* Styles applied to the inner wrapper element. */\n    wrapperInner: {\n      width: '100%'\n    }\n  };\n};\n/**\n * The Collapse transition is used by the\n * [Vertical Stepper](/components/steppers/#vertical-stepper) StepContent component.\n * It uses [react-transition-group](https://github.com/reactjs/react-transition-group) internally.\n */\n\nvar Collapse = /*#__PURE__*/React.forwardRef(function Collapse(props, ref) {\n  var children = props.children,\n      classes = props.classes,\n      className = props.className,\n      collapsedHeight = props.collapsedHeight,\n      _props$collapsedSize = props.collapsedSize,\n      collapsedSizeProp = _props$collapsedSize === void 0 ? '0px' : _props$collapsedSize,\n      _props$component = props.component,\n      Component = _props$component === void 0 ? 'div' : _props$component,\n      _props$disableStrictM = props.disableStrictModeCompat,\n      disableStrictModeCompat = _props$disableStrictM === void 0 ? false : _props$disableStrictM,\n      inProp = props.in,\n      onEnter = props.onEnter,\n      onEntered = props.onEntered,\n      onEntering = props.onEntering,\n      onExit = props.onExit,\n      onExited = props.onExited,\n      onExiting = props.onExiting,\n      style = props.style,\n      _props$timeout = props.timeout,\n      timeout = _props$timeout === void 0 ? duration.standard : _props$timeout,\n      _props$TransitionComp = props.TransitionComponent,\n      TransitionComponent = _props$TransitionComp === void 0 ? Transition : _props$TransitionComp,\n      other = _objectWithoutProperties(props, [\"children\", \"classes\", \"className\", \"collapsedHeight\", \"collapsedSize\", \"component\", \"disableStrictModeCompat\", \"in\", \"onEnter\", \"onEntered\", \"onEntering\", \"onExit\", \"onExited\", \"onExiting\", \"style\", \"timeout\", \"TransitionComponent\"]);\n\n  var theme = useTheme();\n  var timer = React.useRef();\n  var wrapperRef = React.useRef(null);\n  var autoTransitionDuration = React.useRef();\n  var collapsedSize = typeof (collapsedHeight || collapsedSizeProp) === 'number' ? \"\".concat(collapsedHeight || collapsedSizeProp, \"px\") : collapsedHeight || collapsedSizeProp;\n  React.useEffect(function () {\n    return function () {\n      clearTimeout(timer.current);\n    };\n  }, []);\n  var enableStrictModeCompat = theme.unstable_strictMode && !disableStrictModeCompat;\n  var nodeRef = React.useRef(null);\n  var handleRef = useForkRef(ref, enableStrictModeCompat ? nodeRef : undefined);\n\n  var normalizedTransitionCallback = function normalizedTransitionCallback(callback) {\n    return function (nodeOrAppearing, maybeAppearing) {\n      if (callback) {\n        var _ref = enableStrictModeCompat ? [nodeRef.current, nodeOrAppearing] : [nodeOrAppearing, maybeAppearing],\n            _ref2 = _slicedToArray(_ref, 2),\n            node = _ref2[0],\n            isAppearing = _ref2[1]; // onEnterXxx and onExitXxx callbacks have a different arguments.length value.\n\n\n        if (isAppearing === undefined) {\n          callback(node);\n        } else {\n          callback(node, isAppearing);\n        }\n      }\n    };\n  };\n\n  var handleEnter = normalizedTransitionCallback(function (node, isAppearing) {\n    node.style.height = collapsedSize;\n\n    if (onEnter) {\n      onEnter(node, isAppearing);\n    }\n  });\n  var handleEntering = normalizedTransitionCallback(function (node, isAppearing) {\n    var wrapperHeight = wrapperRef.current ? wrapperRef.current.clientHeight : 0;\n\n    var _getTransitionProps = getTransitionProps({\n      style: style,\n      timeout: timeout\n    }, {\n      mode: 'enter'\n    }),\n        transitionDuration = _getTransitionProps.duration;\n\n    if (timeout === 'auto') {\n      var duration2 = theme.transitions.getAutoHeightDuration(wrapperHeight);\n      node.style.transitionDuration = \"\".concat(duration2, \"ms\");\n      autoTransitionDuration.current = duration2;\n    } else {\n      node.style.transitionDuration = typeof transitionDuration === 'string' ? transitionDuration : \"\".concat(transitionDuration, \"ms\");\n    }\n\n    node.style.height = \"\".concat(wrapperHeight, \"px\");\n\n    if (onEntering) {\n      onEntering(node, isAppearing);\n    }\n  });\n  var handleEntered = normalizedTransitionCallback(function (node, isAppearing) {\n    node.style.height = 'auto';\n\n    if (onEntered) {\n      onEntered(node, isAppearing);\n    }\n  });\n  var handleExit = normalizedTransitionCallback(function (node) {\n    var wrapperHeight = wrapperRef.current ? wrapperRef.current.clientHeight : 0;\n    node.style.height = \"\".concat(wrapperHeight, \"px\");\n\n    if (onExit) {\n      onExit(node);\n    }\n  });\n  var handleExited = normalizedTransitionCallback(onExited);\n  var handleExiting = normalizedTransitionCallback(function (node) {\n    var wrapperHeight = wrapperRef.current ? wrapperRef.current.clientHeight : 0;\n\n    var _getTransitionProps2 = getTransitionProps({\n      style: style,\n      timeout: timeout\n    }, {\n      mode: 'exit'\n    }),\n        transitionDuration = _getTransitionProps2.duration;\n\n    if (timeout === 'auto') {\n      var duration2 = theme.transitions.getAutoHeightDuration(wrapperHeight);\n      node.style.transitionDuration = \"\".concat(duration2, \"ms\");\n      autoTransitionDuration.current = duration2;\n    } else {\n      node.style.transitionDuration = typeof transitionDuration === 'string' ? transitionDuration : \"\".concat(transitionDuration, \"ms\");\n    }\n\n    node.style.height = collapsedSize;\n\n    if (onExiting) {\n      onExiting(node);\n    }\n  });\n\n  var addEndListener = function addEndListener(nodeOrNext, maybeNext) {\n    var next = enableStrictModeCompat ? nodeOrNext : maybeNext;\n\n    if (timeout === 'auto') {\n      timer.current = setTimeout(next, autoTransitionDuration.current || 0);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(TransitionComponent, _extends({\n    in: inProp,\n    onEnter: handleEnter,\n    onEntered: handleEntered,\n    onEntering: handleEntering,\n    onExit: handleExit,\n    onExited: handleExited,\n    onExiting: handleExiting,\n    addEndListener: addEndListener,\n    nodeRef: enableStrictModeCompat ? nodeRef : undefined,\n    timeout: timeout === 'auto' ? null : timeout\n  }, other), function (state, childProps) {\n    return /*#__PURE__*/React.createElement(Component, _extends({\n      className: clsx(classes.root, classes.container, className, {\n        'entered': classes.entered,\n        'exited': !inProp && collapsedSize === '0px' && classes.hidden\n      }[state]),\n      style: _extends({\n        minHeight: collapsedSize\n      }, style),\n      ref: handleRef\n    }, childProps), /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.wrapper,\n      ref: wrapperRef\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.wrapperInner\n    }, children)));\n  });\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nCollapse.muiSupportAuto = true;\nexport default withStyles(styles, {\n  name: 'MuiCollapse'\n})(Collapse);","import React from \"react\";\nimport \"./CustomFilters.scss\";\nimport { Box, Collapse } from \"@material-ui/core\";\nimport { FormattedMessage } from \"react-intl\";\nimport CustomButtom from \"../CustomButton\";\nimport ConditionalWrapper from \"../ConditionalWrapper\";\nimport ChevronRightIcon from \"../../images/filters/chevron-right.svg\";\nimport CloseIcon from \"../../images/filters/close.svg\";\n\n/**\n * @typedef {Object} CustomFiltersPropTypes\n * @property {function} [onClose] Callback that delegate filters toggle state to caller.\n * @property {function} [onClear] Callback that delegate filters clearing to caller.\n * @property {string} title Filters' title.\n * @property {boolean} [open] Flag to trigger open filter bar transition.\n * @property {*} children Dropdowns to display.\n */\n\n/**\n * Provides a wrapper to display filters bar with clear/hide buttons.\n *\n * @param {CustomFiltersPropTypes} props Component properties.\n * @returns {JSX.Element} Component JSX.\n */\nconst CustomFilters = (props) => {\n  const { onClose, onClear, title, open, children } = props;\n\n  return (\n    <ConditionalWrapper\n      condition={open !== undefined}\n      wrapper={(_children) => (\n        <Collapse in={open} unmountOnExit={true}>\n          {_children}\n        </Collapse>\n      )}\n    >\n      <Box\n        alignItems=\"center\"\n        className=\"customFilters\"\n        display=\"flex\"\n        flexDirection=\"row\"\n        justifyContent=\"space-between\"\n      >\n        <Box\n          alignItems=\"center\"\n          className=\"filters\"\n          display=\"flex\"\n          flexDirection=\"row\"\n          justifyContent=\"flex-start\"\n        >\n          {title && <span className=\"title\">{title}</span>}\n          {children}\n        </Box>\n        <Box\n          alignItems=\"center\"\n          className=\"actions\"\n          display=\"flex\"\n          flexDirection=\"row\"\n          justifyContent=\"space-between\"\n        >\n          {onClear && (\n            <CustomButtom\n              className=\"textPurple\"\n              onClick={() => onClear()}\n              startIcon={<img className=\"icon iconPurple\" src={CloseIcon} />}\n            >\n              <FormattedMessage id=\"fil.clearall\" />\n            </CustomButtom>\n          )}\n          {onClose && (\n            <CustomButtom\n              className=\"textPurple\"\n              onClick={() => onClose()}\n              startIcon={<img className=\"icon iconPurple\" src={ChevronRightIcon} />}\n            >\n              <FormattedMessage id=\"fil.hide\" />\n            </CustomButtom>\n          )}\n        </Box>\n      </Box>\n    </ConditionalWrapper>\n  );\n};\n\nexport default CustomFilters;\n","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNSIgdmlld0JveD0iMCAwIDI0IDI1Ij4KICAgIDxwYXRoIGZpbGw9IiM3NzBGQzgiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTE3LjMxOCAxNi45NThsLTQuMjA5LTQuMjA4IDQuMjA4LTQuMjA3Yy4yNDQtLjI0NC4yNDQtLjYzOSAwLS44ODNsLS45NzctLjk3N2MtLjI0NC0uMjQ0LS42MzktLjI0NC0uODgzIDBMMTEuMjUgMTAuODkgNy4wNDIgNi42ODNjLS4yNDMtLjI0My0uNjM4LS4yNDMtLjg4MiAwbC0uOTc3Ljk3OGMtLjI0NC4yNDMtLjI0NC42MzggMCAuODgyTDkuMzkgMTIuNzVsLTQuMjA4IDQuMjA4Yy0uMjQzLjI0My0uMjQzLjYzOCAwIC44ODJsLjk3Ny45NzdjLjI0NC4yNDQuNjM5LjI0NC44ODIgMGw0LjIwOC00LjIwNyA0LjIwOCA0LjIwN2MuMjQzLjI0NC42MzguMjQ0Ljg4MiAwbC45NzgtLjk3N2MuMjQzLS4yNDQuMjQzLS42MzkgMC0uODgyeiIvPgo8L3N2Zz4K\"","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNSIgaGVpZ2h0PSIyNSIgdmlld0JveD0iMCAwIDI1IDI1Ij4KICAgIDxwYXRoIGZpbGw9IiM3NzBGQzgiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTE4LjYwNCAxNC45NTZMMTIuNTMgOC44ODNjLS4yOTMtLjI5My0uNzY3LS4yOTMtMS4wNiAwbC02LjA3NCA2LjA3M2MtLjI5Mi4yOTMtLjI5Mi43NjggMCAxLjA2bC43MDkuNzFjLjI5Mi4yOTIuNzY2LjI5MiAxLjA2IDBMMTIgMTEuOTEzbDQuODM2IDQuODEzYy4yOTMuMjkyLjc2Ny4yOTIgMS4wNiAwbC43MDgtLjcxYy4yOTItLjI5Mi4yOTItLjc2NyAwLTEuMDZ6Ii8+Cjwvc3ZnPgo=\"","import React from \"react\";\nimport { Box, Typography } from \"@material-ui/core\";\nimport CustomButton from \"../../CustomButton\";\nimport { FormattedMessage } from \"react-intl\";\nimport \"./ConnectExchange.scss\";\nimport { navigate as navigateReach } from \"@reach/router\";\nimport useExchangeList from \"../../../hooks/useExchangeList\";\nimport { getExchangeNamesCombined } from \"../../../utils/helpers\";\n\n/**\n * @typedef {Object} ConnectExchangePropTypes\n * @property {function} [onClose] Close function.\n */\n\n/**\n * Ask to connect an exchange account.\n *\n * @param {ConnectExchangePropTypes} props Component properties.\n * @returns {JSX.Element} Component JSX.\n */\nconst ConnectExchange = ({ onClose }) => {\n  const { exchanges } = useExchangeList();\n  const navigate = () => {\n    if (onClose) onClose();\n    navigateReach(\"#exchangeAccounts\");\n  };\n\n  return (\n    <Box alignItems=\"center\" className=\"connectExchangeModal\" display=\"flex\" flexDirection=\"column\">\n      <Typography variant=\"h3\">\n        <FormattedMessage id=\"accounts.connect\" />\n      </Typography>\n      <Typography variant=\"body1\">\n        <FormattedMessage\n          id=\"accounts.connect.first\"\n          values={{ exchanges: getExchangeNamesCombined(exchanges, \"or\") }}\n        />\n      </Typography>\n      <Box className=\"real\" display=\"flex\" flexDirection=\"column\">\n        <Typography variant=\"h4\">\n          <FormattedMessage id=\"accounts.create.or\" />\n        </Typography>\n        <CustomButton className=\"body2 bgPurple exchangeButton\" onClick={navigate}>\n          <FormattedMessage id=\"accounts.connect.go\" />\n        </CustomButton>\n      </Box>\n      {/* <Box className=\"demo\" display=\"flex\" flexDirection=\"column\">\n        <Typography variant=\"h4\">\n          <FormattedMessage id=\"accounts.connect.experiment\" />\n        </Typography>\n        <CustomButton className=\"body2 textPurple exchangeButton\" onClick={navigate}>\n          <FormattedMessage id=\"accounts.create.demo\" />\n        </CustomButton>\n      </Box> */}\n    </Box>\n  );\n};\nexport default ConnectExchange;\n","/**\n * Tutorial: https://github.com/tradingview/charting-library-tutorial/blob/master/documentation/integration.md\n * Full implementation: https://github.com/tradingview/charting_library/wiki/JS-Api#how-to-start\n * Tutorial implementation: https://github.com/tradingview/charting-library-tutorial/blob/master/documentation/datafeed-implementation.md\n * Stream implementation: https://github.com/tradingview/charting-library-tutorial/blob/master/documentation/streaming-implementation.md\n * TradingView JS API Binance Example: https://github.com/marcius-studio/tradingview-jsapi-binance/blob/master/client/src/components/api/index.js\n */\n\n/* eslint-disable camelcase */\nimport { isEmpty, last } from \"lodash\";\n\n/**\n *\n * @typedef {import(\"services/tradeApiClient.types\").MarketSymbol} MarketSymbol\n * @typedef {import(\"services/tradeApiClient.types\").ExchangeConnectionEntity} ExchangeConnectionEntity\n * @typedef {import(\"services/tradeApiClient.types\").MarketSymbolsCollection} MarketSymbolsCollection\n * @typedef {import(\"tradingView/charting_library/charting_library\").OnReadyCallback} OnReadyCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").ServerTimeCallback} ServerTimeCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").SearchSymbolsCallback} SearchSymbolsCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").ResolveCallback} ResolveCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").ErrorCallback} ErrorCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").HistoryCallback} HistoryCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").Bar} Bar\n * @typedef {import(\"tradingView/charting_library/charting_library\").SubscribeBarsCallback} SubscribeBarsCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").LibrarySymbolInfo} LibrarySymbolInfo\n * @typedef {import(\"tradingView/charting_library/charting_library\").PeriodParams} PeriodParams\n */\n\n/**\n * @typedef {Array<Bar>} Candle\n */\n\n/**\n * @typedef {Object} DataFeedOptions\n * @property {ExchangeConnectionEntity} exchange\n * @property {MarketSymbolsCollection} symbolsData Exchange market symbols data.\n */\n\n/**\n * Prices data feed from CoinRay provider.\n *\n * @abstract\n * @property {TradeApiClient} tradeApi API client.\n * @returns {IBasicDataFeed} Trading View Chart data feed.\n */\nclass DataFeed {\n  /**\n   * Creates an instance of DataFeed.\n   * @param {DataFeedOptions} options Construct options.\n   * @memberof DataFeed\n   */\n  constructor(options) {\n    this.symbolsData = options.symbolsData || null;\n    this.exchange = options.exchange.exchangeName || \"\";\n    this.baseUrl = process.env.GATSBY_TRADEAPI_URL.replace(\"/api\", \"\");\n\n    /**\n     * @type Candle\n     */\n    this.allCandles = [];\n  }\n\n  /**\n   * On ready callback.\n   *\n   * @param {OnReadyCallback} callback On ready callback.\n   * @returns {Void} None.\n   * @memberof DataFeed\n   */\n  onReady(callback) {\n    const resolutions = [\"1\", \"5\", \"15\", \"30\", \"60\", \"120\", \"240\", \"360\", \"720\", \"D\", \"W\"];\n\n    setTimeout(() => {\n      // Notify to Trading View which options are supported.\n      callback({\n        supports_marks: false,\n        supports_timescale_marks: false,\n        // Countdown in the price scale, require current server time endpoint\n        supports_time: false,\n        // @ts-ignore\n        supported_resolutions: resolutions,\n      });\n    }, 0);\n  }\n\n  // /**\n  //  * Get server time used to align timeserie in time axes.\n  //  *\n  //  * @param {ServerTimeCallback} callback Server time callback.\n  //  * @returns {Void} None.\n  //  * @memberof DataFeed\n  //  */\n  // getServerTime(callback) {\n  //   tradeApi\n  //     .serverTimeGet({\n  //       token: this.tradeApiToken,\n  //     })\n  //     .then((data) => {\n  //       callback(Math.floor(data.serverTime / 1000));\n  //     })\n  //     .catch(() => {\n  //       callback(Math.floor(+new Date() / 1000));\n  //     });\n  // }\n\n  // /**\n  //  * Search market symbol data by widget search input value.\n  //  *\n  //  * @param {String} userInput Input value typed by user.\n  //  * @param {String} exchange Exchange name.\n  //  * @param {String} symbolType Symbol type.\n  //  * @param {SearchSymbolsCallback} onResultReadyCallback Callback to resolve symbol match.\n  //  * @returns {Void} None.\n  //  * @memberof DataFeed\n  //  */\n  // eslint-disable-next-line max-params\n  // searchSymbols(userInput, exchange, symbolType, onResultReadyCallback) {\n  //   userInput = userInput.toUpperCase();\n  //   const symbolFound = this.symbolsData\n  //     .filter((symbolData) => symbolData.symbol === userInput.toUpperCase())\n  //     .map((symbol) => {\n  //       const symbolBaseQuote = symbol.base + symbol.quote;\n\n  //       // Exchange and type are not enabled.\n  //       return {\n  //         exchange: \"\",\n  //         type: \"\",\n  //         symbol: symbolBaseQuote,\n  //         full_name: symbolBaseQuote,\n  //         description: symbol.base + \" / \" + symbol.quote,\n  //         ticker: symbolBaseQuote,\n  //       };\n  //     });\n\n  //   onResultReadyCallback(symbolFound);\n  // }\n\n  /**\n   * Resolve symbol data with structure required by Trading View chart.\n   *\n   * @param {string} symbol Symbol code.\n   * @param {ResolveCallback} onSymbolResolvedCallback Notify symbol resolved.\n   * @param {ErrorCallback} onResolveErrorCallback Notify symbol resolve error.\n   * @returns {Void} None.\n   * @memberof DataFeed\n   */\n  resolveSymbol(symbol, onSymbolResolvedCallback, onResolveErrorCallback) {\n    for (let symbolData of this.symbolsData) {\n      const symbolBaseQuote = symbolData.base + symbolData.quote;\n      const pricescale = Math.round(1 / symbolData.limits.price.min);\n\n      if (symbolData.tradeViewSymbol.toLowerCase() === symbol.toLowerCase()) {\n        /**\n         * @type LibrarySymbolInfo\n         */\n        const symbolFound = {\n          base_name: [symbolData.base],\n          // @ts-ignore\n          base: symbolData.unitsAmount,\n          // @ts-ignore\n          quote: symbolData.unitsInvestment,\n          description: symbolData.symbol,\n          exchange: this.exchange,\n          full_name: symbolData.symbol,\n          has_daily: true,\n          has_intraday: true,\n          has_weekly_and_monthly: true,\n          listed_exchange: this.exchange,\n          minmov: 1,\n          name: symbolData.symbol,\n          pricescale: pricescale,\n          session: \"24x7\",\n          data_status: \"streaming\",\n          ticker: symbolBaseQuote,\n          // timezone: \"Etc/UTC\",\n          type: \"spot\",\n        };\n\n        setTimeout(() => {\n          onSymbolResolvedCallback(symbolFound);\n        }, 0);\n        return;\n      }\n    }\n\n    setTimeout(() => {\n      onResolveErrorCallback(\"not found\");\n    });\n  }\n\n  /**\n   * Get price bar for a given symbol.\n   *\n   * @param {MarketSymbol} symbolData Market symbol data.\n   * @param {string} resolution Data resolution.\n   * @param {PeriodParams} periodParams Selected period.\n   * @returns {Promise<Candle>} None.\n   * @abstract\n   */\n  // eslint-disable-next-line no-unused-vars\n  getBarsRequest(symbolData, resolution, periodParams) {\n    throw new Error(\"must be implemented by subclass!\");\n  }\n\n  /**\n   * Get price bar for a given symbol.\n   *\n   * @param {MarketSymbol} symbolData Market symbol data.\n   * @param {string} resolution Data resolution.\n   * @param {PeriodParams} periodParams Selected period.\n   * @param {HistoryCallback} onHistoryCallback Notify data.\n   * @param {ErrorCallback} onErrorCallback Notify error.\n   * @returns {Void} None.\n   * @memberof DataFeed\n   */\n  // eslint-disable-next-line max-params\n  getBars(symbolData, resolution, periodParams, onHistoryCallback, onErrorCallback) {\n    const { from: startDate, firstDataRequest } = periodParams;\n    if (firstDataRequest) {\n      this.allCandles = [];\n    }\n\n    /**\n     * Notify symbol prices in Trading View bars format so chart widget.\n     *\n     * @param {Bar[]} formattedCandles Candles in TV bar object format.\n     * @returns {Void} None.\n     */\n    const notifyPricesData = (formattedCandles) => {\n      if (formattedCandles.length === 0) {\n        onHistoryCallback([], { noData: true });\n      } else {\n        onHistoryCallback(formattedCandles, {\n          noData: false,\n        });\n      }\n    };\n\n    if (firstDataRequest) {\n      // Store date, this will be used for the interval requests to get live candle.\n      // We need it for performance reasons because the reply will be cached.\n      this.startDate = startDate;\n    }\n\n    this.getBarsRequest(symbolData, resolution, periodParams)\n      .then((formattedCandles) => {\n        // Accumulate candles.\n        this.allCandles = this.allCandles.concat(formattedCandles);\n        notifyPricesData(formattedCandles);\n      })\n      .catch((e) => {\n        onErrorCallback(`ERROR: ${e.message}`);\n      });\n  }\n\n  /**\n   * Interval requests to get live data\n   *\n   * @param {LibrarySymbolInfo} symbolData Market symbol data.\n   * @param {string} resolution Prices data resolution.\n   * @param {SubscribeBarsCallback} onRealtimeCallback Notify tick to chart.\n   * @returns {Void} Promise.\n   *\n   * @memberof DataFeed\n   */\n  // eslint-disable-next-line max-params\n  subscribeBars(symbolData, resolution, onRealtimeCallback) {\n    this.candleSubscription = setInterval(() => {\n      this.refreshBarRequest(symbolData, resolution)\n        .then((candle) => {\n          if (candle) {\n            onRealtimeCallback(candle);\n          }\n        })\n        .catch((e) => {\n          // eslint-disable-next-line no-console\n          console.error(`ERROR: ${e.message}`);\n        });\n    }, 15000);\n  }\n\n  /**\n   * Call request to get latest candle price data.\n   *\n   * @param {LibrarySymbolInfo} symbolData Market symbol data.\n   * @param {string} resolution Prices data resolution.\n   * @returns {Promise<Bar>} Promise.\n   * @abstract\n   */\n  // eslint-disable-next-line no-unused-vars\n  refreshBarRequest(symbolData, resolution) {\n    throw new Error(\"must be implemented by subclass!\");\n  }\n\n  /**\n   * Unsubscribe from interval request\n   *\n   * @returns {Void} None.\n   * @memberof DataFeed\n   */\n  unsubscribeBars() {\n    clearInterval(this.candleSubscription);\n  }\n\n  /**\n   * Get last price.\n   *\n   * @returns {number} Price.\n   * @memberof DataFeed\n   */\n  getLastPrice() {\n    if (isEmpty(this.allCandles)) {\n      return null;\n    }\n\n    // @ts-ignore\n    return last(this.allCandles).close;\n  }\n}\n\nexport default DataFeed;\n","import dayjs from \"dayjs\";\nimport { resolutionToMilliseconds } from \"utils/timeConvert\";\nimport DataFeed from \"./dataFeed\";\n\n/**\n * @typedef {Array<*>} Candle\n */\n\n/**\n * @typedef {import(\"services/tradeApiClient.types\").MarketSymbol} MarketSymbol\n * @typedef {import(\"services/tradeApiClient.types\").ExchangeConnectionEntity} ExchangeConnectionEntity\n * @typedef {import(\"services/tradeApiClient.types\").MarketSymbolsCollection} MarketSymbolsCollection\n * @typedef {import(\"tradingView/charting_library/charting_library\").OnReadyCallback} OnReadyCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").ServerTimeCallback} ServerTimeCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").SearchSymbolsCallback} SearchSymbolsCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").ResolveCallback} ResolveCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").ErrorCallback} ErrorCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").HistoryCallback} HistoryCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").Bar} Bar\n * @typedef {import(\"tradingView/charting_library/charting_library\").SubscribeBarsCallback} SubscribeBarsCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").LibrarySymbolInfo} LibrarySymbolInfo\n * @typedef {import(\"tradingView/charting_library/charting_library\").PeriodParams} PeriodParams\n */\n\n/**\n * Prices data feed from CoinRay provider.\n *\n * @property {TradeApiClient} tradeApi API client.\n * @returns {IBasicDataFeed} Trading View Chart data feed.\n */\nclass VcceDataFeed extends DataFeed {\n  /**\n   * Get price candles for selected symbol.\n   *\n   * @param {string} base Symbol base currency.\n   * @param {string} quote Symbol quote currency.\n   * @param {string|number} resolution Data resolution.\n   * @param {number} startTime Get data since.\n   * @param {number} [endTime] Get data to.\n   * @returns {Promise<Candle>} Promise that resolve candle data.\n   * @memberof VcceDataFeed\n   */\n  // eslint-disable-next-line max-params\n  async getCandlesData(base, quote, resolution, startTime, endTime) {\n    let endpointPath = `/tradingview?lang=en&coin=${base}&currency=${quote}&resolution=${resolution}&from=${startTime}`;\n    if (endTime) {\n      endpointPath += `&to=${endTime}`;\n    }\n    const requestUrl = this.baseUrl + endpointPath;\n\n    try {\n      const response = await fetch(requestUrl);\n      const candles = await response.json();\n\n      return candles;\n      // return JSON.parse(candles.contents);\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(`Get candles data error: ${error.message}`);\n    }\n\n    return [];\n  }\n\n  /**\n   * Parse api candle bars\n   * @param {*} candle VCCE Candle\n   * @returns {*} New candle\n   */\n  parseOHLCV(candle) {\n    return {\n      time: parseFloat(candle.time),\n      open: parseFloat(candle.open),\n      high: parseFloat(candle.high),\n      low: parseFloat(candle.low),\n      close: parseFloat(candle.close),\n      volume: parseFloat(candle.volume),\n    };\n  }\n\n  /**\n   * Get price bar for a given symbol.\n   *\n   * @param {MarketSymbol} symbolData Market symbol data.\n   * @param {string} resolution Data resolution.\n   * @param {PeriodParams} periodParams Selected period.\n   * @returns {Promise<Candle>} Promise.\n   */\n  getBarsRequest(symbolData, resolution, periodParams) {\n    const { from: startDate, to: endDate } = periodParams;\n\n    return this.getCandlesData(\n      // @ts-ignore\n      symbolData.base.toLowerCase(),\n      // @ts-ignore\n      symbolData.quote.toLowerCase(),\n      resolutionToMilliseconds(resolution),\n      startDate,\n      dayjs.unix(endDate).startOf(\"minute\").unix(),\n    ).then((newCandles) => {\n      return newCandles.map(this.parseOHLCV);\n    });\n  }\n\n  /**\n   * Call request to get latest candle price data.\n   *\n   * @param {LibrarySymbolInfo} symbolData Market symbol data.\n   * @param {string} resolution Prices data resolution.\n   * @returns {Promise<Bar>} Promise.\n   */\n  refreshBarRequest(symbolData, resolution) {\n    return this.getCandlesData(\n      // @ts-ignore\n      symbolData.base.toLowerCase(),\n      // @ts-ignore\n      symbolData.quote.toLowerCase(),\n      resolutionToMilliseconds(resolution),\n      this.startDate,\n      dayjs().startOf(\"minute\").unix(),\n    ).then((candles) => {\n      if (candles.length) {\n        const lastCandle = candles[candles.length - 1];\n        return this.parseOHLCV(lastCandle);\n      }\n      return {};\n    });\n  }\n}\n\nexport default VcceDataFeed;\n","import dayjs from \"dayjs\";\nimport DataFeed from \"./dataFeed\";\n\n/**\n * @typedef {Object} CandleData\n * @property {Number} code\n * @property {Array<*>} data\n */\n\n/**\n * @typedef {import(\"./dataFeed\").Candle} Candle\n * @typedef {import(\"services/tradeApiClient.types\").MarketSymbol} MarketSymbol\n * @typedef {import(\"services/tradeApiClient.types\").ExchangeConnectionEntity} ExchangeConnectionEntity\n * @typedef {import(\"services/tradeApiClient.types\").MarketSymbolsCollection} MarketSymbolsCollection\n * @typedef {import(\"tradingView/charting_library/charting_library\").OnReadyCallback} OnReadyCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").ServerTimeCallback} ServerTimeCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").SearchSymbolsCallback} SearchSymbolsCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").ResolveCallback} ResolveCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").ErrorCallback} ErrorCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").HistoryCallback} HistoryCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").Bar} Bar\n * @typedef {import(\"tradingView/charting_library/charting_library\").SubscribeBarsCallback} SubscribeBarsCallback\n * @typedef {import(\"tradingView/charting_library/charting_library\").LibrarySymbolInfo} LibrarySymbolInfo\n * @typedef {import(\"tradingView/charting_library/charting_library\").PeriodParams} PeriodParams\n */\n\n/**\n * Prices data feed from CoinRay provider.\n *\n * @property {TradeApiClient} tradeApi API client.\n * @returns {IBasicDataFeed} Trading View Chart data feed.\n * @inheritdoc\n */\nclass AscendexDataFeed extends DataFeed {\n  /**\n   * Get price candles for selected symbol.\n   *\n   * @param {string} base Symbol base currency.\n   * @param {string} quote Symbol quote currency.\n   * @param {string|number} resolution Data resolution.\n   * @param {number} startTime Get data since.\n   * @param {number} [endTime] Get data to.\n   * @returns {Promise<CandleData>} Promise that resolve candle data.\n   * @memberof AscendexDataFeed\n   */\n  // eslint-disable-next-line max-params\n  async getCandlesData(base, quote, resolution, startTime, endTime) {\n    let endpointPath = `/tradingview/ascendex?symbol=${base}/${quote}&interval=${resolution}&from=${startTime}`;\n    if (endTime) {\n      endpointPath += `&to=${endTime}`;\n    }\n    const requestUrl = this.baseUrl + endpointPath;\n\n    try {\n      const response = await fetch(requestUrl);\n      const candles = await response.json();\n\n      return candles;\n      // return JSON.parse(candles.contents);\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(`Get candles data error: ${error.message}`);\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse api candle bars\n   * @param {*} candle VCCE Candle\n   * @returns {*} New candle\n   */\n  parseOHLCV(candle) {\n    return {\n      time: parseFloat(candle.ts),\n      open: parseFloat(candle.o),\n      high: parseFloat(candle.h),\n      low: parseFloat(candle.l),\n      close: parseFloat(candle.c),\n      volume: parseFloat(candle.v),\n    };\n  }\n\n  /**\n   * Get price bar for a given symbol.\n   *\n   * @param {MarketSymbol} symbolData Market symbol data.\n   * @param {string} resolution Data resolution.\n   * @param {PeriodParams} periodParams Selected period.\n   * @returns {Promise<Candle>} Promise.\n   */\n  getBarsRequest(symbolData, resolution, periodParams) {\n    const { from: startDate, to: endDate } = periodParams;\n\n    return this.getCandlesData(\n      // @ts-ignore\n      symbolData.base.toUpperCase(),\n      // @ts-ignore\n      symbolData.quote.toUpperCase(),\n      resolution,\n      startDate * 1000,\n      dayjs.unix(endDate).startOf(\"minute\").valueOf(),\n    ).then((newCandles) => {\n      return newCandles ? newCandles.data.map((d) => this.parseOHLCV(d.data)) : [];\n    });\n  }\n\n  /**\n   * Call request to get latest candle price data.\n   *\n   * @param {LibrarySymbolInfo} symbolData Market symbol data.\n   * @param {string} resolution Prices data resolution.\n   * @returns {Promise<Bar>} Promise.\n   * @abstract\n   */\n  refreshBarRequest(symbolData, resolution) {\n    return this.getCandlesData(\n      // @ts-ignore\n      symbolData.base.toUpperCase(),\n      // @ts-ignore\n      symbolData.quote.toUpperCase(),\n      resolution,\n      this.startDate * 1000,\n      dayjs().startOf(\"minute\").valueOf(),\n    ).then((candles) => {\n      if (candles && candles.data.length) {\n        const lastCandle = candles.data[candles.data.length - 1];\n        return this.parseOHLCV(lastCandle.data);\n      }\n      return {};\n    });\n  }\n}\n\nexport default AscendexDataFeed;\n","/* eslint-disable camelcase */\n\nimport VcceDataFeed from \"services/dataFeed/vcceDataFeed\";\nimport AscendexDataFeed from \"services/dataFeed/ascendexDataFeed\";\n\n/**\n * @typedef {import(\"../services/tradeApiClient.types\").ExchangeConnectionEntity} ExchangeConnectionEntity\n * @typedef {import(\"tradingView/charting_library/charting_library\").ChartingLibraryWidgetOptions} ChartingLibraryWidgetOptions\n * @typedef {import(\"tradingView/charting_library/charting_library\").IBasicDataFeed} IBasicDataFeed\n * @typedef {import(\"services//tradeApiClient.types\").MarketSymbolsCollection} MarketSymbolsCollection\n * @typedef {import(\"services/dataFeed/dataFeed\").DataFeedOptions} DataFeedOptions\n */\n\n/**\n * @typedef {ChartingLibraryWidgetOptions['datafeed']} DataFeed\n */\n\n/**\n * @typedef {Object} WidgetOptions\n * @property {MarketSymbolsCollection} symbolsData Exchange market symbols data.\n * @property {string} symbol Crypto currency symbol.\n * @property {boolean} darkStyle Dark style flag.\n * @property {ExchangeConnectionEntity} exchange Exchange connection entity.\n */\n\n/**\n * Map exchange connection to CoinRay exchange ID.\n *\n * @export\n * @param {ExchangeConnectionEntity} exchangeConnection Exchange connection entity.\n * @returns {string} Coinray exchange ID.\n */\nexport function mapExchangeConnectionToCoinRayId(exchangeConnection) {\n  // When not valid exchange object fallback to Binance.\n  if (!exchangeConnection || !exchangeConnection.exchangeName) {\n    return \"BINA\";\n  }\n\n  // When not defined default to spot.\n  if (!exchangeConnection.exchangeType) {\n    exchangeConnection.exchangeType = \"spot\";\n  }\n\n  const exchangeName = exchangeConnection.exchangeName.toUpperCase();\n  const exchangeType = exchangeConnection.exchangeType.toUpperCase();\n\n  if (exchangeName === \"BINANCE\") {\n    if (exchangeType === \"FUTURES\") {\n      return \"BIFU\";\n    }\n\n    return \"BINA\";\n  }\n\n  if (exchangeName === \"KUCOIN\") {\n    return \"KUCN\";\n  }\n\n  if (exchangeName === \"ZIGNALY\") {\n    if (exchangeType === \"FUTURES\") {\n      return \"BIFU\";\n    }\n\n    return \"BINA\";\n  }\n\n  // Fallback to Binance when none of above conditions are met.\n  return \"BINA\";\n}\n\n/**\n * Map exchange connection to Trading View exchange ID.\n *\n * @export\n * @param {string} exchangeName Exchange name.\n * @returns {string} Coinray exchange ID.\n */\nexport function mapExchangeConnectionToTradingViewId(exchangeName) {\n  // When not valid exchange object fallback to Binance.\n  if (!exchangeName) {\n    return \"BINANCE\";\n  }\n\n  const exchangeNameNormalized = exchangeName.toUpperCase();\n\n  if (exchangeNameNormalized === \"ZIGNALY\") {\n    return \"BINANCE\";\n  }\n\n  return exchangeNameNormalized;\n}\n\n/**\n * Generate trading view symbol with exchange id\n *\n * @export\n * @param {string} tradeViewSymbol Symbol\n * @param {ExchangeConnectionEntity} exchange Exchange connection entity.\n * @returns {string} TradingView Symbol with exchange id\n */\nexport function getTradingViewExchangeSymbol(tradeViewSymbol, exchange) {\n  const symbolSuffix =\n    exchange.exchangeName.toLowerCase() !== \"bitmex\" && exchange.exchangeType === \"futures\"\n      ? \"PERP\"\n      : \"\";\n  const symbolCode = tradeViewSymbol + symbolSuffix;\n  const exchangeId = mapExchangeConnectionToTradingViewId(exchange.exchangeName || exchange.name);\n  return `${exchangeId}:${symbolCode}`;\n}\n\n/**\n * Creates an instance of VcceDataFeed.\n * @param {DataFeedOptions} options Construct options.\n * @returns {DataFeed} Exchange data feed\n */\nconst createDataFeed = (options) => {\n  let dataFeed = null;\n  if (options.exchange.exchangeName.toLowerCase() === \"vcce\") {\n    dataFeed = new VcceDataFeed(options);\n  } else if (options.exchange.exchangeName.toLowerCase() === \"ascendex\") {\n    dataFeed = new AscendexDataFeed(options);\n  }\n\n  // @ts-ignore\n  return dataFeed;\n};\n\n/**\n * Create Trading View data feed configuration.\n *\n * @param {WidgetOptions} options Configuration to create Trading View widget options\n *\n * @returns {ChartingLibraryWidgetOptions} Data feed options.\n */\nexport function createWidgetOptions(options) {\n  const { exchange, symbolsData, symbol, darkStyle } = options;\n  const dataFeedOptions = {\n    exchange,\n    symbolsData,\n  };\n  const feed = createDataFeed(dataFeedOptions);\n\n  return {\n    ...(feed && {\n      // Load market data to the self hosted charting library\n      datafeed: feed,\n      library_path: process.env.GATSBY_BASE_PATH + \"/charting_library/charting_library/\",\n    }),\n    autosize: true,\n    charts_storage_api_version: \"1.1\",\n    charts_storage_url: \"https://saveload.tradingview.com\",\n    client_id: \"tradingview.com\",\n    container_id: \"trading_view_chart\",\n    disabled_features: [\"header_symbol_search\"],\n    enabled_features: [\n      \"use_localstorage_for_settings\",\n      \"save_chart_properties_to_local_storage\",\n      \"countdown\",\n    ],\n    fullscreen: false,\n    hide_side_toolbar: false,\n    // @ts-ignore\n    interval: \"30\",\n    locale: \"en\",\n    studies_overrides: {},\n    // For external hosted widget, we should prefix the symbol with the exchange using getTradingViewExchangeSymbol\n    // However for some reason we won't receive the quoteUpdate events, so we have to update the symbol after init.\n    symbol,\n    // @ts-ignore\n    theme: darkStyle ? \"dark\" : \"light\",\n    user_id: \"public_user_id\",\n    // @ts-ignore\n    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,\n  };\n}\n","/**\n * Calculate DCA target price for a DCA percentage.\n *\n * @param {number} price Current quote price.\n * @param {number} dcaPercentage DCA target percentage.\n * @returns {number} DCA target price.\n */\nexport const calculateDcaPrice = (price, dcaPercentage) => {\n  return price + (price * dcaPercentage) / 100;\n};\n\n/**\n * @typedef {import(\"services/tradeApiClient.types\").MarketSymbol} MarketSymbol\n */\n\n/**\n * @param {number} positionSize positionSize\n * @param {number} price price\n * @param {MarketSymbol} symbol Exchange market symbol data.\n * @returns {number} units\n */\nexport const calculateUnits = (positionSize, price, symbol) => {\n  const { contractType, multiplier = 1 } = symbol;\n  if (contractType === \"inverse\") {\n    return (price * positionSize) / multiplier;\n  }\n  return positionSize / (price * multiplier);\n};\n","import * as React from 'react';\nimport createSvgIcon from './utils/createSvgIcon';\nexport default createSvgIcon( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z\"\n}), 'AddCircle');","import * as React from 'react';\nimport createSvgIcon from './utils/createSvgIcon';\nexport default createSvgIcon( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11H7v-2h10v2z\"\n}), 'RemoveCircle');","import React from \"react\";\nimport { useIntl, FormattedMessage } from \"react-intl\";\nimport { Box, FormHelperText, Tooltip } from \"@material-ui/core\";\n\n/**\n * @typedef {Object} HelperLabelProps\n * @property {string} labelId Label translation text ID.\n * @property {string} descriptionId Description translation ID to display in tooltip.\n */\n\n/**\n * Helper text with detailed description tooltip.\n *\n * @param {HelperLabelProps} props Component props.\n * @returns {JSX.Element} Helper label with description in tooltip element.\n */\nconst HelperLabel = (props) => {\n  const { labelId, descriptionId } = props;\n  const intl = useIntl();\n\n  return (\n    <Box alignItems=\"end\" className=\"help\" display=\"flex\" flexDirection=\"row\">\n      <Tooltip\n        arrow\n        enterTouchDelay={50}\n        placement=\"left-end\"\n        title={intl.formatMessage({ id: descriptionId })}\n      >\n        <FormHelperText>\n          <FormattedMessage id={labelId} />\n        </FormHelperText>\n      </Tooltip>\n    </Box>\n  );\n};\n\nexport default React.memo(HelperLabel);\n","import React from \"react\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\nimport { colors } from \"../../../services/theme\";\nimport { Box, FormHelperText, Tooltip } from \"@material-ui/core\";\nimport { Help } from \"@material-ui/icons\";\nimport \"./ProfitTargetStatus.scss\";\n\n/**\n * @typedef {Object} ProfitLabelProps\n * @property {string} labelId Status label translation text ID.\n * @property {ProfitTarget} profitTarget Position take profit target.\n */\n\n/**\n * Status label with detailed description tooltip.\n *\n * @param {ProfitLabelProps} props Component props.\n * @returns {JSX.Element} Helper label with description in tooltip element.\n */\nconst ProfitTargetStatus = (props) => {\n  const { profitTarget, labelId } = props;\n  const { formatMessage } = useIntl();\n  let iconColor = colors.darkGrey;\n\n  // Empty box to fill flex item space.\n  if (!profitTarget) {\n    return <Box />;\n  }\n\n  let description = formatMessage({ id: \"terminal.status.pending\" });\n\n  if (!profitTarget.done && profitTarget.orderId) {\n    iconColor = colors.blue;\n    description = formatMessage(\n      { id: \"terminal.status.placed\" },\n      { orderId: profitTarget.orderId },\n    );\n  } else if (profitTarget.done) {\n    description = formatMessage({ id: \"terminal.status.done\" });\n    iconColor = colors.green;\n  } else if (profitTarget.skipped) {\n    description = formatMessage({ id: \"terminal.status.failed\" });\n    iconColor = colors.red;\n  }\n\n  return (\n    <Box alignItems=\"center\" className=\"targetStatus\" display=\"flex\" justifyContent=\"flex-end\">\n      <FormHelperText>\n        <FormattedMessage id={labelId} />\n      </FormHelperText>\n      <Tooltip arrow enterTouchDelay={50} placement=\"left-end\" title={description}>\n        <Help style={{ fill: iconColor }} />\n      </Tooltip>\n    </Box>\n  );\n};\n\nexport default React.memo(ProfitTargetStatus);\n","import React, { useState } from \"react\";\n\n/**\n * @typedef {Object} Expandable\n * @property {boolean} expanded Flag to indicate if expanded toggle is enabled.\n * @property {string} expandClass Class name to represent expandable visual state.\n * @property {function(boolean):void} setExpanded Toggle expanded state.\n */\n\n/**\n * Provides expandable state and switch element.\n *\n * Supports expand / collapse display on other components.\n *\n * @param {boolean} [defaultExpand=false] Flag to indicate if expandable is expanded by default.\n * @returns {Expandable} An expandable object.\n */\nconst useExpandable = (defaultExpand = false) => {\n  const [expanded, setExpanded] = useState(defaultExpand);\n  const expandClass = expanded ? \"expanded\" : \"collapsed\";\n\n  return {\n    expanded,\n    expandClass,\n    setExpanded,\n  };\n};\n\nexport default useExpandable;\n","/**\n * Progrmatically invoke change event simulation on a given element.\n *\n * @param {String} elementName Element name.\n * @returns {Void} None.\n */\nexport function simulateInputChangeEvent(elementName) {\n  const matches = document.getElementsByName(elementName);\n  const item = matches[0] || null;\n\n  // @ts-ignore\n  if (item && item._valueTracker) {\n    // @ts-ignore\n    item._valueTracker.setValue(\"\");\n    // Programatically invoke change event.\n    const event = new Event(\"input\", { bubbles: true });\n    item.dispatchEvent(event);\n  }\n}\n","import React, { useState, useEffect } from \"react\";\nimport { useFormContext } from \"react-hook-form\";\nimport { camelCase, range, upperFirst } from \"lodash\";\nimport { simulateInputChangeEvent } from \"../utils/events\";\n\n/**\n * @typedef {Object} TargetGroupHook\n * @property {number} cardinality\n * @property {Array<string>} cardinalityRange\n * @property {function} composeTargetPropertyName\n * @property {function} getGroupTargetId\n * @property {function} getTargetPropertyValue\n * @property {function} getTargetPropertyRawValue\n * @property {React.MouseEventHandler} handleTargetAdd\n * @property {React.MouseEventHandler} handleTargetRemove\n * @property {function} setTargetPropertyValue\n * @property {function} simulateInputChangeEvent\n */\n\n/**\n * Target group multi cardinality panel elements utilities.\n *\n * @param {string} groupName Target group base name, used for fields names composition.\n * @param {number} [defaultCardinality=1] Default cardinality value.\n * @returns {TargetGroupHook} Target group object.\n */\nconst useTargetGroup = (groupName, defaultCardinality = 1) => {\n  const [cardinality, setCardinality] = useState(defaultCardinality);\n  const { getValues, setValue } = useFormContext();\n  const cardinalityRange = range(1, cardinality + 1, 1).map(String);\n\n  const handleTargetAdd = () => {\n    setCardinality(cardinality + 1);\n  };\n\n  const handleTargetRemove = () => {\n    if (cardinality > 0) {\n      setCardinality(cardinality - 1);\n    }\n  };\n\n  useEffect(() => {\n    // If the default cardinality changes, update current value\n    // Needed when using \"Increase Position Size\", which ends up not needing the empty DCA first target group.\n    setCardinality(defaultCardinality);\n  }, [defaultCardinality]);\n\n  /**\n   * Compose dynamic target property name.\n   *\n   * @param {string} propertyName Property base name.\n   * @param {string} targetId Target index ID.\n   * @returns {string} Property name for a given target index.\n   */\n  const composeTargetPropertyName = (propertyName, targetId) => {\n    const targetPropertyName = camelCase(groupName) + upperFirst(`${propertyName}${targetId}`);\n\n    return targetPropertyName;\n  };\n\n  /**\n   * Get parsed target property form state value.\n   *\n   * @param {string} propertyName Property base name.\n   * @param {string} targetId Target index ID.\n   * @returns {number} Target property value.\n   */\n  function getTargetPropertyValue(propertyName, targetId) {\n    const draftPosition = getValues();\n    const targetPropertyName = composeTargetPropertyName(propertyName, targetId);\n\n    return parseFloat(draftPosition[targetPropertyName]);\n  }\n\n  /**\n   * Get raw target property form state value.\n   *\n   * @param {string} propertyName Property base name.\n   * @param {string} targetId Target index ID.\n   * @returns {number} Target property value.\n   */\n  function getTargetPropertyRawValue(propertyName, targetId) {\n    const draftPosition = getValues();\n    const targetPropertyName = composeTargetPropertyName(propertyName, targetId);\n\n    return draftPosition[targetPropertyName];\n  }\n\n  /**\n   * Set target property form state value.\n   *\n   * @param {string} propertyName Property base name.\n   * @param {string} targetId Target index ID.\n   * @param {string} value Value to set.\n   * @returns {Void} None.\n   */\n  function setTargetPropertyValue(propertyName, targetId, value) {\n    const targetPropertyName = composeTargetPropertyName(propertyName, targetId);\n\n    return setValue(targetPropertyName, value);\n  }\n\n  /**\n   * Get target group ID for changed input element event.\n   *\n   * @param {React.ChangeEvent<HTMLInputElement>} event Input change event.\n   * @return {string} Target group ID (cardinality);\n   */\n  function getGroupTargetId(event) {\n    const targetElement = event.target;\n    const targetGroup = targetElement.closest(\".targetGroup\");\n    const targetId = targetGroup.getAttribute(\"data-target-id\");\n\n    return targetId;\n  }\n\n  return {\n    cardinality,\n    cardinalityRange,\n    composeTargetPropertyName,\n    getGroupTargetId,\n    getTargetPropertyValue,\n    getTargetPropertyRawValue,\n    handleTargetAdd,\n    handleTargetRemove,\n    setTargetPropertyValue,\n    simulateInputChangeEvent,\n  };\n};\n\nexport default useTargetGroup;\n","import React from \"react\";\n\n/**\n * @typedef {import(\"services/tradeApiClient.types\").CopyTradersProvidersOption} CopyTradersProvidersOption\n */\n\n/**\n * @typedef {Object} TradingViewContext\n * @property {CopyTradersProvidersOption} providerService\n * @property {function} setProviderService\n * @property {number} updatedAt\n * @property {function} setUpdatedAt\n * @property {number} lastPrice\n * @property {function} setLastPrice\n */\n\nexport default React.createContext(/** @type {TradingViewContext} **/ ({}));\n","import { useContext } from \"react\";\nimport { useFormContext } from \"react-hook-form\";\nimport TradingViewContext from \"components/TradingTerminal/TradingView/TradingViewContext\";\n\n/**\n */\n\n/**\n * @typedef {Object} PositionEntryHook\n * @property {function} getEntryPrice\n * @property {function} getEntrySize\n * @property {function} getEntrySizeQuote\n * @property {function} getEntryPricePercentChange\n * @property {function} getProfitPercentage\n */\n\n/**\n * Provides dynamic resolution of position entry price.\n *\n * The entry price resolves as follows:\n * - From buyPrice on existing position.\n * - From strategy price input in new positions.\n *\n * @param {Position} positionEntity Position entity.\n * @returns {PositionEntryHook} Position entry hook object.\n */\nfunction usePositionEntry(positionEntity) {\n  const { watch } = useFormContext();\n  const { lastPrice } = useContext(TradingViewContext);\n  const strategyPrice = watch(\"price\");\n  const units = watch(\"units\");\n  const positionSize = watch(\"positionSize\");\n  const priceDifference = watch(\"priceDifference\");\n  const currentPrice = parseFloat(strategyPrice) || lastPrice;\n\n  /**\n   * Resolve position entry price for new or existing position.\n   *\n   * @returns {number} Entry price.\n   */\n  const getEntryPrice = () => {\n    if (positionEntity) {\n      return positionEntity.buyPrice;\n    }\n\n    return currentPrice;\n  };\n\n  /**\n   * Get position price difference from entry price.\n   *\n   * @returns {number} Price difference.\n   */\n  const getEntryPricePercentChange = () => {\n    // todo: priceDifference is always undefined, I think.\n    if (positionEntity) {\n      return priceDifference || positionEntity.priceDifference || 0;\n    }\n\n    return 0;\n  };\n\n  /**\n   * Get position profit percentage.\n   * Unlike priceDifference, it includes leverage and will be positive for profits in SHORT position.\n   *\n   * @returns {number} Price difference.\n   */\n  const getProfitPercentage = () => {\n    if (positionEntity) {\n      return positionEntity.profitPercentage;\n    }\n\n    return 0;\n  };\n\n  /**\n   * Resolve position entry size (base) for new or existing position.\n   *\n   * @returns {number} Base entry size.\n   */\n  const getEntrySize = () => {\n    if (positionEntity) {\n      return positionEntity.amount;\n    }\n\n    return parseFloat(units) || 0;\n  };\n\n  /**\n   * Resolve position entry size (quote) for new or existing position.\n   *\n   * @returns {number} Quote entry size.\n   */\n  const getEntrySizeQuote = () => {\n    if (positionEntity) {\n      return positionEntity.positionSizeQuote;\n    }\n\n    return parseFloat(positionSize) || 0;\n  };\n\n  return {\n    getEntryPrice,\n    getEntryPricePercentChange,\n    getEntrySize,\n    getEntrySizeQuote,\n    getProfitPercentage,\n  };\n}\n\nexport default usePositionEntry;\n","import { lt, gt } from \"lodash\";\nimport { useIntl } from \"react-intl\";\n\n/**\n * @typedef {Object} ValidationMethods\n * @property {function} lessThan\n * @property {function} greaterThan\n * @property {function} validPercentage\n */\n\n/**\n * Provides methods to validate form inputs.\n *\n * @returns {ValidationMethods} ValidationMethods\n */\nconst useValidation = () => {\n  const { formatMessage } = useIntl();\n\n  /**\n   * Check if value is less than the 2nd one. Take trade side into consideration.\n   * @param {number} value value\n   * @param {number} compare compared value\n   * @param {string} side trade side\n   * @param {string} errorId error translation id\n   * @param {*} [errorValues] error translation values\n   * @returns {boolean|string} true if validation pass, error message otherwise.\n   */\n  // eslint-disable-next-line max-params\n  const lessThan = (value, compare, side, errorId, errorValues = {}) => {\n    const sideErrorText = side.toUpperCase() === \"LONG\" ? \"lower\" : \"greater\";\n    const compareFn = side.toUpperCase() === \"LONG\" ? lt : gt;\n\n    return (\n      compareFn(value, compare) || formatMessage({ id: `${errorId}.${sideErrorText}` }, errorValues)\n    );\n  };\n\n  /**\n   * Check if value is greater than the 2nd one. Take trade side into consideration.\n   * @param {number} value value\n   * @param {number} compare compared value\n   * @param {string} side trade side\n   * @param {string} errorId error translation id\n   * @param {*} [errorValues] error translation values\n   * @returns {boolean|string} true if validation pass, error message otherwise.\n   */\n  // eslint-disable-next-line max-params\n  const greaterThan = (value, compare, side, errorId, errorValues = {}) => {\n    const sideErrorText = side.toUpperCase() === \"LONG\" ? \"greater\" : \"lower\";\n    const compareFn = side.toUpperCase() === \"LONG\" ? gt : lt;\n\n    return (\n      compareFn(value, compare) || formatMessage({ id: `${errorId}.${sideErrorText}` }, errorValues)\n    );\n  };\n\n  /**\n   * Check if value is a valid percentage.\n   * @param {number} value value\n   * @param {string} errorId error translation id\n   * @returns {boolean|string} true if validation pass, error message otherwise.\n   */\n  const validPercentage = (value, errorId) => {\n    return (value > 0 && value <= 100) || formatMessage({ id: errorId });\n  };\n\n  return {\n    lessThan,\n    greaterThan,\n    validPercentage,\n  };\n};\n\nexport default useValidation;\n","import { useIntl } from \"react-intl\";\n\n/**\n * @typedef {import(\"services/tradeApiClient.types\").MarketSymbol} MarketSymbol\n */\n\n/**\n * @typedef {Object} SymbolLimitsValidateHook\n * @property {function} validateCostLimits\n * @property {function} validateTargetPriceLimits\n * @property {function} validateUnitsLimits\n */\n\n/**\n * Hook that provides symbol data limits validations.\n *\n * @param {MarketSymbol} symbolData Market symbol data object.\n * @returns {SymbolLimitsValidateHook} Symbol limits hook.\n */\nconst useSymbolLimitsValidate = (symbolData) => {\n  const { limits, contractType } = symbolData;\n  const { formatMessage } = useIntl();\n\n  /**\n   * Validate that target price is within limits.\n   *\n   * @param {number} targetPrice Rebuy target price.\n   * @param {string} errorMessageGroup Error message translation group ID.\n   * @returns {boolean|string} true if validation pass, error message otherwise.\n   */\n  const validateTargetPriceLimits = (targetPrice, errorMessageGroup) => {\n    // Skip validation when data not available.\n    if (!limits.price) {\n      return true;\n    }\n\n    if (limits.price.min && targetPrice < limits.price.min) {\n      return formatMessage({ id: errorMessageGroup + \".minprice\" }, { value: limits.price.min });\n    }\n\n    if (limits.price.max && targetPrice > limits.price.max) {\n      return formatMessage({ id: errorMessageGroup + \".maxprice\" }, { value: limits.price.max });\n    }\n\n    return true;\n  };\n\n  /**\n   * Validate that target units is within limits.\n   *\n   * @param {number} amount target units.\n   * @param {string} errorMessageGroup Error message translation group ID.\n   * @returns {boolean|string} true if validation pass, error message otherwise.\n   */\n  const validateUnitsLimits = (amount, errorMessageGroup) => {\n    const limitsAmount = contractType === \"inverse\" ? limits.cost : limits.amount;\n\n    // Skip validation when data not available.\n    if (!limitsAmount) {\n      return true;\n    }\n\n    if (limitsAmount.min && amount < limitsAmount.min) {\n      return formatMessage({ id: errorMessageGroup + \".minunits\" }, { value: limitsAmount.min });\n    }\n\n    if (limitsAmount.max && amount > limitsAmount.max) {\n      return formatMessage({ id: errorMessageGroup + \".maxunits\" }, { value: limitsAmount.max });\n    }\n\n    return true;\n  };\n\n  /**\n   * Validate that target cost is within limits.\n   *\n   * @param {number} cost Cost amount.\n   * @param {string} errorMessageGroup Error message translation group ID.\n   * @returns {boolean|string} true if validation pass, error message otherwise.\n   */\n  const validateCostLimits = (cost, errorMessageGroup) => {\n    const limitsCost = contractType === \"inverse\" ? limits.amount : limits.cost;\n\n    // Skip validation when data not available.\n    if (!limitsCost) {\n      return true;\n    }\n\n    if (limitsCost.min && cost < limitsCost.min) {\n      return formatMessage({ id: errorMessageGroup + \".mincost\" }, { value: limitsCost.min });\n    }\n\n    if (limitsCost.max && cost > limitsCost.max) {\n      return formatMessage({ id: errorMessageGroup + \".maxcost\" }, { value: limitsCost.max });\n    }\n\n    return true;\n  };\n\n  return {\n    validateCostLimits,\n    validateUnitsLimits,\n    validateTargetPriceLimits,\n  };\n};\n\nexport default useSymbolLimitsValidate;\n","import React from \"react\";\nimport { Checkbox, FormControlLabel } from \"@material-ui/core\";\nimport { Controller, useFormContext } from \"react-hook-form\";\nimport HelperLabel from \"../../HelperLabel/HelperLabel\";\nimport useSelectedExchange from \"hooks/useSelectedExchange\";\n\n/**\n * @param {Object} props Props\n * @param {string} [props.name] Control name\n * @param {boolean} [props.disabled] Disabled\n * @param {string} [props.exchange] Exchange for support check, default to selected exchange.\n * @returns {JSX.Element} JSX\n */\nconst PostOnlyControl = ({ name = \"postOnly\", disabled = false, exchange }) => {\n  const { control } = useFormContext();\n  const selectedExchange = useSelectedExchange();\n\n  // Check that exchange works with Post Only.\n  if ([\"vcce\", \"kucoin\"].includes((exchange || selectedExchange.exchangeName).toLowerCase())) {\n    return null;\n  }\n\n  return (\n    <FormControlLabel\n      className=\"customCheckbox\"\n      control={\n        <Controller\n          control={control}\n          defaultValue={false}\n          name={name}\n          render={({ onChange, value }) => (\n            <Checkbox\n              checked={value}\n              disabled={disabled}\n              onChange={(e) => onChange(e.target.checked)}\n            />\n          )}\n        />\n      }\n      label={<HelperLabel descriptionId=\"terminal.postonly.help\" labelId=\"terminal.postonly\" />}\n    />\n  );\n};\n\nexport default PostOnlyControl;\n","import React from \"react\";\nimport { Box, Tooltip } from \"@material-ui/core\";\nimport CustomNumberInput from \"components/Forms/CustomNumberInput\";\nimport { useFormContext } from \"react-hook-form\";\nimport HelperLabel from \"../../HelperLabel/HelperLabel\";\nimport \"./PricePercentageControl.scss\";\nimport { useIntl } from \"react-intl\";\n\n/**\n * @typedef {Object} PricePercentage\n * @property {string} name\n * @property {function(*):*} onChange\n * @property {function(string): boolean|string} [validate]\n * @property {string} [error]\n * @property {boolean} [allowNegative]\n */\n\n/**\n * @param {Object} props Props\n * @param {PricePercentage} props.percentage Percentage data.\n * @param {PricePercentage} props.price Price data.\n * @param {boolean} props.disabled Disabled boolean.\n * @param {string} props.quote Price Quote.\n * @param {string} props.priorityName Price or Percentage based priority param name.\n * @param {string} [props.defaultPriority] Default price priority.\n * @param {string} props.labelDescriptionId Label tooltip.\n * @param {string} props.labelId Label.\n * @param {JSX.Element} [props.status] Label status.\n * @returns {JSX.Element} JSX\n */\nconst PricePercentageControl = ({\n  percentage,\n  price,\n  disabled,\n  quote,\n  priorityName,\n  defaultPriority = \"percentage\",\n  labelId,\n  labelDescriptionId,\n  status,\n}) => {\n  const { errors, register, watch, setValue } = useFormContext();\n  const priorityValue = watch(priorityName, defaultPriority);\n  const intl = useIntl();\n\n  const togglePriority = () => {\n    if (!disabled) {\n      setValue(priorityName, priorityValue === \"price\" ? \"percentage\" : \"price\");\n    }\n  };\n\n  return (\n    <Box className=\"pricePercentageControl\">\n      <Box className=\"pricePercentageInputs\" display=\"flex\" flexDirection=\"row\" flexWrap=\"wrap\">\n        <HelperLabel descriptionId={labelDescriptionId} labelId={labelId} />\n        {status}\n        <Box\n          alignItems=\"center\"\n          className={`pricePercentageInput ${disabled ? \"readOnly\" : \"\"} ${\n            priorityValue === \"price\" ? \"disabled\" : \"\"\n          }`}\n          display=\"flex\"\n          onClick={() => priorityValue === \"price\" && togglePriority()}\n        >\n          <CustomNumberInput\n            allowNegative={Boolean(percentage.allowNegative)}\n            disabled={disabled || priorityValue === \"price\"}\n            name={percentage.name}\n            onChange={percentage.onChange}\n            rules={{\n              validate: percentage.validate || {\n                positive: (value) => value >= 0 || percentage.error,\n              },\n            }}\n            showErrorMessage={false}\n          />\n          <Tooltip\n            arrow\n            enterTouchDelay={50}\n            placement=\"left-end\"\n            title={intl.formatMessage({ id: \"terminal.percentage.priority.help\" })}\n          >\n            <div className=\"currencyBox\">\n              % {priorityValue !== \"price\" && <span className=\"dot\" />}\n            </div>\n          </Tooltip>\n        </Box>\n        <Box\n          alignItems=\"center\"\n          className={`pricePercentageInput ${disabled ? \"readOnly\" : \"\"} ${\n            priorityValue !== \"price\" ? \"disabled\" : \"\"\n          }`}\n          display=\"flex\"\n          onClick={() => priorityValue !== \"price\" && togglePriority()}\n        >\n          <CustomNumberInput\n            disabled={disabled || priorityValue !== \"price\"}\n            name={price.name}\n            onChange={price.onChange}\n            rules={{\n              validate: price.validate || {\n                positive: (value) => value >= 0 || price.error,\n              },\n            }}\n            showErrorMessage={false}\n          />\n          <Tooltip\n            arrow\n            enterTouchDelay={50}\n            placement=\"left-end\"\n            title={intl.formatMessage({ id: \"terminal.price.priority.help\" })}\n          >\n            <div className=\"currencyBox\">\n              {quote} {priorityValue === \"price\" && <span className=\"dot\" />}\n            </div>\n          </Tooltip>\n        </Box>\n        <input name={priorityName} ref={register} type=\"hidden\" />\n      </Box>\n      {errors[percentage.name] && (\n        <span className=\"errorText\">{errors[percentage.name].message}</span>\n      )}\n      {errors[price.name] && <span className=\"errorText\">{errors[price.name].message}</span>}\n    </Box>\n  );\n};\n\nexport default PricePercentageControl;\n","import React, { useEffect, useContext } from \"react\";\nimport { range, size, sum, values } from \"lodash\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\nimport { useFormContext } from \"react-hook-form\";\nimport { Button, Box, Typography, Switch } from \"@material-ui/core\";\nimport { AddCircle, RemoveCircle } from \"@material-ui/icons\";\nimport HelperLabel from \"../HelperLabel/HelperLabel\";\nimport ProfitTargetStatus from \"../ProfitTargetStatus/ProfitTargetStatus\";\nimport { formatPrice, format2Dec } from \"../../../utils/formatters\";\nimport useExpandable from \"../../../hooks/useExpandable\";\nimport useTargetGroup from \"../../../hooks/useTargetGroup\";\nimport usePositionEntry from \"../../../hooks/usePositionEntry\";\nimport useValidation from \"../../../hooks/useValidation\";\nimport useEffectSkipFirst from \"../../../hooks/useEffectSkipFirst\";\nimport \"./TakeProfitPanel.scss\";\nimport useSymbolLimitsValidate from \"../../../hooks/useSymbolLimitsValidate\";\nimport TradingViewContext from \"../TradingView/TradingViewContext\";\nimport PostOnlyControl from \"../Controls/PostOnlyControl/PostOnlyControl\";\nimport PricePercentageControl from \"../Controls/PricePercentageControl\";\nimport CustomNumberInput from \"components/Forms/CustomNumberInput\";\n\n/**\n * @typedef {import(\"services/tradeApiClient.types\").MarketSymbol} MarketSymbol\n */\n\n/**\n * @typedef {Object} TakeProfitPanelProps\n * @property {MarketSymbol} symbolData\n * @property {Position} [positionEntity] Position entity (optional) for position edit trading view.\n * @property {boolean} [isReadOnly] Flag to disable edition.\n */\n\n/**\n * Manual trading take profit panel component.\n *\n * @param {TakeProfitPanelProps} props Component props.\n * @returns {JSX.Element} Take profit panel element.\n */\nconst TakeProfitPanel = (props) => {\n  const { symbolData, positionEntity = null, isReadOnly = false } = props;\n  const positionTargetsCardinality = positionEntity ? size(positionEntity.takeProfitTargets) : 0;\n  const targetIndexes = range(1, positionTargetsCardinality + 1, 1);\n  const { expanded, expandClass, setExpanded } = useExpandable(positionTargetsCardinality > 0);\n  const { greaterThan, validPercentage } = useValidation();\n  const { validateTargetPriceLimits, validateCostLimits, validateUnitsLimits } =\n    useSymbolLimitsValidate(symbolData);\n\n  const {\n    clearErrors,\n    errors,\n    setValue,\n    watch,\n    getValues,\n    trigger,\n    formState: { dirtyFields },\n  } = useFormContext();\n  const defaultCardinality = 1;\n  const {\n    cardinality,\n    cardinalityRange,\n    composeTargetPropertyName,\n    getGroupTargetId,\n    getTargetPropertyValue,\n    handleTargetAdd,\n    handleTargetRemove,\n    setTargetPropertyValue,\n    simulateInputChangeEvent,\n  } = useTargetGroup(\n    \"takeProfit\",\n    positionEntity ? Math.max(defaultCardinality, positionTargetsCardinality) : defaultCardinality,\n  );\n\n  // Other panels watched variables to react on changes.\n  const entryType = positionEntity ? positionEntity.side : watch(\"entryType\");\n  const strategyPrice = watch(\"price\");\n  const strategyUnits = watch(\"units\");\n  const { providerService } = useContext(TradingViewContext);\n  const isCopyProvider =\n    (providerService && providerService.providerId !== \"1\") ||\n    (positionEntity && positionEntity.isCopyTrader);\n\n  const { getEntryPrice, getEntrySize } = usePositionEntry(positionEntity);\n  const targetsDone = positionEntity ? positionEntity.takeProfitTargetsCountSuccess : 0;\n  const isTargetLocked = positionEntity ? cardinality === targetsDone : false;\n  const disableRemoveAction = isReadOnly || isTargetLocked;\n  const isClosed = positionEntity ? positionEntity.closed : false;\n  const { formatMessage } = useIntl();\n\n  /**\n   * Check if target inputs should be disabled.\n   * @param {string} targetId Target id.\n   * @returns {boolean} .\n   */\n  const isDisabled = (targetId) => {\n    const target = positionEntity ? positionEntity.takeProfitTargets[parseInt(targetId)] : null;\n    return (target && target.done) || isReadOnly;\n  };\n\n  const getFieldsDisabledStatus = () => {\n    /**\n     * @type {Object<string, boolean>}\n     */\n    const fieldsDisabled = {};\n    targetIndexes.forEach((index) => {\n      const target = positionEntity ? positionEntity.takeProfitTargets[index] : { done: false };\n\n      let disabled = false;\n      if (target.done) {\n        disabled = true;\n      } else if (isReadOnly || isClosed) {\n        disabled = true;\n      }\n\n      fieldsDisabled[composeTargetPropertyName(\"exitUnitsPercentage\", index)] = disabled;\n      fieldsDisabled[composeTargetPropertyName(\"exitUnits\", index)] = disabled;\n      fieldsDisabled[composeTargetPropertyName(\"targetPrice\", index)] = disabled;\n      fieldsDisabled[composeTargetPropertyName(\"targetPricePercentage\", index)] = disabled;\n      fieldsDisabled[composeTargetPropertyName(\"postOnly\", index)] = disabled;\n    });\n\n    return fieldsDisabled;\n  };\n\n  const fieldsDisabled = getFieldsDisabledStatus();\n  const profitTargets = positionEntity ? positionEntity.takeProfitTargets : {};\n\n  /**\n   * Calculate price based on percentage change for a given target.\n   *\n   * @param {React.ChangeEvent<HTMLInputElement>} event Input change event.\n   * @return {Void} None.\n   */\n  const targetPricePercentageChange = (event) => {\n    const price = getEntryPrice();\n    const targetId = getGroupTargetId(event);\n    const priceProperty = composeTargetPropertyName(\"targetPrice\", targetId);\n    const targetPercentage = getTargetPropertyValue(\"targetPricePercentage\", targetId);\n    const pricePercentageProperty = composeTargetPropertyName(\"targetPricePercentage\", targetId);\n\n    if (errors[pricePercentageProperty]) return;\n\n    let targetPrice = price * ((targetPercentage + 100) / 100);\n    setValue(priceProperty, formatPrice(targetPrice, \"\", \"\"));\n    trigger(priceProperty);\n  };\n\n  /**\n   * Calculate percentage based on price change for a given target.\n   *\n   * @param {React.ChangeEvent<HTMLInputElement>} event Input change event.\n   * @return {Void} None.\n   */\n  const targetPriceChange = (event) => {\n    const price = getEntryPrice();\n    const targetId = getGroupTargetId(event);\n    const pricePercentageProperty = composeTargetPropertyName(\"targetPricePercentage\", targetId);\n    const targetPrice = getTargetPropertyValue(\"targetPrice\", targetId);\n    const priceProperty = composeTargetPropertyName(\"targetPrice\", targetId);\n\n    if (errors[priceProperty]) return;\n\n    const priceDiff = targetPrice - price;\n    const targetPercentage = (priceDiff / price) * 100;\n    setValue(pricePercentageProperty, format2Dec(targetPercentage));\n\n    trigger(pricePercentageProperty);\n  };\n\n  /**\n   * Validate cumulative targets percentage.\n   *\n   * @returns {boolean|string} true if validation passed, error message otherwise.\n   */\n  const validateCumulativePercentage = () => {\n    const exitUnitsPercentageFields = cardinalityRange.map((targetId) =>\n      composeTargetPropertyName(\"exitUnitsPercentage\", targetId),\n    );\n    const exitUnitsPercentages = getValues(exitUnitsPercentageFields);\n    const cumulativePercentage = sum(values(exitUnitsPercentages).map(Number));\n    if (cumulativePercentage > 100) {\n      return formatMessage({\n        id: \"terminal.takeprofit.limit.cumulative\",\n      });\n    }\n    return true;\n  };\n\n  /**\n   * Validate unit cost limits.\n   *\n   * @param {string} targetId targetId\n   * @returns {boolean|string} true if validation passed, error message otherwise.\n   */\n  const validateUnitCostLimits = (targetId) => {\n    const targetPrice = getTargetPropertyValue(\"targetPrice\", targetId);\n    const exitUnits = getTargetPropertyValue(\"exitUnits\", targetId);\n    const cost = Math.abs(targetPrice * exitUnits);\n    return validateCostLimits(cost, \"terminal.takeprofit.limit\");\n  };\n\n  /**\n   * Calculate units based on units percentage change for a given target.\n   *\n   * @param {string} targetId targetId\n   * @return {Void} None.\n   */\n  const exitUnitsPercentageChange = (targetId) => {\n    const units = getEntrySize();\n    const unitsProperty = composeTargetPropertyName(\"exitUnits\", targetId);\n    const exitUnitsPercentageProperty = composeTargetPropertyName(\"exitUnitsPercentage\", targetId);\n    const unitsPercentage = getTargetPropertyValue(\"exitUnitsPercentage\", targetId);\n\n    if (errors[exitUnitsPercentageProperty]) return;\n\n    const targetUnits = units * (unitsPercentage / 100);\n    setValue(unitsProperty, formatPrice(targetUnits, \"\", \"\"));\n    // Trigger validation unless change caused by initialization\n    if (dirtyFields[exitUnitsPercentageProperty]) {\n      trigger(unitsProperty);\n    }\n  };\n\n  /**\n   * Calculate units percentage based on units change for a given target.\n   *\n   * @param {React.ChangeEvent<HTMLInputElement>} event Input change event.\n   * @return {Void} None.\n   */\n  const exitUnitsChange = (event) => {\n    const units = getEntrySize();\n    const targetId = getGroupTargetId(event);\n    const unitsPercentageProperty = composeTargetPropertyName(\"exitUnitsPercentage\", targetId);\n    const exitUnits = getTargetPropertyValue(\"exitUnits\", targetId);\n    const exitUnitsProperty = composeTargetPropertyName(\"exitUnits\", targetId);\n    if (errors[exitUnitsProperty]) return;\n\n    if (units > 0 && exitUnits > 0) {\n      const unitsDiff = units - exitUnits;\n      const unitsPercentage = (1 - unitsDiff / units) * 100;\n      setValue(unitsPercentageProperty, format2Dec(unitsPercentage));\n    } else {\n      setValue(unitsPercentageProperty, \"\");\n    }\n  };\n\n  const initValuesFromPosition = () => {\n    if (positionEntity) {\n      targetIndexes.forEach((index) => {\n        // Initialization: populate with position targets values\n        const profitTarget = positionEntity.takeProfitTargets[index];\n        const priceTargetPercentage = format2Dec(profitTarget.priceTargetPercentage);\n        const priceTarget = formatPrice(profitTarget.priceTarget, \"\", \"\");\n        const amountPercentage = format2Dec(profitTarget.amountPercentage);\n        setTargetPropertyValue(\"targetPricePercentage\", index, priceTargetPercentage);\n        setTargetPropertyValue(\"targetPrice\", index, priceTarget);\n        setTargetPropertyValue(\"priority\", index, profitTarget.pricePriority);\n        setTargetPropertyValue(\"exitUnitsPercentage\", index, amountPercentage);\n        setTargetPropertyValue(\"postOnly\", index, profitTarget.postOnly);\n      });\n    }\n  };\n\n  useEffect(() => {\n    if (expanded) {\n      if (positionEntity) {\n        initValuesFromPosition();\n      } else {\n        chainedPriceUpdates();\n      }\n    } else {\n      cardinalityRange.forEach((targetId) => {\n        clearErrors(composeTargetPropertyName(\"exitUnitsPercentage\", targetId));\n        clearErrors(composeTargetPropertyName(\"exitUnits\", targetId));\n        clearErrors(composeTargetPropertyName(\"targetPrice\", targetId));\n        clearErrors(composeTargetPropertyName(\"targetPricePercentage\", targetId));\n        setValue(composeTargetPropertyName(\"targetPrice\", targetId), \"\");\n      });\n    }\n  }, [expanded]);\n\n  const chainedPriceUpdates = () => {\n    if (!expanded) return;\n\n    // Apply correct sign depending on entry type (Short/Long)\n    cardinalityRange.forEach((targetId) => {\n      const currentValue = getTargetPropertyValue(\"targetPricePercentage\", targetId);\n      const newValue = format2Dec(Math.abs(currentValue));\n      const sign = entryType === \"SHORT\" ? \"-\" : \"\";\n\n      if (isNaN(currentValue)) {\n        setTargetPropertyValue(\"targetPricePercentage\", targetId, sign);\n      } else {\n        setTargetPropertyValue(\"targetPricePercentage\", targetId, `${sign}${newValue}`);\n\n        // Trigger target price/percentage calculation\n        const priorityName = composeTargetPropertyName(\"priority\", targetId);\n        const val = getValues();\n        if (val[priorityName] !== \"price\") {\n          simulateInputChangeEvent(composeTargetPropertyName(\"targetPricePercentage\", targetId));\n        } else {\n          simulateInputChangeEvent(composeTargetPropertyName(\"targetPrice\", targetId));\n        }\n      }\n    });\n  };\n\n  useEffectSkipFirst(chainedPriceUpdates, [entryType, strategyPrice]);\n\n  const chainedUnitsUpdates = () => {\n    if (expanded) {\n      cardinalityRange.forEach((targetId) => {\n        // Trigger units amount calculation\n        exitUnitsPercentageChange(targetId);\n      });\n    }\n  };\n\n  const entrySize = getEntrySize();\n  useEffect(chainedUnitsUpdates, [expanded, strategyUnits, entrySize]);\n\n  // Automatically expand/collpase panel depending on position current tps amount.\n  const autoExpandCollapse = () => {\n    setExpanded(Boolean(positionTargetsCardinality));\n  };\n  useEffect(autoExpandCollapse, [positionTargetsCardinality]);\n\n  /**\n   * Compose dynamic target property errors.\n   *\n   * @param {string} propertyName Property base name.\n   * @param {string} targetId Target index ID.\n   * @returns {JSX.Element|null} Errors JSX element.\n   */\n  const displayTargetFieldErrors = (propertyName, targetId) => {\n    const targetProperty = composeTargetPropertyName(propertyName, targetId);\n    if (errors[targetProperty]) {\n      return <span className=\"errorText\">{errors[targetProperty].message}</span>;\n    }\n\n    return null;\n  };\n\n  /**\n   * Validate target percentage limits.\n   *\n   * @param {string} value targetPricePercentage\n   * @returns {boolean|string} true if validation pass, error message otherwise.\n   */\n  const validateTargetPricePercentage = (value) => {\n    let valid = greaterThan(\n      parseFloat(value),\n      0,\n      entryType,\n      \"terminal.takeprofit.valid.pricepercentage\",\n      { value: 0 },\n    );\n    return valid;\n  };\n\n  return (\n    <Box className={`panel takeProfitPanel ${expandClass}`}>\n      <Box alignItems=\"center\" className=\"panelHeader\" display=\"flex\" flexDirection=\"row\">\n        {!isClosed && (\n          <Switch checked={expanded} onChange={(e) => setExpanded(e.target.checked)} size=\"small\" />\n        )}\n        <Box alignItems=\"center\" className=\"title\" display=\"flex\" flexDirection=\"row\">\n          <Typography variant=\"h5\">\n            <FormattedMessage id=\"terminal.takeprofit\" />\n          </Typography>\n        </Box>\n      </Box>\n      {expanded && (\n        <Box\n          className=\"panelContent\"\n          display=\"flex\"\n          flexDirection=\"row\"\n          flexWrap=\"wrap\"\n          justifyContent=\"space-around\"\n        >\n          {cardinalityRange.map((targetId) => (\n            <Box className=\"targetGroup\" data-target-id={targetId} key={`target${targetId}`}>\n              <Box className=\"targetPrice\">\n                <PricePercentageControl\n                  disabled={isDisabled(targetId)}\n                  labelDescriptionId=\"terminal.takeprofit.help\"\n                  labelId=\"terminal.target\"\n                  percentage={{\n                    name: composeTargetPropertyName(\"targetPricePercentage\", targetId),\n                    validate: validateTargetPricePercentage,\n                    onChange: targetPricePercentageChange,\n                    allowNegative: true,\n                  }}\n                  price={{\n                    name: composeTargetPropertyName(\"targetPrice\", targetId),\n                    onChange: targetPriceChange,\n                    validate: (value) =>\n                      validateTargetPriceLimits(value, \"terminal.takeprofit.limit\"),\n                  }}\n                  priorityName={composeTargetPropertyName(\"priority\", targetId)}\n                  quote={symbolData.quote}\n                  status={\n                    <ProfitTargetStatus\n                      labelId=\"terminal.status\"\n                      profitTarget={profitTargets[Number(targetId)] || null}\n                    />\n                  }\n                />\n              </Box>\n              <Box className=\"targetUnits\" display=\"flex\" flexDirection=\"row\" flexWrap=\"wrap\">\n                <HelperLabel\n                  descriptionId=\"terminal.unitstoexit.help\"\n                  labelId=\"terminal.unitstoexit\"\n                />\n                <Box alignItems=\"center\" display=\"flex\">\n                  <CustomNumberInput\n                    disabled={isDisabled(targetId)}\n                    name={composeTargetPropertyName(\"exitUnitsPercentage\", targetId)}\n                    onChange={() => exitUnitsPercentageChange(targetId)}\n                    rules={\n                      fieldsDisabled[composeTargetPropertyName(\"exitUnitsPercentage\", targetId)]\n                        ? null\n                        : {\n                            validate: {\n                              percentage: (value) =>\n                                validPercentage(value, \"terminal.takeprofit.valid.unitspercentage\"),\n                              sum: validateCumulativePercentage,\n                            },\n                          }\n                    }\n                    showErrorMessage={false}\n                  />\n                  <div className=\"currencyBox\">%</div>\n                </Box>\n                {!isCopyProvider && (\n                  <>\n                    <Box alignItems=\"center\" display=\"flex\">\n                      <CustomNumberInput\n                        disabled={isDisabled(targetId)}\n                        name={composeTargetPropertyName(\"exitUnits\", targetId)}\n                        onChange={exitUnitsChange}\n                        rules={\n                          fieldsDisabled[composeTargetPropertyName(\"exitUnits\", targetId)]\n                            ? null\n                            : {\n                                validate: {\n                                  positive: (value) =>\n                                    value >= 0 ||\n                                    formatMessage({\n                                      id: \"terminal.takeprofit.valid.units\",\n                                    }),\n                                  limit: (value) =>\n                                    validateUnitsLimits(value, \"terminal.takeprofit.limit\"),\n                                  cost: () => validateUnitCostLimits(targetId),\n                                },\n                              }\n                        }\n                        showErrorMessage={false}\n                      />\n                      <div className=\"currencyBox\">{symbolData.unitsAmount}</div>\n                    </Box>\n                  </>\n                )}\n                {displayTargetFieldErrors(\"exitUnitsPercentage\", targetId)}\n                {!isCopyProvider && displayTargetFieldErrors(\"exitUnits\", targetId)}\n              </Box>\n              <Box alignItems=\"center\" display=\"flex\" flexDirection=\"row\" justifyContent=\"start\">\n                <PostOnlyControl\n                  disabled={isDisabled(targetId)}\n                  exchange={positionEntity?.exchange}\n                  name={composeTargetPropertyName(\"postOnly\", targetId)}\n                />\n              </Box>\n            </Box>\n          ))}\n          <Box className=\"targetActions\" display=\"flex\" flexDirection=\"row\" flexWrap=\"wrap\">\n            {!disableRemoveAction && (\n              <Button className=\"removeTarget\" onClick={handleTargetRemove}>\n                <RemoveCircle />\n                <FormattedMessage id=\"terminal.target.remove\" />\n              </Button>\n            )}\n            {!isReadOnly && (\n              <Button className=\"addTarget\" onClick={handleTargetAdd}>\n                <AddCircle />\n                <FormattedMessage id=\"terminal.target.add\" />\n              </Button>\n            )}\n          </Box>\n        </Box>\n      )}\n    </Box>\n  );\n};\n\nexport default React.memo(TakeProfitPanel);\n","import React from \"react\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\nimport { colors } from \"../../../services/theme\";\nimport { Box, FormHelperText, Tooltip } from \"@material-ui/core\";\nimport { Help } from \"@material-ui/icons\";\nimport \"./DCATargetStatus.scss\";\n\n/**\n * @typedef {Object} DCATargetLabelProps\n * @property {string} labelId Status label translation text ID.\n * @property {ReBuyTarget} dcaTarget Position take profit target.\n */\n\n/**\n * DCA status label with detailed description tooltip.\n *\n * @param {DCATargetLabelProps} props Component props.\n * @returns {JSX.Element} Helper label with description in tooltip element.\n */\nconst DCATargetStatus = (props) => {\n  const { dcaTarget, labelId } = props;\n  const { formatMessage } = useIntl();\n  let iconColor = colors.darkGrey;\n  let description = formatMessage({ id: \"terminal.status.pending\" });\n\n  // Empty box to fill flex item space.\n  if (!dcaTarget) {\n    return <Box />;\n  }\n\n  if (!dcaTarget.done && !dcaTarget.skipped && !dcaTarget.cancel && dcaTarget.orderId) {\n    description = formatMessage({ id: \"terminal.status.placed\" }, { orderId: dcaTarget.orderId });\n    iconColor = colors.blue;\n  } else if (dcaTarget.done && !dcaTarget.skipped && !dcaTarget.cancel && dcaTarget.orderId) {\n    description = formatMessage({ id: \"terminal.status.done\" });\n    iconColor = colors.green;\n  } else if ((dcaTarget.skipped || dcaTarget.cancel) && dcaTarget.errorMSG) {\n    description = dcaTarget.errorMSG || formatMessage({ id: \"terminal.status.failed\" });\n    iconColor = colors.red;\n  }\n\n  return (\n    <Box alignItems=\"center\" className=\"targetStatus\" display=\"flex\" justifyContent=\"flex-end\">\n      <FormHelperText>\n        <FormattedMessage id={labelId} />\n      </FormHelperText>\n      <Tooltip arrow enterTouchDelay={50} placement=\"left-end\" title={description}>\n        <Help style={{ fill: iconColor }} />\n      </Tooltip>\n    </Box>\n  );\n};\n\nexport default React.memo(DCATargetStatus);\n","import { useEffect, useRef } from \"react\";\nimport { isEqual } from \"lodash\";\n\n/**\n * @typedef {import('react').EffectCallback} EffectCallback\n */\n\n/**\n * @param {*} value value\n * @returns {*} value\n */\nconst useDeepCompareMemoize = (value) => {\n  const ref = useRef();\n\n  if (!isEqual(value, ref.current)) {\n    ref.current = value;\n  }\n\n  return ref.current;\n};\n\n/**\n * Run effect on dependencies change (deep comparison)\n * @param {EffectCallback} callback useEffect callback\n * @param {Array<any>} dependencies useEffect dependencies\n * @returns {void}\n */\nconst useDeepCompareEffect = (callback, dependencies) => {\n  useEffect(callback, useDeepCompareMemoize(dependencies));\n};\n\nexport default useDeepCompareEffect;\n","import React, { useEffect, useState } from \"react\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\nimport { isEqual, keys, size } from \"lodash\";\nimport HelperLabel from \"../HelperLabel/HelperLabel\";\nimport {\n  Button,\n  Box,\n  Typography,\n  Switch,\n  RadioGroup,\n  Radio,\n  FormHelperText,\n  FormControlLabel,\n} from \"@material-ui/core\";\nimport { AddCircle, RemoveCircle } from \"@material-ui/icons\";\nimport { useFormContext, Controller } from \"react-hook-form\";\nimport { formatFloat2Dec } from \"../../../utils/format\";\nimport useExpandable from \"../../../hooks/useExpandable\";\nimport useTargetGroup from \"../../../hooks/useTargetGroup\";\nimport useSymbolLimitsValidate from \"../../../hooks/useSymbolLimitsValidate\";\nimport { calculateDcaPrice, calculateUnits } from \"utils/calculations\";\nimport DCATargetStatus from \"../DCATargetStatus/DCATargetStatus\";\nimport usePositionEntry from \"../../../hooks/usePositionEntry\";\nimport \"./DCAPanel.scss\";\nimport useValidation from \"../../../hooks/useValidation\";\nimport useDeepCompareEffect from \"../../../hooks/useDeepCompareEffect\";\nimport PostOnlyControl from \"../Controls/PostOnlyControl/PostOnlyControl\";\nimport useEffectSkipFirst from \"hooks/useEffectSkipFirst\";\nimport { formatPrice } from \"utils/formatters\";\nimport CustomNumberInput from \"components/Forms/CustomNumberInput\";\n\n/**\n * @typedef {import(\"services/tradeApiClient.types\").MarketSymbol} MarketSymbol\n */\n\n/**\n * @typedef {Object} DCAPanelProps\n * @property {MarketSymbol} symbolData\n * @property {Position} [positionEntity] Position entity (optional) for position edit trading view.\n * @property {boolean} [isReadOnly] Flag to disable edition.\n */\n\n/**\n * Manual trading take profit panel component.\n *\n * @param {DCAPanelProps} props Component props.\n * @returns {JSX.Element} Take profit panel element.\n */\nconst DCAPanel = (props) => {\n  const { positionEntity, symbolData, isReadOnly = false } = props;\n  const {\n    clearErrors,\n    errors,\n    register,\n    setValue,\n    watch,\n    trigger,\n    getValues,\n    formState: { dirtyFields },\n  } = useFormContext();\n  const rebuyTargets = positionEntity ? positionEntity.reBuyTargets : {};\n  const { getEntryPrice, getEntrySizeQuote } = usePositionEntry(positionEntity);\n  const { formatMessage } = useIntl();\n  const { lessThan } = useValidation();\n\n  /**\n   * @typedef {Object} PositionDcaIndexes\n   * @property {number} dcaRebuyDoneCount\n   * @property {Array<string>} dcaAllIndexes\n   * @property {Array<string>} dcaRebuyIndexes\n   * @property {Array<string>} dcaIncreaseIndexes\n   */\n\n  /**\n   * Extract indexes for Rebuys and Increase position DCAs target.\n   *\n   * Increase positions are tracked as DCAs starting in index 1000:\n   *   - Targets from 1 until 999 are reBuys.\n   *   - Targets equal or greater than 1000 are increased position.\n   *\n   * @returns {PositionDcaIndexes} DCA indexes data.\n   */\n  const resolveDcaIndexes = () => {\n    const dcaAllIndexes = keys(rebuyTargets).map(Number);\n    const dcaRebuyIndexes = dcaAllIndexes.filter((index) => index < 1000);\n    const dcaIncreaseIndexes = dcaAllIndexes.filter((index) => index >= 1000);\n    const dcaRebuyTargets = positionEntity\n      ? dcaRebuyIndexes.map((index) => rebuyTargets[index])\n      : [];\n    const dcaRebuyDoneCount = dcaRebuyTargets.filter((target) => target.done === true).length;\n\n    return {\n      dcaRebuyDoneCount,\n      dcaAllIndexes: dcaAllIndexes.map(String),\n      dcaRebuyIndexes: dcaRebuyIndexes.map(String),\n      dcaIncreaseIndexes: dcaIncreaseIndexes.map(String),\n    };\n  };\n\n  const { dcaRebuyDoneCount, dcaAllIndexes, dcaRebuyIndexes, dcaIncreaseIndexes } =\n    resolveDcaIndexes();\n  const [activeDcaIncreaseIndexes, setActiveDCAIncreaseIndexes] = useState(dcaIncreaseIndexes);\n  const positionTargetsCardinality = positionEntity\n    ? Math.max(dcaIncreaseIndexes.length ? 0 : 1, size(dcaRebuyIndexes))\n    : 1;\n  const { expanded, expandClass, setExpanded } = useExpandable(size(dcaAllIndexes) > 0);\n\n  const {\n    cardinality,\n    cardinalityRange,\n    composeTargetPropertyName,\n    getTargetPropertyValue,\n    handleTargetAdd,\n    handleTargetRemove,\n    setTargetPropertyValue,\n  } = useTargetGroup(\"dca\", positionTargetsCardinality);\n\n  const { validateTargetPriceLimits, validateCostLimits, validateUnitsLimits } =\n    useSymbolLimitsValidate(symbolData);\n\n  const isClosed = positionEntity ? positionEntity.closed : false;\n  const isDoneTargetReached = cardinality >= 1 && cardinality - 1 < dcaRebuyDoneCount;\n  const disableRemoveAction = isReadOnly || isDoneTargetReached || cardinality === 0;\n  const entryType = positionEntity ? positionEntity.side : watch(\"entryType\");\n  const strategyPrice = watch(\"price\");\n  const strategyPositionSize = watch(\"positionSize\");\n\n  let pricePriorityInit = \"percentage\";\n  // Init price priority with value from first DCA.\n  if (positionEntity && size(positionEntity.reBuyTargets)) {\n    let [firstDCA] = Object.values(positionEntity.reBuyTargets);\n    pricePriorityInit = firstDCA.pricePriority;\n  }\n  const pricePriority = watch(\"DCAPriority\", pricePriorityInit);\n\n  /**\n   * Handle DCA increase remove.\n   *\n   * @param {React.MouseEvent<HTMLButtonElement>} event Button click event.\n   * @returns {Void} None.\n   */\n  const handleDcaIncreaseRemove = (event) => {\n    const targetElement = event.currentTarget;\n    const targetId = targetElement.getAttribute(\"data-target-id\");\n    const newDcaIncreaseIndexes = activeDcaIncreaseIndexes.filter((value) => value !== targetId);\n    setActiveDCAIncreaseIndexes(newDcaIncreaseIndexes);\n  };\n\n  /**\n   * @typedef {Object<string, boolean>} DcaFlagIndex\n   */\n\n  /**\n   * Create an index of DCA execution for existing DCAs.\n   *\n   * @returns {DcaFlagIndex} DCAs execution index.\n   */\n  const getDcaExecutionIndex = () => {\n    /**\n     * @type {DcaFlagIndex}\n     */\n    const dcaExecutionIndex = {};\n    dcaAllIndexes.forEach((index) => {\n      if (positionEntity) {\n        const target = positionEntity.reBuyTargets[Number(index)];\n        dcaExecutionIndex[index] = false;\n\n        if (target.done || target.skipped) {\n          dcaExecutionIndex[index] = true;\n        }\n      }\n    });\n\n    return dcaExecutionIndex;\n  };\n\n  /**\n   * Create an index of DCA target fields that should be disabled (read-only).\n   *\n   * @returns {DcaFlagIndex} DCA target fields disable status index.\n   */\n  const getFieldsDisabledStatus = () => {\n    /**\n     * @type {DcaFlagIndex}\n     */\n    const fieldsDisabled = {};\n    dcaAllIndexes.forEach((index) => {\n      let disabled = false;\n      if (dcaExecutionIndex[index] || isReadOnly) {\n        disabled = true;\n      }\n\n      fieldsDisabled[composeTargetPropertyName(\"rebuyPercentage\", index)] = disabled;\n      fieldsDisabled[composeTargetPropertyName(\"targetPricePercentage\", index)] = disabled;\n      fieldsDisabled[composeTargetPropertyName(\"rebuyPrice\", index)] = disabled;\n      fieldsDisabled[composeTargetPropertyName(\"postOnly\", index)] = disabled;\n    });\n\n    return fieldsDisabled;\n  };\n\n  /**\n   * Check if target inputs should be disabled.\n   * @param {string} targetId Target id.\n   * @returns {boolean} .\n   */\n  const isDisabled = (targetId) => {\n    return Boolean(dcaExecutionIndex[targetId]) || isReadOnly;\n  };\n\n  //  const validateUnits = (targetId) => {\n  //    const positionSize = getEntrySizeQuote();\n  //    const units = range(1, Number(targetId), 1).reduce((units, index) => {\n  //      return units + calculateUnits(positionSize, index);\n  //    }, 0);\n\n  //    if (positionSize > 0) {\n  //      return validateUnitsLimits(units, \"terminal.dca.limit\");\n  //    }\n\n  //    return true;\n  //  };\n\n  /**\n   * Effects for when rebuy units change.\n   *\n   * This is not tied to any input due to the fact that this is derived from\n   * position size and price.\n   *\n   * @param {string} targetId Target group ID.\n   * @returns {boolean} true if validation pass, false otherwise.\n   */\n  const validateUnits = (targetId) => {\n    const positionSize = getEntrySizeQuote();\n    const rebuyPercentage = getTargetPropertyValue(\"rebuyPercentage\", targetId);\n    const rebuyPositionSize = positionSize * (rebuyPercentage / 100);\n    const price = getEntryPrice();\n    const targetPricePercentage = getTargetPropertyValue(\"targetPricePercentage\", targetId);\n    const targetPrice = price * (1 - targetPricePercentage / 100);\n\n    const units = calculateUnits(rebuyPositionSize, targetPrice, symbolData);\n    // todo: positionSize and price are null when creating a position\n    if (targetId === \"1\" && positionSize > 0) {\n      return validateUnitsLimits(units, \"terminal.dca.limit\");\n    }\n\n    return true;\n  };\n\n  /**\n   * Validate target percentage\n   * @param {string} targetPricePercentageRaw targetPricePercentage value\n   * @returns {boolean|string} true if validation pass, error message otherwise.\n   */\n  const validateDCAPriceLimit = (targetPricePercentageRaw) => {\n    const price = getEntryPrice();\n    const targetPricePercentage = parseFloat(targetPricePercentageRaw);\n    const targetPrice = calculateDcaPrice(price, targetPricePercentage);\n    return validateTargetPriceLimits(targetPrice, \"terminal.dca.limit\");\n  };\n\n  /**\n   * Validate DCA Units Cost limits\n   * @param {string} targetId targetId\n   * @returns {boolean|string} true if validation pass, error message otherwise.\n   */\n  const validateUnitCostLimits = (targetId) => {\n    const positionSize = getEntrySizeQuote();\n    const rebuyPercentage = getTargetPropertyValue(\"rebuyPercentage\", targetId);\n    const rebuyPositionSize = positionSize * (rebuyPercentage / 100);\n    if (targetId === \"1\" && positionSize > 0) {\n      return validateCostLimits(rebuyPositionSize, \"terminal.dca.limit\");\n    }\n\n    return true;\n  };\n\n  /**\n   * Compose dynamic target property errors.\n   *\n   * @param {string} propertyName Property base name.\n   * @param {string} targetId Target index ID.\n   * @returns {JSX.Element|null} Errors JSX element.\n   */\n  const displayTargetFieldErrors = (propertyName, targetId) => {\n    const targetProperty = composeTargetPropertyName(propertyName, targetId);\n    if (errors[targetProperty]) {\n      return <span className=\"errorText\">{errors[targetProperty].message}</span>;\n    }\n\n    return null;\n  };\n\n  const initValuesFromPosition = () => {\n    if (positionEntity) {\n      // Sync any DCA increase update with local state.\n      if (!isEqual(activeDcaIncreaseIndexes, dcaIncreaseIndexes)) {\n        setActiveDCAIncreaseIndexes(dcaIncreaseIndexes);\n      }\n\n      dcaAllIndexes.forEach((index) => {\n        const profitTarget = positionEntity.reBuyTargets[Number(index)];\n        const triggerPercentage = formatFloat2Dec(profitTarget.triggerPercentage);\n        const priceTarget = formatPrice(profitTarget.priceTarget);\n        const quantityPercentage = formatFloat2Dec(profitTarget.quantity);\n        setTargetPropertyValue(\"targetPricePercentage\", index, triggerPercentage);\n        setTargetPropertyValue(\"rebuyPrice\", index, priceTarget);\n        setTargetPropertyValue(\"rebuyPercentage\", index, quantityPercentage);\n        setTargetPropertyValue(\"postOnly\", index, profitTarget.postOnly);\n      });\n    }\n  };\n\n  useDeepCompareEffect(() => {\n    if (expanded) {\n      if (positionEntity) {\n        initValuesFromPosition();\n      } else {\n        chainedPriceUpdates();\n      }\n    }\n  }, [expanded, rebuyTargets]);\n\n  const priorityUpdate = () => {\n    cardinalityRange.forEach((targetId) => {\n      clearErrors([\n        composeTargetPropertyName(\"targetPricePercentage\", targetId),\n        composeTargetPropertyName(\"rebuyPrice\", targetId),\n      ]);\n\n      // Update DCA price priority\n      let targetPricePriority = pricePriority;\n      if (positionEntity) {\n        const profitTarget = positionEntity.reBuyTargets[Number(targetId)];\n        if (profitTarget && dcaExecutionIndex[targetId]) {\n          // Executed DCAs can't be changed.\n          targetPricePriority = profitTarget.pricePriority;\n        }\n      }\n      setTargetPropertyValue(\"rebuyPriority\", targetId, targetPricePriority);\n    });\n  };\n  useEffect(priorityUpdate, [pricePriority]);\n\n  const chainedPriceUpdates = () => {\n    if (expanded) {\n      cardinalityRange.forEach((targetId) => {\n        const currentValue = getTargetPropertyValue(\"targetPricePercentage\", targetId);\n        const newValue = formatFloat2Dec(Math.abs(currentValue));\n        const sign = entryType === \"LONG\" ? \"-\" : \"\";\n\n        if (isNaN(currentValue)) {\n          setTargetPropertyValue(\"targetPricePercentage\", targetId, sign);\n        } else {\n          setTargetPropertyValue(\"targetPricePercentage\", targetId, `${sign}${newValue}`);\n\n          const targetPercentageProperty = composeTargetPropertyName(\n            \"targetPricePercentage\",\n            targetId,\n          );\n\n          // Validate only when not yet executed.\n          if (!dcaExecutionIndex[targetId] && dirtyFields[targetPercentageProperty]) {\n            trigger(targetPercentageProperty);\n          }\n        }\n      });\n    }\n  };\n\n  useEffectSkipFirst(chainedPriceUpdates, [cardinality, entryType, strategyPrice]);\n\n  // Automatically expand/collpase panel depending on dca orders amount.\n  const autoExpandCollapse = () => {\n    setExpanded(Boolean(dcaAllIndexes.length));\n  };\n  useEffect(autoExpandCollapse, [dcaAllIndexes.length]);\n\n  const chainedUnitsUpdates = () => {\n    const rebuyPercentageProperty = composeTargetPropertyName(\"rebuyPercentage\", 1);\n\n    if (\n      expanded &&\n      cardinality > 0 &&\n      !dcaExecutionIndex[\"1\"] &&\n      dirtyFields[rebuyPercentageProperty]\n    ) {\n      trigger(rebuyPercentageProperty);\n    }\n  };\n\n  useEffect(chainedUnitsUpdates, [expanded, strategyPositionSize]);\n\n  const emptyFieldsWhenCollapsed = () => {\n    if (!expanded) {\n      cardinalityRange.forEach((targetId) => {\n        clearErrors(composeTargetPropertyName(\"targetPricePercentage\", targetId));\n        clearErrors(composeTargetPropertyName(\"rebuyPrice\", targetId));\n        clearErrors(composeTargetPropertyName(\"rebuyPercentage\", targetId));\n        setValue(composeTargetPropertyName(\"targetPricePercentage\", targetId), \"\");\n      });\n    }\n  };\n\n  useEffect(emptyFieldsWhenCollapsed, [expanded]);\n  const dcaExecutionIndex = getDcaExecutionIndex();\n  const fieldsDisabled = getFieldsDisabledStatus();\n\n  /**\n   * Get DCA priority for target id.\n   * @param {string} targetId targetId.\n   * @returns {string} Priority.\n   */\n  const getDCAPriority = (targetId) => {\n    return getValues()[composeTargetPropertyName(\"rebuyPriority\", targetId)];\n  };\n\n  /**\n   * Display DCA target group.\n   *\n   * @param {string} targetId Target index.\n   * @returns {JSX.Element} Target element.\n   */\n  const displayDcaTarget = (targetId) => {\n    // Not disabled and DCA within increment index range.\n    const index = parseInt(targetId);\n    const showRemove =\n      !fieldsDisabled[composeTargetPropertyName(\"targetPricePercentage\", targetId)] &&\n      targetId !== cardinalityRange[cardinalityRange.length - 1];\n    return (\n      <Box className=\"targetGroup\" data-target-id={targetId} key={`target${targetId}`}>\n        <Box className=\"targetPrice\" display=\"flex\" flexDirection=\"row\" flexWrap=\"wrap\">\n          <HelperLabel\n            descriptionId={\n              getDCAPriority(targetId) === \"price\"\n                ? \"terminal.dca.help\"\n                : \"terminal.dca.percentage.help\"\n            }\n            labelId=\"terminal.target\"\n          />\n          <DCATargetStatus\n            dcaTarget={rebuyTargets[Number(targetId)] || null}\n            labelId=\"terminal.status\"\n          />\n          <input\n            defaultValue={pricePriority}\n            name={composeTargetPropertyName(\"rebuyPriority\", targetId)}\n            ref={register}\n            type=\"hidden\"\n          />\n          <Box alignItems=\"center\" display={getDCAPriority(targetId) !== \"price\" ? \"flex\" : \"none\"}>\n            <CustomNumberInput\n              allowNegative={true}\n              disabled={isDisabled(targetId)}\n              name={composeTargetPropertyName(\"targetPricePercentage\", targetId)}\n              rules={{\n                validate: (value) => {\n                  if (\n                    fieldsDisabled[composeTargetPropertyName(\"targetPricePercentage\", targetId)] ||\n                    pricePriority !== \"percentage\"\n                  ) {\n                    return true;\n                  }\n\n                  return (\n                    lessThan(\n                      parseFloat(value),\n                      0,\n                      entryType,\n                      \"terminal.dca.valid.pricepercentage\",\n                    ) || validateDCAPriceLimit\n                  );\n                },\n              }}\n              showErrorMessage={false}\n            />\n            <div className=\"currencyBox\">%</div>\n          </Box>\n          {displayTargetFieldErrors(\"targetPricePercentage\", targetId)}\n          <Box alignItems=\"center\" display={getDCAPriority(targetId) === \"price\" ? \"flex\" : \"none\"}>\n            <CustomNumberInput\n              disabled={isDisabled(targetId)}\n              name={composeTargetPropertyName(\"rebuyPrice\", targetId)}\n              rules={{\n                validate: (value) => {\n                  if (\n                    fieldsDisabled[composeTargetPropertyName(\"rebuyPrice\", targetId)] ||\n                    pricePriority !== \"price\"\n                  ) {\n                    return true;\n                  }\n\n                  return (\n                    // (value >= 0 || price.error) ||\n                    validateTargetPriceLimits(parseFloat(value), \"terminal.dca.limit\")\n                  );\n                },\n              }}\n              showErrorMessage={false}\n            />\n            <div className=\"currencyBox\">{symbolData.quote}</div>\n          </Box>\n          {displayTargetFieldErrors(\"rebuyPrice\", targetId)}\n          <HelperLabel descriptionId=\"terminal.rebuy.help\" labelId=\"terminal.rebuy\" />\n          <Box alignItems=\"center\" display=\"flex\">\n            <CustomNumberInput\n              disabled={isDisabled(targetId)}\n              name={composeTargetPropertyName(\"rebuyPercentage\", targetId)}\n              rules={\n                fieldsDisabled[composeTargetPropertyName(\"rebuyPercentage\", targetId)]\n                  ? null\n                  : {\n                      validate: {\n                        positive: (value) =>\n                          value > 0 ||\n                          formatMessage({\n                            id: \"terminal.dca.valid.unitspercentage\",\n                          }),\n                        limit: () => validateUnits(targetId),\n                        cost: () => validateUnitCostLimits(targetId),\n                      },\n                    }\n              }\n              showErrorMessage={false}\n            />\n            <div className=\"currencyBox\">%</div>\n          </Box>\n        </Box>\n        {displayTargetFieldErrors(\"rebuyPercentage\", targetId)}\n        <Box alignItems=\"center\" display=\"flex\" flexDirection=\"row\" justifyContent=\"start\">\n          <PostOnlyControl\n            disabled={isDisabled(targetId)}\n            exchange={positionEntity?.exchange}\n            name={composeTargetPropertyName(\"postOnly\", targetId)}\n          />\n        </Box>\n        {showRemove && (\n          <Box className=\"targetActions\" display=\"flex\" flexDirection=\"row\" flexWrap=\"wrap\">\n            <Button\n              className=\"removeTarget\"\n              data-target-id={index}\n              onClick={index >= 1000 ? handleDcaIncreaseRemove : handleTargetRemove}\n            >\n              <RemoveCircle />\n              <FormattedMessage id=\"terminal.target.remove\" />\n            </Button>\n          </Box>\n        )}\n      </Box>\n    );\n  };\n\n  return (\n    <Box className={`panel dcaPanel ${expandClass}`}>\n      <Box alignItems=\"center\" className=\"panelHeader\" display=\"flex\" flexDirection=\"row\">\n        {!isClosed && (\n          <Switch checked={expanded} onChange={(e) => setExpanded(e.target.checked)} size=\"small\" />\n        )}\n        <Box alignItems=\"center\" className=\"title\" display=\"flex\" flexDirection=\"row\">\n          <Typography variant=\"h5\">\n            <FormattedMessage id=\"terminal.dca\" />\n          </Typography>\n        </Box>\n      </Box>\n      {expanded && (\n        <Box\n          className=\"panelContent\"\n          display=\"flex\"\n          flexDirection=\"row\"\n          flexWrap=\"wrap\"\n          justifyContent=\"space-around\"\n        >\n          <Box className=\"priorityType\">\n            <HelperLabel descriptionId=\"terminal.rebuy.type.help\" labelId=\"terminal.rebuy.type\" />\n            <Controller\n              defaultValue={pricePriority}\n              name=\"DCAPriority\"\n              render={({ onChange, value }) => (\n                <RadioGroup\n                  aria-label=\"type\"\n                  className=\"customRadio\"\n                  onChange={onChange}\n                  row\n                  value={value}\n                >\n                  <FormControlLabel\n                    control={<Radio disabled={isReadOnly} />}\n                    label={\n                      <FormHelperText>\n                        <FormattedMessage id=\"terminal.percentage\" />\n                      </FormHelperText>\n                    }\n                    value=\"percentage\"\n                  />\n                  <FormControlLabel\n                    control={<Radio disabled={isReadOnly} />}\n                    label={\n                      <FormHelperText>\n                        <FormattedMessage id=\"terminal.rebuy.fixedprice\" />\n                      </FormHelperText>\n                    }\n                    value=\"price\"\n                  />\n                </RadioGroup>\n              )}\n            />\n          </Box>\n          {cardinalityRange.map((targetId) => displayDcaTarget(targetId))}\n          <Box className=\"targetActions\" display=\"flex\" flexDirection=\"row\" flexWrap=\"wrap\">\n            {!disableRemoveAction && (\n              <Button className=\"removeTarget\" onClick={handleTargetRemove}>\n                <RemoveCircle />\n                <FormattedMessage id=\"terminal.target.remove\" />\n              </Button>\n            )}\n            {!isReadOnly && (\n              <Button className=\"addTarget\" onClick={handleTargetAdd}>\n                <AddCircle />\n                <FormattedMessage id=\"terminal.target.add\" />\n              </Button>\n            )}\n          </Box>\n          {activeDcaIncreaseIndexes.length ? (\n            <Typography className=\"callout1 increaseDCATitle\">\n              <FormattedMessage id=\"terminal.dca.increase\" />\n            </Typography>\n          ) : null}\n          {activeDcaIncreaseIndexes.map((targetId) => displayDcaTarget(targetId))}\n        </Box>\n      )}\n    </Box>\n  );\n};\n\nexport default React.memo(DCAPanel);\n","import React from \"react\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\nimport { colors } from \"../../../services/theme\";\nimport { Box, FormHelperText, Tooltip } from \"@material-ui/core\";\nimport { Help } from \"@material-ui/icons\";\nimport \"./StopLossStatus.scss\";\n\n/**\n * @typedef {Object} StopLossStatusProps\n * @property {string} orderId Order Id\n */\n\n/**\n * Stop Loss status label with detailed description tooltip.\n *\n * @param {StopLossStatusProps} props Component props.\n * @returns {JSX.Element} Helper label with description in tooltip element.\n */\nconst StopLossStatus = (props) => {\n  const { orderId } = props;\n  const { formatMessage } = useIntl();\n  let iconColor = colors.darkGrey;\n  let description = formatMessage({ id: \"terminal.status.pending\" });\n\n  if (orderId) {\n    description = formatMessage({ id: \"terminal.status.placed\" }, { orderId });\n    iconColor = colors.blue;\n  }\n\n  return (\n    <Box alignItems=\"center\" className=\"targetStatus\" display=\"flex\" justifyContent=\"flex-end\">\n      <FormHelperText>\n        <FormattedMessage id=\"terminal.status\" />\n      </FormHelperText>\n      <Tooltip arrow enterTouchDelay={50} placement=\"left-end\" title={description}>\n        <Help style={{ fill: iconColor }} />\n      </Tooltip>\n    </Box>\n  );\n};\n\nexport default React.memo(StopLossStatus);\n","import { useEffect, useContext } from \"react\";\nimport { useFormContext } from \"react-hook-form\";\nimport { simulateInputChangeEvent } from \"../utils/events\";\nimport { useIntl } from \"react-intl\";\nimport TradingViewContext from \"components/TradingTerminal/TradingView/TradingViewContext\";\nimport { calculateUnits } from \"utils/calculations\";\nimport { isArray } from \"lodash\";\nimport { composePositionDcaTargets } from \"components/TradingTerminal/StrategyForm/StrategyForm\";\n\n/**\n * @typedef {import(\"services/tradeApiClient.types\").MarketSymbol} MarketSymbol\n * @typedef {import(\"react-hook-form/dist/types/form\").Validate} Validate\n */\n\n/**\n * @typedef {Object} PositionSizeHandlersHook\n * @property {React.ChangeEventHandler} positionSizeChange\n * @property {React.ChangeEventHandler} positionSizePercentageChange\n * @property {React.ChangeEventHandler} priceChange\n * @property {React.ChangeEventHandler} realInvestmentChange\n * @property {React.ChangeEventHandler} unitsChange\n * @property {Validate} validatePositionSize\n * @property {function(string, string?): string|boolean} validatePrice\n * @property {function(number): string|boolean} validateSellAmount\n * @property {Validate} validateUnits\n */\n\n/**\n * Trading terminal position size handlers.\n *\n * @param {MarketSymbol} selectedSymbol Exchange market symbol data.\n * @param {number} defaultLeverage Current leverage.\n *\n * @returns {PositionSizeHandlersHook} Position handlers hook object.\n */\nconst usePositionSizeHandlers = (selectedSymbol, defaultLeverage = null) => {\n  const { limits, contractType } = selectedSymbol;\n  const multiplier = selectedSymbol.multiplier || 1;\n  const { errors, getValues, setValue, watch, trigger } = useFormContext();\n  const leverage = watch(\"leverage\", defaultLeverage);\n  const entryType = watch(\"entryType\");\n  const entryStrategy = watch(\"entryStrategy\");\n  const { lastPrice, providerService } = useContext(TradingViewContext);\n  const strategyPrice = watch(\"price\");\n  const currentPrice = parseFloat(strategyPrice) || lastPrice;\n  // Short price for 'multi' strategy\n  let currentPriceShort = 0;\n  if (entryStrategy === \"multi\") {\n    const strategyPriceShort = watch(\"priceShort\");\n    currentPriceShort = parseFloat(strategyPriceShort) || lastPrice;\n  }\n  const providerAllocatedBalance = providerService ? providerService.providerPayableBalance : 0;\n  const { formatMessage } = useIntl();\n\n  /**\n   * Validate that position size is within limits.\n   *\n   * @param {any} positionSize Position size value.\n   * @returns {boolean|string} true if validation pass, error message otherwise.\n   */\n  function validatePositionSize(positionSize) {\n    const value = parseFloat(positionSize);\n    const limitsCost = contractType === \"inverse\" ? limits.amount : limits.cost;\n\n    if (limitsCost.min && value < limitsCost.min) {\n      return formatMessage({ id: \"terminal.positionsize.limit.min\" }, { value: limitsCost.min });\n    }\n\n    if (limitsCost.max && value > limitsCost.max) {\n      return formatMessage({ id: \"terminal.positionsize.limit.max\" }, { value: limitsCost.max });\n    }\n\n    if (!(value > 0)) {\n      return formatMessage({ id: \"terminal.positionsize.limit.zero\" });\n    }\n\n    return true;\n  }\n\n  /**\n   * Validate that the amount bought is enough to be sold at given price\n   *\n   * @param {number} amount Cost amount.\n   * @returns {boolean|string} true if validation pass, error message otherwise.\n   */\n  const validateSellAmount = (amount) => {\n    const rebuyTargets = composePositionDcaTargets(getValues());\n    if (isArray(rebuyTargets) && rebuyTargets.length) {\n      // Skip check when DCA for now\n      return true;\n    }\n\n    const limitsCost = contractType === \"inverse\" ? limits.amount : limits.cost;\n\n    // Skip validation when data not available.\n    if (!limitsCost) {\n      return true;\n    }\n\n    if (limitsCost.min && amount < limitsCost.min) {\n      return formatMessage({ id: \"terminal.sell.mincost\" }, { value: limitsCost.min });\n    }\n\n    return true;\n  };\n\n  /**\n   * Validate that units is within limits.\n   *\n   * @param {any} units Units value.\n   * @returns {boolean|string} true if validation pass, error message otherwise.\n   */\n  function validateUnits(units) {\n    const value = parseFloat(units);\n    const limitsAmount = contractType === \"inverse\" ? limits.cost : limits.amount;\n\n    if (limitsAmount.min && value < limitsAmount.min) {\n      return formatMessage({ id: \"terminal.positionunits.limit.min\" }, { value: limitsAmount.min });\n    }\n\n    if (limitsAmount.max && value > limitsAmount.max) {\n      return formatMessage({ id: \"terminal.positionunits.limit.max\" }, { value: limitsAmount.max });\n    }\n\n    if (isNaN(units)) {\n      return formatMessage({ id: \"terminal.positionsize.limit.zero\" });\n    }\n\n    return true;\n  }\n\n  /**\n   * Validate that price is within limits.\n   *\n   * @param {any} price Price value.\n   * @param {string} [multiSide] Side for multi order\n   * @returns {boolean|string} true if validation pass, error message otherwise.\n   */\n  function validatePrice(price, multiSide) {\n    const value = parseFloat(price);\n\n    let min = limits.price.min;\n    let max = limits.price.max;\n\n    if (multiSide) {\n      // Check that LONG price is below SHORT and the opposite\n      if (multiSide === \"long\") {\n        max = currentPriceShort;\n      } else {\n        min = currentPrice;\n      }\n    }\n\n    if (min && value < min) {\n      return multiSide === \"short\"\n        ? formatMessage({ id: \"terminal.positionprice.multi.short\" })\n        : formatMessage({ id: \"terminal.positionprice.limit.min\" }, { value: min });\n    }\n\n    if (max && value > max) {\n      return multiSide === \"long\"\n        ? formatMessage({ id: \"terminal.positionprice.multi.long\" })\n        : formatMessage({ id: \"terminal.positionprice.limit.max\" }, { value: max });\n    }\n\n    if (!(value > 0)) {\n      return formatMessage({ id: \"terminal.positionprice.limit.zero\" });\n    }\n\n    return true;\n  }\n\n  const realInvestmentChange = () => {\n    if (errors.realInvestment) return;\n\n    const draftPosition = getValues();\n    const positionSize = parseFloat(draftPosition.realInvestment) * leverage;\n    setValue(\"positionSize\", positionSize);\n    trigger(\"positionSize\").then((isValid) => {\n      if (isValid) {\n        updateUnits(positionSize);\n      }\n    });\n  };\n\n  /**\n   * @param {number} positionSize .\n   * @returns {void}\n   */\n  const updateUnits = (positionSize) => {\n    const units = calculateUnits(positionSize, currentPrice, selectedSymbol);\n    setValue(\"units\", units.toFixed(8));\n    trigger(\"units\");\n\n    if (entryStrategy === \"multi\") {\n      const unitsShort = calculateUnits(positionSize, currentPriceShort, selectedSymbol);\n      setValue(\"unitsShort\", unitsShort.toFixed(8));\n      trigger(\"unitsShort\");\n    }\n  };\n\n  const positionSizeChange = () => {\n    if (errors.positionSize) return;\n\n    const draftPosition = getValues();\n    const positionSize = parseFloat(draftPosition.positionSize);\n    updateUnits(positionSize);\n\n    const realInvestment = parseFloat(draftPosition.positionSize) / leverage;\n    setValue(\"realInvestment\", realInvestment.toFixed(8));\n  };\n\n  const positionSizePercentageChange = () => {\n    if (errors.positionSizePercentage) return;\n\n    const draftPosition = getValues();\n    const positionSizePercentage = parseFloat(draftPosition.positionSizePercentage);\n\n    const positionSize = (positionSizePercentage * providerAllocatedBalance) / 100;\n    setValue(\"positionSizeAllocated\", positionSize.toFixed(8));\n  };\n\n  const unitsChange = () => {\n    const draftPosition = getValues();\n    const units = parseFloat(draftPosition.units);\n    if (isNaN(units)) return;\n\n    let positionSize = units * currentPrice;\n    if (selectedSymbol.contractType === \"inverse\") {\n      positionSize = (units / currentPrice) * multiplier;\n    } else if (\n      selectedSymbol.contractType === \"quanto\" ||\n      selectedSymbol.contractType === \"linear\"\n    ) {\n      positionSize *= multiplier;\n    }\n\n    setValue(\"positionSize\", positionSize.toFixed(8));\n    trigger(\"positionSize\").then((isValid) => {\n      if (isValid) {\n        const realInvestment = positionSize / leverage;\n        setValue(\"realInvestment\", realInvestment.toFixed(8));\n      }\n    });\n  };\n\n  const priceChange = () => {\n    const draftPosition = getValues();\n    if (parseFloat(draftPosition.positionSize) > 0) {\n      simulateInputChangeEvent(\"positionSize\");\n    }\n\n    // Trigger the other price for multi order\n    trigger(\"price\");\n    trigger(\"priceShort\");\n  };\n\n  // Trigger position size recalculation on leverage/entryType change\n  useEffect(() => {\n    simulateInputChangeEvent(\"realInvestment\");\n  }, [entryType, leverage]);\n\n  return {\n    positionSizeChange,\n    positionSizePercentageChange,\n    priceChange,\n    realInvestmentChange,\n    unitsChange,\n    validatePositionSize,\n    validatePrice,\n    validateUnits,\n    validateSellAmount,\n  };\n};\n\nexport default usePositionSizeHandlers;\n","import React, { useEffect } from \"react\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\nimport { isNumber, some } from \"lodash\";\nimport { Box, Typography, Switch, FormHelperText } from \"@material-ui/core\";\nimport { formatPrice, format2Dec } from \"../../../utils/formatters\";\nimport { useFormContext, Controller } from \"react-hook-form\";\nimport useExpandable from \"../../../hooks/useExpandable\";\nimport useValidation from \"../../../hooks/useValidation\";\nimport usePositionEntry from \"../../../hooks/usePositionEntry\";\nimport \"./StopLossPanel.scss\";\nimport CustomSelect from \"../../CustomSelect\";\nimport PricePercentageControl from \"../Controls/PricePercentageControl\";\nimport StopLossStatus from \"../StopLossStatus/StopLossStatus\";\nimport usePositionSizeHandlers from \"hooks/usePositionSizeHandlers\";\nimport useEffectSkipFirst from \"hooks/useEffectSkipFirst\";\n\n/**\n * @typedef {import(\"services/tradeApiClient.types\").MarketSymbol} MarketSymbol\n */\n\n/**\n * @typedef {Object} StopLossPanel\n * @property {MarketSymbol} symbolData\n * @property {Position} [positionEntity] Position entity (optional) for position edit trading view.\n * @property {boolean} [isReadOnly] Flag to disable edition.\n */\n\n/**\n * Manual trading stop loss panel component.\n *\n * @param {StopLossPanel} props Component props.\n * @returns {JSX.Element} Take profit panel element.\n */\nconst StopLossPanel = (props) => {\n  const { symbolData, positionEntity, isReadOnly = false } = props;\n  const existsStopLoss = positionEntity\n    ? isNumber(positionEntity.stopLossPrice) && isNumber(positionEntity.stopLossPercentage)\n    : false;\n  const { expanded, expandClass, setExpanded } = useExpandable(existsStopLoss);\n  const { clearErrors, errors, getValues, register, setValue, watch, trigger, control } =\n    useFormContext();\n  const { lessThan } = useValidation();\n  const { getEntryPrice, getEntrySizeQuote } = usePositionEntry(positionEntity);\n  const entrySizeQuote = getEntrySizeQuote();\n  const { validateSellAmount } = usePositionSizeHandlers(symbolData);\n\n  const { formatMessage } = useIntl();\n  // Strategy panels inputs to observe for changes.\n  const entryType = positionEntity ? positionEntity.side : watch(\"entryType\");\n  let type = \"fixed\";\n  if (positionEntity) {\n    if (positionEntity.stopLossFollowsTakeProfit) {\n      type = \"stopLossFollowsTakeProfit\";\n    } else if (positionEntity.stopLossToBreakEven) {\n      type = \"stopLossToBreakEven\";\n    }\n  }\n  const strategyPrice = watch(\"price\");\n  const isClosed = positionEntity ? positionEntity.closed : false;\n  const hasReachedTp = positionEntity && some(positionEntity.takeProfitTargets, (tp) => tp.done);\n\n  const stopLossTypeOptions = [\n    { label: formatMessage({ id: \"terminal.stoploss.type.fixed\" }), val: \"fixed\" },\n    {\n      label: formatMessage({ id: \"terminal.stoploss.type.followtp\" }),\n      val: \"stopLossFollowsTakeProfit\",\n    },\n    {\n      label: formatMessage({ id: \"terminal.stoploss.type.breakeven\" }),\n      val: \"stopLossToBreakEven\",\n    },\n  ];\n\n  const getFieldsDisabledStatus = () => {\n    /**\n     * @type {Object<string, boolean>}\n     */\n    const fieldsDisabled = {};\n    let disabled = false;\n    if (isReadOnly) {\n      disabled = true;\n    }\n\n    fieldsDisabled.stopLossPrice = disabled;\n    fieldsDisabled.stopLossPercentage = disabled;\n    fieldsDisabled.stopLossType = disabled || hasReachedTp;\n\n    return fieldsDisabled;\n  };\n\n  const fieldsDisabled = getFieldsDisabledStatus();\n\n  /**\n   * Validate target percentage limits.\n   *\n   * @returns {boolean|string} true if validation pass, error message otherwise.\n   */\n  function validateStopLossPercentageLimits() {\n    const draftPosition = getValues();\n    const stopLossPercentage = parseFloat(draftPosition.stopLossPercentage);\n    // const profitPercentage =\n    //   entryType.toUpperCase() === \"SHORT\" ? -getProfitPercentage() : getProfitPercentage();\n    let valid = true;\n\n    if (!positionEntity) {\n      // Check sign when creating a position.\n      valid = lessThan(stopLossPercentage, 0, entryType, \"terminal.stoploss.valid.percentage\", {\n        value: 0,\n      });\n    }\n\n    if (valid === true && entrySizeQuote && stopLossPercentage) {\n      const unitsSold = (entrySizeQuote * (100 + stopLossPercentage)) / 100;\n      // @ts-ignore\n      valid = validateSellAmount(unitsSold);\n    }\n\n    return valid;\n  }\n\n  useEffectSkipFirst(() => {\n    trigger(\"stopLossPercentage\");\n  }, [entrySizeQuote]);\n\n  /**\n   * Calculate price based on percentage when value is changed.\n   *\n   * @return {Void} None.\n   */\n  const stopLossPercentageChange = () => {\n    if (errors.stopLossPercentage) return;\n\n    const draftPosition = getValues();\n    const price = getEntryPrice();\n    const stopLossPercentage = parseFloat(draftPosition.stopLossPercentage);\n    const stopLossPrice = (price * (100 + stopLossPercentage)) / 100;\n\n    if (!isNaN(price) && price > 0) {\n      setValue(\"stopLossPrice\", formatPrice(stopLossPrice, \"\", \"\"));\n    } else {\n      setValue(\"stopLossPrice\", \"\");\n    }\n\n    trigger(\"stopLossPrice\");\n  };\n\n  /**\n   * Calculate percentage based on price when value is changed.\n   *\n   * @return {Void} None.\n   */\n  const stopLossPriceChange = () => {\n    if (errors.stopLossPrice) return;\n\n    const draftPosition = getValues();\n    const price = getEntryPrice();\n    const stopLossPrice = parseFloat(draftPosition.stopLossPrice);\n    const priceDiff = stopLossPrice - price;\n\n    if (!isNaN(priceDiff) && priceDiff !== 0) {\n      const stopLossPercentage = (priceDiff / price) * 100;\n      setValue(\"stopLossPercentage\", format2Dec(stopLossPercentage));\n    } else {\n      setValue(\"stopLossPercentage\", \"\");\n    }\n\n    trigger(\"stopLossPercentage\");\n  };\n\n  const initStopLoss = () => {\n    if (expanded) {\n      if (positionEntity && positionEntity.stopLossPercentage) {\n        setValue(\"stopLossPriority\", positionEntity.stopLossPriority);\n        setValue(\"stopLossPrice\", formatPrice(positionEntity.stopLossPrice, \"\", \"\"));\n        setValue(\"stopLossPercentage\", format2Dec(positionEntity.stopLossPercentage));\n      }\n      updateStopLoss();\n    } else {\n      setValue(\"stopLossPrice\", \"\");\n      if (errors.stopLossPercentage) {\n        clearErrors(\"stopLossPercentage\");\n      }\n\n      if (errors.stopLossPrice) {\n        clearErrors(\"stopLossPrice\");\n      }\n    }\n  };\n  useEffect(initStopLoss, [expanded]);\n\n  const updateStopLoss = () => {\n    const draftPosition = getValues();\n    const initialStopLossPercentage = positionEntity ? positionEntity.stopLossPercentage : null;\n    const stopLossPercentage =\n      parseFloat(draftPosition.stopLossPercentage) || initialStopLossPercentage;\n    const sign = entryType === \"SHORT\" ? \"\" : \"-\";\n\n    if (!isNumber(stopLossPercentage)) {\n      // todo: not working due to input type=number\n      setValue(\"stopLossPercentage\", sign);\n    } else {\n      // When SL come from backend rely on the existing sign and value.\n      // Otherwise use the custom SL value and apply the sign corresponding to entry type.\n      const newValue = format2Dec(initialStopLossPercentage || Math.abs(stopLossPercentage));\n      setValue(\"stopLossPercentage\", format2Dec(newValue));\n      // todo: simulateInputChangeEvent\n    }\n  };\n\n  useEffect(updateStopLoss, [entryType, strategyPrice]);\n\n  return (\n    <Box className={`panel stopLossPanel ${expandClass}`}>\n      <Box alignItems=\"center\" className=\"panelHeader\" display=\"flex\" flexDirection=\"row\">\n        {!isClosed && (\n          <Switch checked={expanded} onChange={(e) => setExpanded(e.target.checked)} size=\"small\" />\n        )}\n        <Box alignItems=\"center\" className=\"title\" display=\"flex\" flexDirection=\"row\">\n          <Typography variant=\"h5\">\n            <FormattedMessage id=\"terminal.stoploss\" />\n          </Typography>\n          <input name=\"unrealizedProfitLossesPercentage\" ref={register} type=\"hidden\" />\n        </Box>\n      </Box>\n      {expanded && (\n        <Box\n          className=\"panelContent\"\n          display=\"flex\"\n          flexDirection=\"row\"\n          flexWrap=\"wrap\"\n          justifyContent=\"space-around\"\n        >\n          <Box className=\"stopLoss\">\n            <PricePercentageControl\n              disabled={isReadOnly}\n              labelDescriptionId=\"terminal.stoploss.help\"\n              labelId=\"terminal.stoploss\"\n              percentage={{\n                name: \"stopLossPercentage\",\n                validate: validateStopLossPercentageLimits,\n                onChange: stopLossPercentageChange,\n                allowNegative: true,\n              }}\n              price={{\n                name: \"stopLossPrice\",\n                onChange: stopLossPriceChange,\n                error: formatMessage({ id: \"terminal.stoploss.limit.zero\" }),\n              }}\n              priorityName=\"stopLossPriority\"\n              quote={symbolData.quote}\n              status={\n                positionEntity &&\n                positionEntity.exchangeType === \"futures\" &&\n                [\"binance\", \"zignaly\"].includes(positionEntity.exchange.toLowerCase()) &&\n                positionEntity.stopLossPercentage ? (\n                  <StopLossStatus orderId={positionEntity.stopLossOrderId} />\n                ) : (\n                  <span />\n                )\n              }\n            />\n          </Box>\n          <Box alignItems=\"center\" className=\"title\" display=\"flex\" flexDirection=\"row\" mt=\"12px\">\n            <FormHelperText>\n              <FormattedMessage id=\"terminal.stoploss.type\" />\n            </FormHelperText>\n            <Controller\n              as={\n                <CustomSelect\n                  disabled={fieldsDisabled.stopLossType}\n                  label=\"\"\n                  onChange={() => {}}\n                  options={stopLossTypeOptions}\n                />\n              }\n              control={control}\n              defaultValue={type}\n              name=\"stopLossType\"\n            />\n          </Box>\n        </Box>\n      )}\n    </Box>\n  );\n};\n\nexport default React.memo(StopLossPanel);\n","import React, { useEffect } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport HelperLabel from \"../HelperLabel/HelperLabel\";\nimport { Box, Typography, Switch } from \"@material-ui/core\";\nimport { formatPrice, format2Dec } from \"../../../utils/formatters\";\nimport { useFormContext } from \"react-hook-form\";\nimport useExpandable from \"../../../hooks/useExpandable\";\nimport useSymbolLimitsValidate from \"../../../hooks/useSymbolLimitsValidate\";\nimport usePositionEntry from \"../../../hooks/usePositionEntry\";\nimport \"./TrailingStopPanel.scss\";\nimport useValidation from \"../../../hooks/useValidation\";\nimport PricePercentageControl from \"../Controls/PricePercentageControl\";\nimport CustomNumberInput from \"components/Forms/CustomNumberInput\";\nimport usePositionSizeHandlers from \"hooks/usePositionSizeHandlers\";\n\n/**\n * @typedef {import(\"services/tradeApiClient.types\").MarketSymbol} MarketSymbol\n */\n\n/**\n * @typedef {Object} TrailingStopPanel\n * @property {MarketSymbol} symbolData\n * @property {Position} [positionEntity] Position entity (optional) for position edit trading view.\n * @property {boolean} [isReadOnly] Flag to disable edition.\n */\n\n/**\n * Manual trading trailing stop panel component.\n *\n * @param {TrailingStopPanel} props Component props.\n * @returns {JSX.Element} Trailing stop panel element.\n */\nconst TrailingStopPanel = (props) => {\n  const { symbolData, positionEntity, isReadOnly = false } = props;\n  const existsTrailingStop = positionEntity\n    ? Boolean(positionEntity.trailingStopPercentage)\n    : false;\n  const { expanded, expandClass, setExpanded } = useExpandable(existsTrailingStop);\n  const {\n    clearErrors,\n    errors,\n    getValues,\n    trigger,\n    setValue,\n    watch,\n    formState: { dirtyFields },\n  } = useFormContext();\n  const initTrailingStopDistance = positionEntity ? positionEntity.trailingStopPercentage : 0;\n  const trailingStopDistanceRaw = watch(\"trailingStopDistance\", initTrailingStopDistance);\n  const trailingStopDistance = parseFloat(trailingStopDistanceRaw);\n  const initTrailingStopPercentage = positionEntity\n    ? positionEntity.trailingStopTriggerPercentage\n    : 0;\n  const trailingStopPercentageRaw = watch(\"trailingStopPercentage\", initTrailingStopPercentage);\n  const trailingStopPercentage = parseFloat(trailingStopPercentageRaw);\n  const { validateTargetPriceLimits } = useSymbolLimitsValidate(symbolData);\n  const { lessThan, greaterThan } = useValidation();\n  const { getEntryPrice, getEntrySizeQuote } = usePositionEntry(positionEntity);\n  const entrySizeQuote = getEntrySizeQuote();\n  const isClosed = positionEntity ? positionEntity.closed : false;\n  const entryType = positionEntity ? positionEntity.side : watch(\"entryType\");\n  const strategyPrice = watch(\"price\");\n  const { validateSellAmount } = usePositionSizeHandlers(symbolData);\n\n  const getFieldsDisabledStatus = () => {\n    const isTriggered = positionEntity ? positionEntity.trailingStopTriggered : false;\n\n    /**\n     * @type {Object<string, boolean>}\n     */\n    const fieldsDisabled = {};\n\n    fieldsDisabled.trailingStopPercentage = isReadOnly || isTriggered;\n    fieldsDisabled.trailingStopPrice = isReadOnly || isTriggered;\n    fieldsDisabled.trailingStopDistance = isReadOnly;\n\n    return fieldsDisabled;\n  };\n\n  const fieldsDisabled = getFieldsDisabledStatus();\n\n  /**\n   * Validate target percentage limits.\n   *\n   * @param {string} value stopLossPercentage\n   * @returns {boolean|string} true if validation pass, error message otherwise.\n   */\n  const validatePercentage = (value) => {\n    const stopLossPercentage = parseFloat(value);\n\n    let valid = true;\n    if (positionEntity) {\n      greaterThan(value, 0, entryType, \"terminal.trailingstop.valid.percentage\", {\n        value: 0,\n      });\n    }\n\n    if (valid === true) {\n      if (stopLossPercentage && entrySizeQuote) {\n        const amountSoldTrigger = (entrySizeQuote * (100 + stopLossPercentage)) / 100;\n        const amountSold = (amountSoldTrigger * (100 + trailingStopDistance)) / 100;\n        // @ts-ignore\n        valid = validateSellAmount(amountSold);\n      }\n    }\n\n    return valid;\n  };\n\n  useEffect(() => {\n    trigger(\"trailingStopPercentage\");\n  }, [entrySizeQuote, trailingStopDistance]);\n\n  /**\n   * Calculate price based on percentage when value is changed.\n   *\n   * @return {Void} None.\n   */\n  const trailingStopPercentageChange = () => {\n    const price = getEntryPrice();\n\n    if (price > 0) {\n      // Update trailing stop price\n      const draftPosition = getValues();\n      const newTrailingStopPercentage = parseFloat(draftPosition.trailingStopPercentage);\n      const trailingStopPrice = (price * (100 + newTrailingStopPercentage)) / 100;\n      setValue(\"trailingStopPrice\", formatPrice(trailingStopPrice, \"\", \"\"));\n    } else {\n      setValue(\"trailingStopPrice\", \"\");\n    }\n\n    trigger(\"trailingStopPrice\");\n  };\n\n  /**\n   * Calculate percentage based on price when value is changed.\n   *\n   * @return {Void} None.\n   */\n  const trailingStopPriceChange = () => {\n    const draftPosition = getValues();\n    const price = getEntryPrice();\n    const trailingStopPrice = parseFloat(draftPosition.trailingStopPrice);\n    const priceDiff = trailingStopPrice - price;\n\n    if (!isNaN(priceDiff) && priceDiff !== 0) {\n      // Update trailing stop percentage\n      const newTrailingStopPercentage = (priceDiff / price) * 100;\n      setValue(\"trailingStopPercentage\", format2Dec(newTrailingStopPercentage));\n    } else {\n      setValue(\"trailingStopPercentage\", \"\");\n    }\n\n    trigger(\"trailingStopPercentage\");\n  };\n\n  const chainedPriceUpdates = () => {\n    if (expanded) {\n      const newPercentage = format2Dec(Math.abs(trailingStopPercentage));\n      const newDistance = format2Dec(Math.abs(trailingStopDistance));\n      const percentageSign = entryType === \"SHORT\" ? \"-\" : \"\";\n      const distanceSign = entryType === \"SHORT\" ? \"\" : \"-\";\n\n      if (!trailingStopDistance) {\n        setValue(\"trailingStopDistance\", distanceSign);\n      } else {\n        setValue(\"trailingStopDistance\", `${distanceSign}${newDistance}`);\n        if (dirtyFields.trailingStopDistance) {\n          trigger(\"trailingStopDistance\");\n        }\n      }\n\n      if (!trailingStopPercentage) {\n        setValue(\"trailingStopPercentage\", percentageSign);\n      } else {\n        setValue(\"trailingStopPercentage\", `${percentageSign}${newPercentage}`);\n        if (positionEntity) {\n          setValue(\"trailingStopPrice\", positionEntity.trailingStopTriggerPrice);\n          setValue(\"trailingStopTriggerPriority\", positionEntity.trailingStopTriggerPriority);\n        }\n      }\n    } else {\n      setValue(\"trailingStopPrice\", \"\");\n      if (errors.trailingStopPercentage) {\n        clearErrors(\"trailingStopPercentage\");\n      }\n\n      if (errors.trailingStopPrice) {\n        clearErrors(\"trailingStopPrice\");\n      }\n    }\n  };\n\n  useEffect(chainedPriceUpdates, [expanded, entryType, strategyPrice]);\n\n  /**\n   * Display property errors.\n   *\n   * @param {string} propertyName Property name to display errors for.\n   * @returns {JSX.Element|null} Errors JSX element.\n   */\n  const displayFieldErrors = (propertyName) => {\n    if (errors[propertyName]) {\n      return <span className=\"errorText\">{errors[propertyName].message}</span>;\n    }\n\n    return null;\n  };\n\n  //   const initTrailingStopLoss = () => {\n  //     if (expanded) {\n  //     } else {\n  //       setValue(\"trailingStopPrice\", \"\");\n  //       if (errors.trailingStopPercentage) {\n  //         clearErrors(\"trailingStopPercentage\");\n  //       }\n\n  //       if (errors.trailingStopPrice) {\n  //         clearErrors(\"trailingStopPrice\");\n  //       }\n  //     }\n  //   };\n  //   useEffect(initTrailingStopLoss, [expanded]);\n\n  return (\n    <Box className={`panel trailingStopPanel ${expandClass}`}>\n      <Box alignItems=\"center\" className=\"panelHeader\" display=\"flex\" flexDirection=\"row\">\n        {!isClosed && (\n          <Switch checked={expanded} onChange={(e) => setExpanded(e.target.checked)} size=\"small\" />\n        )}\n        <Box alignItems=\"center\" className=\"title\" display=\"flex\" flexDirection=\"row\">\n          <Typography variant=\"h5\">\n            <FormattedMessage id=\"terminal.trailingstop\" />\n          </Typography>\n        </Box>\n      </Box>\n      {expanded && (\n        <Box\n          className=\"panelContent\"\n          display=\"flex\"\n          flexDirection=\"row\"\n          flexWrap=\"wrap\"\n          justifyContent=\"space-around\"\n        >\n          <PricePercentageControl\n            // defaultPriority={positionEntity ? positionEntity.trailingStopTriggerPriority : null}\n            disabled={fieldsDisabled.trailingStopPercentage}\n            labelDescriptionId=\"terminal.trailingstop.help\"\n            labelId=\"terminal.trailingstop\"\n            percentage={{\n              name: \"trailingStopPercentage\",\n              validate: validatePercentage,\n              onChange: trailingStopPercentageChange,\n              // allowNegative: entryType.toUpperCase() === \"SHORT\",\n              allowNegative: true,\n            }}\n            price={{\n              name: \"trailingStopPrice\",\n              onChange: trailingStopPriceChange,\n              validate: (value) => validateTargetPriceLimits(value, \"terminal.trailingstop.limit\"),\n            }}\n            priorityName=\"trailingStopTriggerPriority\"\n            quote={symbolData.quote}\n          />\n          <Box>\n            <HelperLabel descriptionId=\"terminal.distance.help\" labelId=\"terminal.distance\" />\n            <Box alignItems=\"center\" display=\"flex\">\n              <CustomNumberInput\n                allowNegative={true}\n                disabled={fieldsDisabled.trailingStopDistance}\n                name=\"trailingStopDistance\"\n                rules={{\n                  validate: (value) =>\n                    lessThan(parseFloat(value), 0, entryType, \"terminal.trailingstop.limit.zero\"),\n                }}\n                showErrorMessage={false}\n              />\n              <div className=\"currencyBox\">%</div>\n            </Box>\n            {displayFieldErrors(\"trailingStopDistance\")}\n          </Box>\n        </Box>\n      )}\n    </Box>\n  );\n};\n\nexport default React.memo(TrailingStopPanel);\n","import { useState, useEffect } from \"react\";\nimport tradeApi from \"../services/tradeApiClient\";\nimport useSelectedExchange from \"hooks/useSelectedExchange\";\nimport { useIntl } from \"react-intl\";\nimport { useDispatch } from \"react-redux\";\nimport { showErrorAlert } from \"store/actions/ui\";\n\n/**\n * @typedef {import(\"services/tradeApiClient.types\").CopyTradersProvidersOption} CopyTradersProvidersOption\n */\n\n/**\n * @typedef {Object} HookData\n * @property {Array<CopyTradersProvidersOption>} ownCopyTraderProviders\n * @property {Boolean} loading\n */\n\n/**\n * Provides list of copy trader providers.\n *\n * @param {string} [exchangeInternalId] exchangeInternalId\n * @returns {HookData} Balance.\n */\nconst useOwnCopyTraderProviders = (exchangeInternalId) => {\n  const [loading, setLoading] = useState(false);\n  const selectedExchange = useSelectedExchange();\n  const [ownCopyTraderProviders, setOwnCopyTradersProviders] = useState([]);\n  const { formatMessage } = useIntl();\n  const dispatch = useDispatch();\n\n  const loadOwnCopyTradersProviders = () => {\n    const payload = {\n      internalExchangeId: exchangeInternalId || selectedExchange.internalId,\n    };\n\n    setLoading(true);\n    tradeApi\n      .ownedCopyTradersProvidersOptions(payload)\n      .then((data) => {\n        if (Array.isArray(data)) {\n          // Digest providers data to handle translation.\n          const digestedProviders = data.map((provider) => {\n            if (provider.providerId === 1) {\n              return {\n                ...provider,\n                providerName: formatMessage({ id: \"terminal.provider.manual\" }),\n              };\n            }\n\n            return provider;\n          });\n\n          setOwnCopyTradersProviders(digestedProviders);\n        }\n      })\n      .catch((e) => {\n        dispatch(showErrorAlert(e));\n      })\n      .finally(() => {\n        setLoading(false);\n      });\n  };\n\n  useEffect(loadOwnCopyTradersProviders, [selectedExchange.internalId]);\n\n  return { ownCopyTraderProviders, loading };\n};\n\nexport default useOwnCopyTraderProviders;\n","import React, { useState, useEffect, useContext } from \"react\";\nimport { Box } from \"@material-ui/core\";\nimport CustomSelect from \"../../CustomSelect\";\nimport { useFormContext, Controller } from \"react-hook-form\";\nimport { useIntl, FormattedMessage } from \"react-intl\";\nimport useAvailableBalance from \"../../../hooks/useAvailableBalance\";\nimport {\n  FormHelperText,\n  FormControl,\n  Switch,\n  Typography,\n  CircularProgress,\n} from \"@material-ui/core\";\nimport HelperLabel from \"../HelperLabel/HelperLabel\";\nimport \"./IncreaseStrategyPanel.scss\";\nimport usePositionSizeHandlers from \"../../../hooks/usePositionSizeHandlers\";\nimport useOwnCopyTraderProviders from \"../../../hooks/useOwnCopyTraderProviders\";\nimport { formatPrice } from \"../../../utils/formatters\";\nimport { formatFloat2Dec } from \"../../../utils/format\";\nimport CustomNumberInput from \"components/Forms/CustomNumberInput\";\nimport useEffectSkipFirst from \"../../../hooks/useEffectSkipFirst\";\nimport TradingViewContext from \"../TradingView/TradingViewContext\";\nimport { useStoreUserExchangeConnections } from \"hooks/useStoreUserSelector\";\nimport PostOnlyControl from \"../Controls/PostOnlyControl/PostOnlyControl\";\nimport useSelectedExchange from \"hooks/useSelectedExchange\";\n\n/**\n * @typedef {import(\"services/tradeApiClient.types\").MarketSymbol} MarketSymbol\n */\n\n/**\n * @typedef {Object} StrategyPanelProps\n * @property {MarketSymbol} symbolData\n * @property {Position} positionEntity Position entity.\n */\n\n/**\n * Manual trading increase strategy panel component.\n *\n * @param {StrategyPanelProps} props Component props.\n * @returns {JSX.Element} Strategy panel element.\n */\nconst IncreaseStrategyPanel = (props) => {\n  const { symbolData, positionEntity } = props;\n  const [expand, setExpand] = useState(false);\n  const expandClass = expand ? \"expanded\" : \"collapsed\";\n  const { control, errors, register, watch, reset, getValues } = useFormContext();\n  const { formatMessage } = useIntl();\n  const selectedExchange = useSelectedExchange();\n  const {\n    positionSizeChange,\n    validateUnits,\n    priceChange,\n    realInvestmentChange,\n    unitsChange,\n    validatePositionSize,\n    positionSizePercentageChange,\n  } = usePositionSizeHandlers(symbolData, positionEntity.leverage);\n  const { balance, loading } = useAvailableBalance(selectedExchange);\n  const exchangeConnections = useStoreUserExchangeConnections();\n  const exchange = exchangeConnections.find(\n    (item) => item.internalId === positionEntity.internalExchangeId,\n  );\n  const { loading: loadingProviders, ownCopyTraderProviders } = useOwnCopyTraderProviders(\n    exchange ? exchange.internalId : \"\",\n  );\n  const baseBalance = (balance && balance[symbolData.base]) || 0;\n  const quoteBalance = (balance && balance[symbolData.quote]) || 0;\n  const entryStrategy = watch(\"entryStrategy\", \"limit\");\n  const { lastPrice, updatedAt, providerService, setProviderService } =\n    useContext(TradingViewContext);\n  const providerAllocatedBalance = providerService ? providerService.providerPayableBalance : 0;\n  const providerConsumedBalance = providerService ? providerService.providerConsumedBalance : 0;\n  const providerConsumedBalancePercentage = providerService\n    ? providerService.providerConsumedBalancePercentage\n    : 0;\n\n  /**\n   * Handle toggle switch action.\n   *\n   * @param {React.ChangeEvent<HTMLInputElement>} event Click event.\n   * @returns {Void} None.\n   */\n  const handleToggle = (event) => {\n    const targetElement = event.currentTarget;\n    setExpand(targetElement.checked);\n  };\n\n  const entryStrategyOptions = [\n    { label: formatMessage({ id: \"terminal.strategy.limit\" }), val: \"limit\" },\n    { label: formatMessage({ id: \"terminal.strategy.market\" }), val: \"market\" },\n    { label: formatMessage({ id: \"terminal.strategy.stoplimit\" }), val: \"stop_limit\" },\n  ];\n\n  // Close panel on position update\n  useEffect(() => {\n    if (updatedAt) {\n      setExpand(false);\n    }\n  }, [updatedAt]);\n\n  const emptyFieldsWhenCollapsed = () => {\n    if (!expand) {\n      reset({\n        ...getValues(),\n        stopPrice: \"\",\n        price: \"\",\n        realInvestment: \"\",\n        positionSize: \"\",\n        positionSizePercentage: \"\",\n        units: \"\",\n      });\n    }\n  };\n  useEffectSkipFirst(emptyFieldsWhenCollapsed, [expand]);\n\n  useEffect(() => {\n    // Update current provider service to context\n    if (!ownCopyTraderProviders) return;\n\n    const provider = ownCopyTraderProviders.find((p) => p.providerId === positionEntity.providerId);\n    setProviderService(provider);\n  }, [ownCopyTraderProviders]);\n\n  const isCopyTrader = positionEntity ? positionEntity.isCopyTrader : false;\n\n  return (\n    <Box className={`panel strategyPanel ${expandClass}`}>\n      <Box alignItems=\"center\" className=\"panelHeader\" display=\"flex\" flexDirection=\"row\">\n        <Switch checked={expand} onChange={handleToggle} size=\"small\" />\n        <Typography variant=\"h5\">\n          <FormattedMessage id=\"terminal.increasestrategy\" />\n        </Typography>\n      </Box>\n      {expand && (\n        <Box className=\"panelContent\" display=\"flex\" flexDirection=\"row\" flexWrap=\"wrap\">\n          <FormControl className=\"entryType\">\n            <HelperLabel\n              descriptionId=\"terminal.increasestrategy.help\"\n              labelId=\"terminal.entrytype\"\n            />\n            <Controller\n              as={<CustomSelect label=\"\" onChange={() => {}} options={entryStrategyOptions} />}\n              control={control}\n              defaultValue=\"limit\"\n              name=\"entryStrategy\"\n            />\n          </FormControl>\n          {entryStrategy === \"stop_limit\" && (\n            <FormControl>\n              <HelperLabel descriptionId=\"terminal.stopprice.help\" labelId=\"terminal.stopprice\" />\n              <Box alignItems=\"center\" display=\"flex\">\n                <CustomNumberInput name=\"stopPrice\" />\n                <div className=\"currencyBox\">{symbolData.quote}</div>\n              </Box>\n            </FormControl>\n          )}\n          {entryStrategy !== \"market\" ? (\n            <FormControl>\n              <HelperLabel descriptionId=\"terminal.price.help\" labelId=\"terminal.price\" />\n              <Box alignItems=\"center\" display=\"flex\">\n                <CustomNumberInput\n                  defaultValue={lastPrice}\n                  name=\"price\"\n                  onChange={priceChange}\n                  rules={{\n                    validate: (value) => !isNaN(value) && parseFloat(value) > 0,\n                  }}\n                  showErrorMessage={false}\n                />\n                <div className=\"currencyBox\">{symbolData.quote}</div>\n              </Box>\n              {errors.price && <span className=\"errorText\">{errors.price.message}</span>}\n            </FormControl>\n          ) : (\n            <input defaultValue={lastPrice} name=\"price\" ref={register} type=\"hidden\" />\n          )}\n          {positionEntity.exchangeType === \"futures\" && !positionEntity.isCopyTrader && (\n            <FormControl>\n              <HelperLabel descriptionId=\"terminal.realinvest.help\" labelId=\"terminal.realinvest\" />\n              <Box alignItems=\"center\" display=\"flex\">\n                <CustomNumberInput\n                  name=\"realInvestment\"\n                  onChange={realInvestmentChange}\n                  placeholder={\"0\"}\n                  rules={{\n                    validate: (value) => !isNaN(value) && parseFloat(value) >= 0,\n                  }}\n                  showErrorMessage={false}\n                />\n                <div className=\"currencyBox\">{symbolData.unitsInvestment}</div>\n              </Box>\n              <FormHelperText>\n                <FormattedMessage id=\"terminal.available\" />{\" \"}\n                {loading ? (\n                  <CircularProgress color=\"primary\" size={20} />\n                ) : (\n                  <span className=\"balance\">{quoteBalance}</span>\n                )}\n              </FormHelperText>\n            </FormControl>\n          )}\n          {!isCopyTrader && (\n            <FormControl>\n              <HelperLabel\n                descriptionId=\"terminal.position.size.help\"\n                labelId=\"terminal.position.size\"\n              />\n              <Box alignItems=\"center\" display=\"flex\">\n                <CustomNumberInput\n                  name=\"positionSize\"\n                  onChange={positionSizeChange}\n                  placeholder={\"0\"}\n                  rules={{\n                    validate: validatePositionSize,\n                  }}\n                  showErrorMessage={false}\n                />\n                <div className=\"currencyBox\">{symbolData.unitsInvestment}</div>\n              </Box>\n              <FormHelperText>\n                <FormattedMessage id=\"terminal.available\" />{\" \"}\n                {loading ? (\n                  <CircularProgress color=\"primary\" size={20} />\n                ) : (\n                  <span className=\"balance\">{quoteBalance}</span>\n                )}\n              </FormHelperText>\n              {errors.positionSize && (\n                <span className=\"errorText\">{errors.positionSize.message}</span>\n              )}\n            </FormControl>\n          )}\n          {isCopyTrader && (\n            <>\n              <HelperLabel\n                descriptionId=\"terminal.position.sizepercentage.help\"\n                labelId=\"terminal.position.sizepercentage\"\n              />\n              <Box className=\"positionSizePercentage\" display=\"flex\" flexDirection=\"row\">\n                <Box display=\"flex\" flexDirection=\"row\">\n                  <CustomNumberInput\n                    name=\"positionSizePercentage\"\n                    onChange={positionSizePercentageChange}\n                    placeholder={\"0\"}\n                    rules={{\n                      required: formatMessage({ id: \"terminal.positionsize.percentage.required\" }),\n                      validate: (value) =>\n                        (value > 0 && value <= 100) ||\n                        formatMessage({ id: \"terminal.positionsize.valid.percentage\" }),\n                    }}\n                    showErrorMessage={false}\n                  />\n                  <div className=\"currencyBox\">%</div>\n                </Box>\n                <Box display=\"flex\" flexDirection=\"row\">\n                  <CustomNumberInput\n                    name=\"positionSizeAllocated\"\n                    placeholder={\"0\"}\n                    readOnly={true}\n                  />\n                  <div className=\"currencyBox\">{symbolData.unitsInvestment}</div>\n                </Box>\n              </Box>\n              <FormHelperText>\n                <FormattedMessage id=\"terminal.provider.allocated\" />{\" \"}\n                {loadingProviders ? (\n                  <CircularProgress color=\"primary\" size={20} />\n                ) : (\n                  <span className=\"balance\">{formatPrice(providerAllocatedBalance)} </span>\n                )}\n                <FormattedMessage id=\"terminal.provider.consumed\" />{\" \"}\n                {!loadingProviders && (\n                  <span className=\"balance\">{formatPrice(providerConsumedBalance)} </span>\n                )}\n                <FormattedMessage id=\"terminal.provider.available\" />{\" \"}\n                {!loadingProviders && (\n                  <span className=\"balance\">\n                    {formatFloat2Dec(100 - providerConsumedBalancePercentage)}%\n                  </span>\n                )}\n              </FormHelperText>\n              {errors.positionSizePercentage && (\n                <span className=\"errorText\">{errors.positionSizePercentage.message}</span>\n              )}\n            </>\n          )}\n          {!isCopyTrader && (\n            <FormControl>\n              <HelperLabel descriptionId=\"terminal.units.help\" labelId=\"terminal.units\" />\n              <Box alignItems=\"center\" display=\"flex\">\n                <CustomNumberInput\n                  name=\"units\"\n                  onChange={unitsChange}\n                  placeholder={\"0\"}\n                  rules={{\n                    validate: validateUnits,\n                  }}\n                  showErrorMessage={false}\n                />\n                <div className=\"currencyBox\">{symbolData.unitsAmount}</div>\n              </Box>\n              <FormHelperText>\n                <FormattedMessage id=\"terminal.available\" />{\" \"}\n                {loading ? (\n                  <CircularProgress color=\"primary\" size={15} />\n                ) : (\n                  <span className=\"balance\">{baseBalance}</span>\n                )}\n              </FormHelperText>\n              {errors.units && <span className=\"errorText\">{errors.units.message}</span>}\n            </FormControl>\n          )}\n          {[\"limit\", \"stop_limit\"].includes(entryStrategy) && (\n            <Box alignItems=\"center\" display=\"flex\" flexDirection=\"row\" justifyContent=\"start\">\n              <PostOnlyControl exchange={positionEntity?.exchange} />\n            </Box>\n          )}\n        </Box>\n      )}\n    </Box>\n  );\n};\n\nexport default React.memo(IncreaseStrategyPanel);\n","import React, { useEffect } from \"react\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\nimport { size, values } from \"lodash\";\nimport HelperLabel from \"../HelperLabel/HelperLabel\";\nimport {\n  Button,\n  Box,\n  Typography,\n  FormControlLabel,\n  Checkbox,\n  FormHelperText,\n  Tooltip,\n  Switch,\n} from \"@material-ui/core\";\nimport CustomNumberInput from \"components/Forms/CustomNumberInput\";\nimport { RemoveCircle, Help } from \"@material-ui/icons\";\nimport { useFormContext, Controller } from \"react-hook-form\";\nimport useExpandable from \"../../../hooks/useExpandable\";\nimport \"./ReduceOrders.scss\";\nimport { colors } from \"../../../services/theme\";\nimport { formatFloat2Dec } from \"../../../utils/format\";\nimport { formatPrice } from \"../../../utils/formatters\";\n\n/**\n * @typedef {Object} ReduceOrderStatusProps\n * @property {string} labelId Status label translation text ID.\n * @property {ReduceOrder} order Position reduce order.\n */\n\n/**\n * Orders status label with detailed description tooltip.\n *\n * @param {ReduceOrderStatusProps} props Component props.\n * @returns {JSX.Element} Helper label with description in tooltip element.\n */\nconst ReduceOrderStatus = (props) => {\n  const { order, labelId } = props;\n  const { formatMessage } = useIntl();\n  let iconColor = colors.darkGrey;\n  let description = formatMessage({ id: \"terminal.status.pending\" });\n\n  if (!order.done && order.orderId) {\n    description = formatMessage({ id: \"terminal.status.placed\" }, { orderId: order.orderId });\n    iconColor = colors.blue;\n  } else if (order.done && order.orderId) {\n    description = formatMessage({ id: \"terminal.status.done\" });\n    iconColor = colors.green;\n  } else if (order.errorMSG) {\n    description = order.errorMSG;\n    iconColor = colors.red;\n  }\n\n  return (\n    <Box alignItems=\"center\" className=\"targetStatus\" display=\"flex\" justifyContent=\"flex-end\">\n      <FormHelperText>\n        <FormattedMessage id={labelId} />\n      </FormHelperText>\n      <Tooltip arrow enterTouchDelay={50} placement=\"left-end\" title={description}>\n        <Help style={{ fill: iconColor }} />\n      </Tooltip>\n    </Box>\n  );\n};\n\n/**\n * @typedef {Object} ReduceOrdersProps\n * @property {Position} positionEntity Position entity for position edit trading view.\n * @property {boolean} [isReadOnly] Flag to disable edition.\n */\n\n/**\n * Manual trading reduce orders panel component.\n *\n * @param {ReduceOrdersProps} props Component props.\n * @returns {JSX.Element} Reduce Orders panel element.\n */\nconst ReduceOrders = (props) => {\n  const { positionEntity, isReadOnly = false } = props;\n  const { setValue, watch, control, register, unregister } = useFormContext();\n  const reduceOrders = values(positionEntity.reduceOrders);\n  const { expanded, expandClass, setExpanded } = useExpandable(size(reduceOrders) > 0);\n  const isClosed = positionEntity ? positionEntity.closed : false;\n\n  /**\n   * @type {Array<number>}\n   */\n  const removeReduceOrder = watch(\"removeReduceOrder\", []);\n  const isRecurringPersistent = Boolean(\n    reduceOrders.find(\n      (o) => (o.recurring || o.persistent) && !removeReduceOrder.includes(o.targetId),\n    ),\n  );\n\n  const removeAllReduceOrders = () => {\n    if (!expanded) {\n      const ids = reduceOrders.map((o) => o.targetId);\n      setValue(\"removeReduceOrder\", ids);\n    }\n  };\n\n  useEffect(removeAllReduceOrders, [expanded]);\n\n  /**\n   * Remove reduce order\n   * @param {number} targetId targetId\n   * @returns {void}\n   */\n  const handleRemoveReduceOrder = (targetId) => {\n    const newRemoveReduceOrder = removeReduceOrder.concat(targetId);\n    setValue(\"removeReduceOrder\", newRemoveReduceOrder);\n  };\n\n  // Register special form element to store removed orders\n  useEffect(() => {\n    register(\"removeReduceOrder\");\n    return () => unregister(\"removeReduceOrder\");\n  }, [register, unregister]);\n\n  // Automatically expand/collpase panel depending on current reduce orders amount.\n  const autoExpandCollapse = () => {\n    setExpanded(Boolean(reduceOrders.length));\n  };\n  useEffect(autoExpandCollapse, [reduceOrders.length]);\n\n  /**\n   * Render a reduce order\n   * @param {ReduceOrder} order Reduce order\n   * @returns {JSX.Element} JSX\n   */\n  const displayReduceOrder = (order) => {\n    if (removeReduceOrder.find((i) => i === order.targetId)) {\n      return null;\n    }\n\n    const showRemove = !order.done && !isReadOnly;\n    return (\n      <Box className=\"targetGroup\" key={order.targetId}>\n        <Box className=\"targetPrice\" display=\"flex\" flexDirection=\"row\" flexWrap=\"wrap\">\n          <HelperLabel\n            descriptionId=\"terminal.reducestrategy.targetpercentage.help\"\n            labelId=\"terminal.target\"\n          />\n          <ReduceOrderStatus labelId=\"terminal.status\" order={order} />\n          <Box alignItems=\"center\" className=\"percentageBox\" display=\"flex\">\n            <CustomNumberInput\n              disabled={true}\n              name=\"\"\n              value={formatFloat2Dec(order.targetPercentage)}\n            />\n            <div className=\"currencyBox\">%</div>\n          </Box>\n          <Box alignItems=\"center\" className=\"valueBox\" display=\"flex\">\n            <CustomNumberInput disabled={true} name=\"\" value={formatPrice(order.price)} />\n            <div className=\"currencyBox\">{positionEntity.quote}</div>\n          </Box>\n        </Box>\n        <Box className=\"targetUnits\" display=\"flex\" flexDirection=\"row\" flexWrap=\"wrap\">\n          <HelperLabel\n            descriptionId=\"terminal.reducestrategy.availablePercentage.help\"\n            labelId=\"terminal.reducestrategy.availablePercentage\"\n          />\n          <Box alignItems=\"center\" className=\"percentageBox\" display=\"flex\">\n            <CustomNumberInput\n              disabled={true}\n              name=\"\"\n              value={formatFloat2Dec(order.availablePercentage)}\n            />\n            <div className=\"currencyBox\">%</div>\n          </Box>\n          <Box alignItems=\"center\" className=\"valueBox\" display=\"flex\">\n            <CustomNumberInput disabled={true} name=\"\" value={formatPrice(order.amount)} />\n            <div className=\"currencyBox\">{positionEntity.base}</div>\n          </Box>\n        </Box>\n        {showRemove && (\n          <Box className=\"targetActions\" display=\"flex\" flexDirection=\"row\" flexWrap=\"wrap\">\n            <Button\n              className=\"removeTarget\"\n              onClick={() => handleRemoveReduceOrder(order.targetId)}\n            >\n              <RemoveCircle />\n              <FormattedMessage id=\"terminal.target.remove\" />\n            </Button>\n          </Box>\n        )}\n      </Box>\n    );\n  };\n\n  return (\n    <Box className={`panel reduceOrders ${expandClass}`}>\n      <Box alignItems=\"center\" className=\"panelHeader\" display=\"flex\" flexDirection=\"row\">\n        {!isClosed && (\n          <Switch checked={expanded} onChange={(e) => setExpanded(e.target.checked)} size=\"small\" />\n        )}\n        <Box alignItems=\"center\" className=\"title\" display=\"flex\" flexDirection=\"row\">\n          <Typography variant=\"h5\">\n            <FormattedMessage id=\"terminal.reduceorders\" />\n          </Typography>\n        </Box>\n      </Box>\n      {expanded && (\n        <Box\n          className=\"panelContent\"\n          display=\"flex\"\n          flexDirection=\"row\"\n          flexWrap=\"wrap\"\n          justifyContent=\"space-around\"\n        >\n          {reduceOrders.map((order) => displayReduceOrder(order))}\n          <Box className=\"targetActions\" display=\"flex\" flexDirection=\"row\" flexWrap=\"wrap\">\n            {isRecurringPersistent && (\n              <FormControlLabel\n                className=\"customCheckbox\"\n                control={\n                  <Controller\n                    control={control}\n                    defaultValue={true}\n                    name=\"reduceRecurringPersistent\"\n                    render={({ onChange, value }) => (\n                      <Checkbox checked={value} onChange={(e) => onChange(e.target.checked)} />\n                    )}\n                  />\n                }\n                label={<FormattedMessage id=\"terminal.reducestrategy.persistentrecurring\" />}\n              />\n            )}\n          </Box>\n        </Box>\n      )}\n    </Box>\n  );\n};\n\nexport default React.memo(ReduceOrders);\n","import React, { useState, useEffect, useContext } from \"react\";\nimport CustomSelect from \"../../CustomSelect\";\nimport { useFormContext, Controller } from \"react-hook-form\";\nimport { useIntl, FormattedMessage } from \"react-intl\";\nimport {\n  FormHelperText,\n  Typography,\n  Checkbox,\n  FormControlLabel,\n  Switch,\n  Box,\n} from \"@material-ui/core\";\nimport CustomNumberInput from \"components/Forms/CustomNumberInput\";\nimport HelperLabel from \"../HelperLabel/HelperLabel\";\nimport \"./ReduceStrategyPanel.scss\";\nimport usePositionEntry from \"../../../hooks/usePositionEntry\";\nimport useEffectSkipFirst from \"../../../hooks/useEffectSkipFirst\";\nimport { formatPrice } from \"../../../utils/formatters\";\nimport useValidation from \"../../../hooks/useValidation\";\nimport { Alert } from \"@material-ui/lab\";\nimport TradingViewContext from \"../TradingView/TradingViewContext\";\nimport PostOnlyControl from \"../Controls/PostOnlyControl/PostOnlyControl\";\n\n/**\n * @typedef {import(\"services/tradeApiClient.types\").MarketSymbol} MarketSymbol\n */\n\n/**\n * @typedef {Object} StrategyPanelProps\n * @property {MarketSymbol} symbolData\n * @property {Position} positionEntity Position entity.\n */\n\n/**\n * Manual trading reduce strategy panel component.\n *\n * @param {StrategyPanelProps} props Component props.\n * @returns {JSX.Element} Strategy panel element.\n */\nconst ReduceStrategyPanel = (props) => {\n  const { symbolData, positionEntity } = props;\n  const [expand, setExpand] = useState(false);\n  const expandClass = expand ? \"expanded\" : \"collapsed\";\n  const { control, errors, watch, getValues, setValue, reset } = useFormContext();\n  const { formatMessage } = useIntl();\n  const { getEntryPrice } = usePositionEntry(positionEntity);\n  const [reduceTargetPrice, setReduceTargetPrice] = useState(\"\");\n  const [reduceTargetUnits, setReduceTargetUnits] = useState(\"\");\n  const { validPercentage } = useValidation();\n  const { updatedAt } = useContext(TradingViewContext);\n  const amount = positionEntity.remainAmount;\n\n  /**\n   * Handle toggle switch action.\n   *\n   * @param {React.ChangeEvent<HTMLInputElement>} event Click event.\n   * @returns {Void} None.\n   */\n  const handleToggle = (event) => {\n    const targetElement = event.currentTarget;\n    setExpand(targetElement.checked);\n  };\n\n  /**\n   * Validate target percentage and update price.\n   *\n   * @returns {void}\n   */\n  const reduceTargetPercentageChange = () => {\n    const entryPrice = getEntryPrice();\n    const draftPosition = getValues();\n    const reduceTargetPercentage = parseFloat(draftPosition.reduceTargetPercentage);\n\n    const targetPrice = entryPrice + (reduceTargetPercentage / 100) * entryPrice;\n    setReduceTargetPrice(formatPrice(targetPrice.toString()));\n  };\n\n  /**\n   * Validate units percentage and update units quantity.\n   *\n   * @returns {void}\n   */\n  const reduceAvailablePercentageChange = () => {\n    if (errors.reduceAvailablePercentage) return;\n\n    const draftPosition = getValues();\n    const reduceAvailablePercentage = parseFloat(draftPosition.reduceAvailablePercentage);\n\n    const targetUnits = (reduceAvailablePercentage / 100) * amount;\n    setReduceTargetUnits(targetUnits.toString());\n  };\n\n  // Watched inputs that affect components.\n  const reduceRecurring = watch(\"reduceRecurring\");\n  const reduceOrderType = watch(\"reduceOrderType\", \"limit\");\n\n  // Close panel on position update\n  useEffect(() => {\n    if (updatedAt) {\n      setExpand(false);\n    }\n  }, [updatedAt]);\n\n  const emptyFieldsWhenCollapsed = () => {\n    if (!expand) {\n      reset({\n        ...getValues(),\n        reduceOrderType: \"\",\n        reduceTargetPercentage: \"\",\n        reduceAvailablePercentage: \"\",\n        reduceRecurring: \"\",\n        reducePersistent: \"\",\n      });\n      setReduceTargetUnits(\"\");\n    }\n  };\n  useEffectSkipFirst(emptyFieldsWhenCollapsed, [expand]);\n\n  const orderTypeOptions = [\n    {\n      label: formatMessage({ id: \"terminal.strategy.limit\" }),\n      val: \"limit\",\n    },\n  ];\n\n  if (!reduceRecurring) {\n    orderTypeOptions.push({\n      label: formatMessage({ id: \"terminal.strategy.market\" }),\n      val: \"market\",\n    });\n  }\n\n  return (\n    <Box className={`panel reduceStrategyPanel ${expandClass}`}>\n      <Box alignItems=\"center\" className=\"panelHeader\" display=\"flex\" flexDirection=\"row\">\n        <Switch checked={expand} onChange={handleToggle} size=\"small\" />\n        <Typography variant=\"h5\">\n          <FormattedMessage id=\"terminal.reducestrategy\" />\n        </Typography>\n      </Box>\n      {expand && (\n        <Box className=\"panelContent\" display=\"flex\" flexDirection=\"row\" flexWrap=\"wrap\">\n          <Alert className=\"tpsWarning\" severity=\"warning\">\n            <FormattedMessage id=\"terminal.reducestrategy.tpwarning\" />\n          </Alert>\n          <HelperLabel descriptionId=\"terminal.reducestrategy.help\" labelId=\"terminal.entrytype\" />\n          <Controller\n            as={<CustomSelect label=\"\" onChange={() => {}} options={orderTypeOptions} />}\n            control={control}\n            defaultValue=\"limit\"\n            name=\"reduceOrderType\"\n          />\n\n          {reduceOrderType !== \"market\" && (\n            <Box className=\"targetPrice\" display=\"flex\" flexDirection=\"row\" flexWrap=\"wrap\">\n              <HelperLabel\n                descriptionId=\"terminal.reducestrategy.targetpercentage.help\"\n                labelId=\"terminal.target\"\n              />\n              <Box alignItems=\"center\" display=\"flex\">\n                <CustomNumberInput\n                  allowNegative={true}\n                  name=\"reduceTargetPercentage\"\n                  onChange={reduceTargetPercentageChange}\n                  rules={{\n                    validate: (value) =>\n                      !isNaN(value) ||\n                      formatMessage({ id: \"terminal.reducestrategy.percentage.error\" }),\n                  }}\n                  showErrorMessage={false}\n                />\n                <div className=\"currencyBox\">%</div>\n              </Box>\n              <Box alignItems=\"center\" display=\"flex\">\n                <CustomNumberInput disabled={true} name=\"\" value={reduceTargetPrice} />\n                <div className=\"currencyBox\">{symbolData.unitsInvestment}</div>\n              </Box>\n            </Box>\n          )}\n          {errors.reduceTargetPercentage && (\n            <span className=\"errorText\">{errors.reduceTargetPercentage.message}</span>\n          )}\n\n          <Box\n            alignItems=\"flex-start\"\n            className=\"targetUnits\"\n            display=\"flex\"\n            flexDirection=\"row\"\n            flexWrap=\"wrap\"\n          >\n            <HelperLabel\n              descriptionId=\"terminal.reducestrategy.availablePercentage.help\"\n              labelId=\"terminal.reducestrategy.availablePercentage\"\n            />\n            <Box alignItems=\"center\" display=\"flex\">\n              <CustomNumberInput\n                name=\"reduceAvailablePercentage\"\n                onChange={reduceAvailablePercentageChange}\n                rules={{\n                  validate: {\n                    percentage: (value) =>\n                      validPercentage(value, \"terminal.reducestrategy.percentage.limit\"),\n                  },\n                }}\n                showErrorMessage={false}\n              />\n              <div className=\"currencyBox\">%</div>\n            </Box>\n            <Box alignItems=\"flex-start\" display=\"flex\" flexDirection=\"column\">\n              <Box display=\"flex\" flexDirection=\"row\">\n                <CustomNumberInput disabled={true} name=\"\" value={reduceTargetUnits} />\n                <div className=\"currencyBox\">{symbolData.unitsAmount}</div>\n              </Box>\n              <FormHelperText>\n                <FormattedMessage id=\"terminal.available\" />{\" \"}\n                <span className=\"balance\">{formatPrice(positionEntity.availableAmount)}</span>\n              </FormHelperText>\n            </Box>\n            {errors.reduceAvailablePercentage && (\n              <span className=\"errorText\">{errors.reduceAvailablePercentage.message}</span>\n            )}\n          </Box>\n\n          <FormControlLabel\n            className=\"customCheckbox\"\n            control={\n              <Controller\n                control={control}\n                defaultValue={false}\n                name=\"reduceRecurring\"\n                render={({ onChange, value }) => (\n                  <Checkbox\n                    checked={value}\n                    onChange={(e) => {\n                      setValue(\"reduceOrderType\", \"limit\");\n                      onChange(e.target.checked);\n                    }}\n                  />\n                )}\n              />\n            }\n            label={\n              <HelperLabel\n                descriptionId=\"terminal.reducestrategy.recurring.help\"\n                labelId=\"terminal.reducestrategy.recurring\"\n              />\n            }\n          />\n          <FormControlLabel\n            className=\"customCheckbox\"\n            control={\n              <Controller\n                control={control}\n                defaultValue={false}\n                name=\"reducePersistent\"\n                render={({ onChange, value }) => (\n                  <Checkbox checked={value} onChange={(e) => onChange(e.target.checked)} />\n                )}\n              />\n            }\n            label={\n              <HelperLabel\n                descriptionId=\"terminal.reducestrategy.persistent.help\"\n                labelId=\"terminal.reducestrategy.persistent\"\n              />\n            }\n          />\n          {[\"limit\"].includes(reduceOrderType) && (\n            <Box alignItems=\"center\" display=\"flex\" flexDirection=\"row\" justifyContent=\"start\">\n              <PostOnlyControl exchange={positionEntity?.exchange} name=\"reducePostOnly\" />\n            </Box>\n          )}\n        </Box>\n      )}\n    </Box>\n  );\n};\n\nexport default React.memo(ReduceStrategyPanel);\n","import React from \"react\";\nimport TakeProfitPanel from \"../TakeProfitPanel/TakeProfitPanel\";\nimport DCAPanel from \"../DCAPanel/DCAPanel\";\nimport StopLossPanel from \"../StopLossPanel/StopLossPanel\";\nimport TrailingStopPanel from \"../TrailingStopPanel/TrailingStopPanel\";\nimport IncreaseStrategyPanel from \"../IncreaseStrategyPanel/IncreaseStrategyPanel\";\nimport ReduceOrders from \"../ReduceOrders/ReduceOrders\";\nimport ReduceStrategyPanel from \"../ReduceStrategyPanel/ReduceStrategyPanel\";\n\n/**\n * @typedef {import(\"../../../services/tradeApiClient.types\").MarketSymbol} MarketSymbol\n */\n\n/**\n * @typedef {Object} SidebarEditPanelsProps\n * @property {MarketSymbol} selectedSymbol\n * @property {Position} [positionEntity] Position entity (optional) for position edit trading view.\n * @property {boolean} isReadOnly Flag to disable position update.\n */\n\n/**\n * Edit position sidebar edit panels.\n *\n * @param {SidebarEditPanelsProps} props Component props.\n * @returns {JSX.Element} Strategy form element.\n */\nconst SidebarEditPanels = (props) => {\n  const { positionEntity, selectedSymbol, isReadOnly } = props;\n\n  return (\n    <>\n      <TakeProfitPanel\n        isReadOnly={isReadOnly}\n        positionEntity={positionEntity}\n        symbolData={selectedSymbol}\n      />\n      <DCAPanel\n        isReadOnly={isReadOnly}\n        positionEntity={positionEntity}\n        symbolData={selectedSymbol}\n      />\n      <StopLossPanel\n        isReadOnly={isReadOnly}\n        positionEntity={positionEntity}\n        symbolData={selectedSymbol}\n      />\n      <TrailingStopPanel\n        isReadOnly={isReadOnly}\n        positionEntity={positionEntity}\n        symbolData={selectedSymbol}\n      />\n      {!isReadOnly && (\n        <IncreaseStrategyPanel positionEntity={positionEntity} symbolData={selectedSymbol} />\n      )}\n      <ReduceOrders isReadOnly={isReadOnly} positionEntity={positionEntity} />\n      {!isReadOnly && (\n        <ReduceStrategyPanel positionEntity={positionEntity} symbolData={selectedSymbol} />\n      )}\n    </>\n  );\n};\n\nexport default React.memo(SidebarEditPanels);\n","import React, { useState } from \"react\";\nimport { Box, Slider, Typography } from \"@material-ui/core\";\nimport { FormattedMessage } from \"react-intl\";\nimport \"./LeverageForm.scss\";\nimport useStoreSettingsSelector from \"../../../hooks/useStoreSettingsSelector\";\nimport CustomButton from \"../../CustomButton\";\n\n/**\n * @typedef {Object} LeverageFormProps\n * @property {number} min Minimum leverage limit.\n * @property {number} max Maximum leverage limit.\n * @property {number} leverage Current leverage.\n * @property {function} setValue Hook form setValue callback.\n * @property {function} onClose Hook form setValue callback.\n */\n\n/**\n * Leverage form control component.\n *\n * @param {LeverageFormProps} props Component props.\n * @returns {JSX.Element} Leverage form element.\n */\nconst LeverageForm = (props) => {\n  const { min, max, leverage, setValue, onClose } = props;\n  const [val, setVal] = useState(leverage);\n  const marks = [\n    { value: 1, label: \"1\" },\n    { value: 25, label: \"25\" },\n    { value: 50, label: \"50\" },\n    { value: 75, label: \"75\" },\n    { value: 100, label: \"100\" },\n    { value: 125, label: \"125\" },\n  ];\n  const { darkStyle } = useStoreSettingsSelector();\n\n  const handleCancel = () => {\n    onClose();\n  };\n\n  const handleConfirm = () => {\n    setValue(\"leverage\", val);\n    onClose();\n  };\n\n  /**\n   * Leverage slided change handler.\n   *\n   * @param {React.ChangeEvent<{}>} event Change event.\n   * @param {number} newValue Selected slider value.\n   * @returns {Void} None.\n   */\n  const handleSliderChange = (event, newValue) => {\n    setVal(newValue);\n  };\n\n  /**\n   * Leverage input value change handler.\n   *\n   * @param {React.ChangeEvent<HTMLInputElement>} event Change event.\n   * @returns {Void} None.\n   */\n  const handleInputChange = (event) => {\n    const targetElement = event.currentTarget;\n    setVal(Number(targetElement.value));\n  };\n\n  const protectLimits = () => {\n    if (val < min) {\n      setVal(min);\n    } else if (val > max) {\n      setVal(max);\n    }\n  };\n\n  const increaseValue = () => {\n    const newValue = val + 1;\n    if (newValue <= max) {\n      setVal(newValue);\n    }\n  };\n\n  const decreaseValue = () => {\n    const newValue = val - 1;\n    if (newValue >= min) {\n      setVal(newValue);\n    }\n  };\n\n  return (\n    <Box\n      className=\"leverageForm\"\n      display=\"flex\"\n      flexDirection=\"column\"\n      justifyContent=\"space-between\"\n    >\n      <Typography className=\"title\" id=\"range-slider\" variant=\"h3\">\n        <FormattedMessage id=\"terminal.leverage.adjust\" />\n      </Typography>\n      <Box className=\"inputValue\" display=\"flex\" flexDirection=\"row\" justifyContent=\"space-between\">\n        <button\n          className={darkStyle ? \"dark\" : \"light\"}\n          onClick={() => decreaseValue()}\n          type=\"button\"\n        >\n          \n        </button>\n        <input\n          className={darkStyle ? \"dark\" : \"light\"}\n          onBlur={protectLimits}\n          onChange={handleInputChange}\n          value={val}\n        />\n        <button\n          className={darkStyle ? \"dark\" : \"light\"}\n          onClick={() => increaseValue()}\n          type=\"button\"\n        >\n          +\n        </button>\n      </Box>\n      <Slider\n        aria-labelledby=\"range-slider\"\n        className=\"slider\"\n        classes={{ mark: \"mark\", thumb: \"thumb\", track: \"track\", markLabel: \"markLabel\" }}\n        marks={marks}\n        max={max}\n        min={min}\n        onChange={handleSliderChange}\n        step={1}\n        value={val}\n      />\n      {max > 25 && val >= 25 && (\n        <span className=\"errorText\">\n          <FormattedMessage id=\"terminal.leverage.alert\" />\n        </span>\n      )}\n      <Box\n        alignItems=\"center\"\n        className=\"formActions\"\n        display=\"flex\"\n        flexDirection=\"row\"\n        justifyContent=\"space-between\"\n      >\n        <CustomButton className=\"textDefault\" onClick={handleCancel}>\n          <FormattedMessage id=\"terminal.leverage.cancel\" />\n        </CustomButton>\n        <CustomButton className=\"submitButton\" onClick={handleConfirm}>\n          <FormattedMessage id=\"terminal.leverage.confirm\" />\n        </CustomButton>\n      </Box>\n    </Box>\n  );\n};\n\nexport default React.memo(LeverageForm);\n","import React, { useState } from \"react\";\nimport { Box, Button, Switch, Typography } from \"@material-ui/core\";\nimport { FormattedMessage } from \"react-intl\";\nimport { useFormContext } from \"react-hook-form\";\nimport LeverageForm from \"../../LeverageForm/LeverageForm\";\nimport Modal from \"../../../Modal\";\nimport useSelectedExchange from \"hooks/useSelectedExchange\";\nimport HelperLabel from \"../../HelperLabel/HelperLabel\";\nimport \"./MarginControl.scss\";\n\n/**\n * @typedef {import(\"services/tradeApiClient.types\").MarketSymbol} MarketSymbol\n */\n\n/**\n * Manual trading strategy panel component.\n *\n * @param {Object} props Props.\n * @param {MarketSymbol} props.symbolData Selected Symbol.\n * @returns {JSX.Element} JSX.\n */\nconst MarginControl = ({ symbolData }) => {\n  const { register, watch, setValue } = useFormContext();\n  const leverage = watch(\"leverage\");\n  const marginMode = watch(\"marginMode\");\n  const [modalVisible, setModalVisible] = useState(false);\n  const selectedExchange = useSelectedExchange();\n  const showCross = selectedExchange.exchangeName.toLowerCase() === \"bitmex\";\n  const leverageEditable =\n    marginMode !== \"cross\" || selectedExchange.exchangeName.toLowerCase() !== \"bitmex\";\n\n  /**\n   * Leverage mode change handler.\n   *\n   * @param {React.ChangeEvent<HTMLInputElement>} event Change event.\n   * @returns {void}\n   */\n  const handleModeChange = (event) => {\n    setValue(\"marginMode\", event.target.checked ? \"cross\" : \"isolated\");\n  };\n\n  return (\n    <Box className=\"marginControl\">\n      <HelperLabel descriptionId=\"terminal.leverage.help\" labelId=\"terminal.leverage\" />\n\n      <Box alignItems=\"center\" display=\"flex\" flexDirection=\"row\">\n        <Box\n          className=\"leverageButton\"\n          display=\"flex\"\n          flexDirection=\"column\"\n          justifyContent=\"flex-end\"\n        >\n          <Modal\n            onClose={() => setModalVisible(false)}\n            persist={false}\n            size=\"small\"\n            state={modalVisible}\n          >\n            <LeverageForm\n              leverage={parseInt(leverage)}\n              max={symbolData.maxLeverage}\n              min={1}\n              onClose={() => {\n                setModalVisible(false);\n              }}\n              setValue={setValue}\n            />\n          </Modal>\n          {leverageEditable && (\n            <Button onClick={() => setModalVisible(true)}>\n              {marginMode === \"cross\"\n                ? selectedExchange.exchangeName.toLowerCase() === \"bitmex\"\n                  ? \"Cross\"\n                  : `Cross ${leverage}x`\n                : `${leverage}x`}\n            </Button>\n          )}\n          <input name=\"leverage\" ref={register} type=\"hidden\" />\n          <input name=\"marginMode\" ref={register} type=\"hidden\" />\n        </Box>\n        {showCross && (\n          <Box alignItems=\"center\" className=\"mode\" display=\"flex\" flexDirection=\"row\">\n            <Typography className=\"callout1\">\n              <FormattedMessage id=\"terminal.leverage.isolated\" />\n            </Typography>\n            <Switch checked={marginMode === \"cross\"} onChange={handleModeChange} />\n            <Typography className=\"callout1\">\n              <FormattedMessage id=\"terminal.leverage.cross\" />\n            </Typography>\n          </Box>\n        )}\n      </Box>\n    </Box>\n  );\n};\n\nexport default MarginControl;\n","import React, { useContext } from \"react\";\nimport CustomSelect from \"../../CustomSelect\";\nimport { useFormContext, Controller } from \"react-hook-form\";\nimport { useIntl, FormattedMessage } from \"react-intl\";\nimport {\n  Box,\n  FormControl,\n  FormControlLabel,\n  FormHelperText,\n  Radio,\n  RadioGroup,\n  Typography,\n  CircularProgress,\n} from \"@material-ui/core\";\nimport HelperLabel from \"../HelperLabel/HelperLabel\";\nimport { formatPrice } from \"../../../utils/formatters\";\nimport { formatFloat2Dec } from \"../../../utils/format\";\nimport usePositionSizeHandlers from \"../../../hooks/usePositionSizeHandlers\";\nimport useAvailableBalance from \"../../../hooks/useAvailableBalance\";\nimport \"./StrategyPanel.scss\";\nimport TradingViewContext from \"../TradingView/TradingViewContext\";\nimport PostOnlyControl from \"../Controls/PostOnlyControl/PostOnlyControl\";\nimport CustomNumberInput from \"components/Forms/CustomNumberInput\";\nimport MarginButtons from \"../Controls/MarginControl\";\nimport { Alert } from \"@material-ui/lab\";\nimport useSelectedExchange from \"hooks/useSelectedExchange\";\n\n/**\n * @typedef {import(\"services/tradeApiClient.types\").MarketSymbol} MarketSymbol\n */\n\n/**\n * @param {Object} props Props\n * @param {string} [props.multiSide] Side for multi order\n * @param {MarketSymbol} props.symbolData symbolData\n * @returns {JSX.Element} JSX\n */\nconst PriceControl = ({ multiSide, symbolData }) => {\n  const { errors, watch } = useFormContext();\n  const entryStrategy = watch(\"entryStrategy\");\n  const { lastPrice } = useContext(TradingViewContext);\n\n  const { validatePrice, priceChange } = usePositionSizeHandlers(symbolData);\n\n  const name = multiSide === \"short\" ? \"priceShort\" : \"price\";\n  const label = entryStrategy === \"multi\" ? `terminal.price.${multiSide}` : \"terminal.price\";\n\n  return (\n    <FormControl>\n      <HelperLabel descriptionId=\"terminal.price.help\" labelId={label} />\n      <Box alignItems=\"center\" display=\"flex\">\n        <CustomNumberInput\n          defaultValue={lastPrice}\n          name={name}\n          onChange={priceChange}\n          rules={{\n            validate: (price) => validatePrice(price, multiSide),\n          }}\n          showErrorMessage={false}\n        />\n        <div className=\"currencyBox\">{symbolData.quote}</div>\n      </Box>\n      {errors[name] && <span className=\"errorText\">{errors[name].message}</span>}\n    </FormControl>\n  );\n};\n\n/**\n * @param {Object} props Props\n * @param {string} [props.multiSide] Side for multi order\n * @param {MarketSymbol} props.symbolData symbolData\n * @param {boolean} props.loading Balance loading\n * @param {number} props.baseBalance Balance\n * @returns {JSX.Element} JSX\n */\nconst UnitsControl = ({ multiSide, symbolData, loading, baseBalance }) => {\n  const { errors, watch } = useFormContext();\n  const { unitsChange, validateUnits } = usePositionSizeHandlers(symbolData);\n  const entryStrategy = watch(\"entryStrategy\");\n  const name = multiSide === \"short\" ? \"unitsShort\" : \"units\";\n  const label = entryStrategy === \"multi\" ? `terminal.units.${multiSide}` : \"terminal.units\";\n  return (\n    <FormControl>\n      <HelperLabel descriptionId=\"terminal.units.help\" labelId={label} />\n      <Box alignItems=\"center\" display=\"flex\">\n        <CustomNumberInput\n          name={name}\n          onChange={unitsChange}\n          placeholder={\"0\"}\n          readOnly={entryStrategy === \"multi\"}\n          rules={{\n            validate: validateUnits,\n          }}\n          showErrorMessage={false}\n        />\n        <div className=\"currencyBox\">{symbolData.unitsAmount}</div>\n      </Box>\n      <FormHelperText>\n        <FormattedMessage id=\"terminal.available\" />{\" \"}\n        {loading ? (\n          <CircularProgress color=\"primary\" size={15} />\n        ) : (\n          <span className=\"balance\">{formatPrice(baseBalance)}</span>\n        )}\n      </FormHelperText>\n      {errors[name] && <span className=\"errorText\">{errors[name].message}</span>}\n    </FormControl>\n  );\n};\n\n/**\n * @typedef {Object} StrategyPanelProps\n * @property {MarketSymbol} symbolData\n */\n\n/**\n * Manual trading strategy panel component.\n *\n * @param {StrategyPanelProps} props Component props.\n * @returns {JSX.Element} Strategy panel element.\n */\nconst StrategyPanel = (props) => {\n  const { symbolData } = props;\n  const { control, errors, register, watch } = useFormContext();\n  const { formatMessage } = useIntl();\n  const selectedExchange = useSelectedExchange();\n  const { balance, loading } = useAvailableBalance(selectedExchange);\n  const baseBalance = (balance && balance[symbolData.unitsAmount]) || 0;\n  const quoteBalance = (balance && balance[symbolData.unitsInvestment]) || 0;\n\n  const {\n    positionSizeChange,\n    realInvestmentChange,\n    validatePositionSize,\n    positionSizePercentageChange,\n  } = usePositionSizeHandlers(symbolData);\n\n  const entryType = watch(\"entryType\");\n  const entryStrategy = watch(\"entryStrategy\");\n\n  const { providerService } = useContext(TradingViewContext);\n  const providerConsumedBalance = providerService ? providerService.providerConsumedBalance : 0;\n  const providerAllocatedBalance = providerService ? providerService.providerPayableBalance : 0;\n  const providerConsumedBalancePercentage = providerService\n    ? providerService.providerConsumedBalancePercentage\n    : 0;\n  const isCopyProvider = providerService && providerService.providerId !== \"1\";\n\n  const entryStrategyOptions = [\n    { label: formatMessage({ id: \"terminal.strategy.limit\" }), val: \"limit\" },\n    { label: formatMessage({ id: \"terminal.strategy.market\" }), val: \"market\" },\n    { label: formatMessage({ id: \"terminal.strategy.stoplimit\" }), val: \"stop_limit\" },\n  ];\n\n  if (selectedExchange.exchangeType === \"futures\") {\n    entryStrategyOptions.push({\n      label: formatMessage({ id: \"terminal.strategy.multi\" }),\n      val: \"multi\",\n    });\n  }\n\n  if (!isCopyProvider) {\n    entryStrategyOptions.push({\n      label: formatMessage({ id: \"terminal.strategy.import\" }),\n      val: \"import\",\n    });\n  }\n\n  return (\n    <Box bgcolor=\"grid.main\" className={\"panel strategyPanel expanded\"}>\n      <Box alignItems=\"center\" className=\"panelHeader\" display=\"flex\" flexDirection=\"row\">\n        <Box alignItems=\"center\" className=\"title\" display=\"flex\" flexDirection=\"row\">\n          <Typography variant=\"h5\">\n            <FormattedMessage id=\"terminal.strategy\" />\n          </Typography>\n          <Controller\n            as={<CustomSelect label=\"\" onChange={() => {}} options={entryStrategyOptions} />}\n            control={control}\n            defaultValue=\"limit\"\n            name=\"entryStrategy\"\n          />\n        </Box>\n      </Box>\n      <Box className=\"panelContent\" display=\"flex\" flexDirection=\"row\" flexWrap=\"wrap\">\n        {selectedExchange.exchangeType === \"futures\" && entryStrategy !== \"multi\" && (\n          <FormControl className=\"entryType\">\n            <Controller\n              as={\n                <RadioGroup aria-label={formatMessage({ id: \"terminal.entrytype\" })}>\n                  <FormControlLabel\n                    control={<Radio />}\n                    label={<FormattedMessage id=\"col.side.long\" />}\n                    value=\"LONG\"\n                  />\n                  <FormControlLabel\n                    control={<Radio />}\n                    label={<FormattedMessage id=\"col.side.short\" />}\n                    value=\"SHORT\"\n                  />\n                </RadioGroup>\n              }\n              control={control}\n              defaultValue={entryType}\n              name=\"entryType\"\n            />\n          </FormControl>\n        )}\n        {entryStrategy === \"stop_limit\" && (\n          <FormControl>\n            <HelperLabel descriptionId=\"terminal.stopprice.help\" labelId=\"terminal.stopprice\" />\n            <Box alignItems=\"center\" display=\"flex\">\n              <CustomNumberInput\n                name=\"stopPrice\"\n                rules={{\n                  validate: (value) => !isNaN(value) && parseFloat(value) > 0,\n                }}\n                showErrorMessage={false}\n              />\n              <div className=\"currencyBox\">{symbolData.quote}</div>\n            </Box>\n          </FormControl>\n        )}\n        {entryStrategy === \"multi\" && (\n          <Alert severity=\"info\">\n            <FormattedMessage id=\"terminal.strategy.multi.info\" />\n            <br />\n            <FormattedMessage id=\"terminal.strategy.multi.strategy\" />\n          </Alert>\n        )}\n        {entryStrategy !== \"market\" ? (\n          entryStrategy === \"multi\" ? (\n            <>\n              <PriceControl multiSide=\"long\" symbolData={symbolData} />\n              <PriceControl multiSide=\"short\" symbolData={symbolData} />\n            </>\n          ) : (\n            <PriceControl symbolData={symbolData} />\n          )\n        ) : (\n          <input name=\"price\" ref={register} type=\"hidden\" />\n        )}\n        {selectedExchange.exchangeType === \"futures\" && !isCopyProvider && (\n          <FormControl>\n            <HelperLabel descriptionId=\"terminal.realinvest.help\" labelId=\"terminal.realinvest\" />\n            <Box alignItems=\"center\" display=\"flex\">\n              <CustomNumberInput\n                name=\"realInvestment\"\n                onChange={realInvestmentChange}\n                placeholder={\"0\"}\n                showErrorMessage={false}\n              />\n              <div className=\"currencyBox\">{symbolData.unitsInvestment}</div>\n            </Box>\n            <FormHelperText>\n              <FormattedMessage id=\"terminal.available\" />{\" \"}\n              {loading ? (\n                <CircularProgress color=\"primary\" size={15} />\n              ) : (\n                <span className=\"balance\">{formatPrice(quoteBalance)}</span>\n              )}\n            </FormHelperText>\n          </FormControl>\n        )}\n        {!isCopyProvider && (\n          <FormControl>\n            <HelperLabel\n              descriptionId=\"terminal.position.size.help\"\n              labelId=\"terminal.position.size\"\n            />\n            <Box alignItems=\"center\" display=\"flex\">\n              <CustomNumberInput\n                name=\"positionSize\"\n                onChange={positionSizeChange}\n                placeholder={\"0\"}\n                rules={{\n                  required: formatMessage({ id: \"terminal.positionsize.required\" }),\n                  validate: validatePositionSize,\n                }}\n                showErrorMessage={false}\n              />\n              <div className=\"currencyBox\">{symbolData.unitsInvestment}</div>\n            </Box>\n            <FormHelperText>\n              <FormattedMessage id=\"terminal.available\" />{\" \"}\n              {loading ? (\n                <CircularProgress color=\"primary\" size={15} />\n              ) : (\n                <span className=\"balance\">{formatPrice(quoteBalance)}</span>\n              )}\n            </FormHelperText>\n            {errors.positionSize && (\n              <span className=\"errorText\">{errors.positionSize.message}</span>\n            )}\n          </FormControl>\n        )}\n        {isCopyProvider && (\n          <FormControl>\n            <HelperLabel\n              descriptionId=\"terminal.position.sizepercentage.help\"\n              labelId=\"terminal.position.sizepercentage\"\n            />\n            <Box className=\"positionSizePercentage\" display=\"flex\" flexDirection=\"row\">\n              <Box display=\"flex\" flexDirection=\"row\">\n                <CustomNumberInput\n                  name=\"positionSizePercentage\"\n                  onChange={positionSizePercentageChange}\n                  placeholder={\"0\"}\n                  rules={{\n                    required: formatMessage({ id: \"terminal.positionsize.percentage.required\" }),\n                    validate: (value) =>\n                      (value > 0 && value <= 100) ||\n                      formatMessage({ id: \"terminal.positionsize.valid.percentage\" }),\n                  }}\n                  showErrorMessage={false}\n                />\n                <div className=\"currencyBox\">%</div>\n              </Box>\n              <Box display=\"flex\" flexDirection=\"row\">\n                <CustomNumberInput name=\"positionSizeAllocated\" placeholder={\"0\"} readOnly={true} />\n                <div className=\"currencyBox\">{symbolData.unitsInvestment}</div>\n              </Box>\n            </Box>\n            <FormHelperText>\n              <FormattedMessage id=\"terminal.provider.allocated\" />{\" \"}\n              <span>{formatPrice(providerAllocatedBalance)}, </span>\n              <FormattedMessage id=\"terminal.provider.consumed\" />{\" \"}\n              <span>{formatPrice(providerConsumedBalance)}, </span>\n              <FormattedMessage id=\"terminal.provider.available\" />{\" \"}\n              <span>{formatFloat2Dec(100 - providerConsumedBalancePercentage)}%</span>\n            </FormHelperText>\n            {errors.positionSizePercentage && (\n              <span className=\"errorText\">{errors.positionSizePercentage.message}</span>\n            )}\n          </FormControl>\n        )}\n        {!isCopyProvider &&\n          (entryStrategy === \"multi\" ? (\n            <>\n              <UnitsControl\n                baseBalance={baseBalance}\n                loading={loading}\n                multiSide=\"long\"\n                symbolData={symbolData}\n              />\n              <UnitsControl\n                baseBalance={baseBalance}\n                loading={loading}\n                multiSide=\"short\"\n                symbolData={symbolData}\n              />\n            </>\n          ) : (\n            <UnitsControl baseBalance={baseBalance} loading={loading} symbolData={symbolData} />\n          ))}\n        {selectedExchange.exchangeType === \"futures\" && <MarginButtons symbolData={symbolData} />}\n        {[\"limit\", \"multi\"].includes(entryStrategy) && (\n          <Box alignItems=\"center\" display=\"flex\" flexDirection=\"row\" justifyContent=\"start\">\n            <PostOnlyControl />\n          </Box>\n        )}\n      </Box>\n    </Box>\n  );\n};\n\nexport default React.memo(StrategyPanel);\n","import React, { useEffect } from \"react\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\nimport HelperLabel from \"../HelperLabel/HelperLabel\";\nimport CustomNumberInput from \"components/Forms/CustomNumberInput\";\nimport { Box, Typography, Switch } from \"@material-ui/core\";\nimport { useFormContext } from \"react-hook-form\";\nimport useExpandable from \"../../../hooks/useExpandable\";\nimport \"./EntryExpirationPanel.scss\";\n\n/**\n * Manual trading expiration panel component.\n *\n * @returns {JSX.Element} Take profit panel element.\n */\nconst EntryExpirationPanel = () => {\n  const { expanded, expandClass, setExpanded } = useExpandable();\n  const { clearErrors, errors } = useFormContext();\n  const { formatMessage } = useIntl();\n\n  /**\n   * Display property errors.\n   *\n   * @param {string} propertyName Property name to display errors for.\n   * @returns {JSX.Element|null} Errors JSX element.\n   */\n  const displayFieldErrors = (propertyName) => {\n    if (errors[propertyName]) {\n      return <span className=\"errorText\">{errors[propertyName].message}</span>;\n    }\n\n    return null;\n  };\n\n  const emptyFieldsWhenCollapsed = () => {\n    if (!expanded) {\n      clearErrors(\"entryExpiration\");\n    }\n  };\n\n  useEffect(emptyFieldsWhenCollapsed, [expanded]);\n\n  return (\n    <Box className={`panel entryExpirationPanel ${expandClass}`}>\n      <Box alignItems=\"center\" className=\"panelHeader\" display=\"flex\" flexDirection=\"row\">\n        <Switch checked={expanded} onChange={(e) => setExpanded(e.target.checked)} size=\"small\" />\n        <Box alignItems=\"center\" className=\"title\" display=\"flex\" flexDirection=\"row\">\n          <Typography variant=\"h5\">\n            <FormattedMessage id=\"terminal.entryexpiration\" />\n          </Typography>\n        </Box>\n      </Box>\n      {expanded && (\n        <Box\n          className=\"panelContent\"\n          display=\"flex\"\n          flexDirection=\"row\"\n          flexWrap=\"wrap\"\n          justifyContent=\"space-around\"\n        >\n          <Box className=\"entryExpiration\" display=\"flex\" flexDirection=\"row\" flexWrap=\"wrap\">\n            <HelperLabel\n              descriptionId=\"terminal.entryexpiration.help\"\n              labelId=\"terminal.entryexpiration\"\n            />\n            <Box alignItems=\"center\" display=\"flex\">\n              <CustomNumberInput\n                name=\"entryExpiration\"\n                rules={{\n                  validate: (value) =>\n                    value > 0 || formatMessage({ id: \"terminal.expiration.limit.zero\" }),\n                }}\n                showErrorMessage={false}\n              />\n              <div className=\"currencyBox\">\n                <FormattedMessage id=\"terminal.minutes\" />\n              </div>\n            </Box>\n            {displayFieldErrors(\"entryExpiration\")}\n          </Box>\n        </Box>\n      )}\n    </Box>\n  );\n};\n\nexport default React.memo(EntryExpirationPanel);\n","import React, { useEffect } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport HelperLabel from \"../HelperLabel/HelperLabel\";\nimport { Box, Typography, Switch } from \"@material-ui/core\";\nimport CustomNumberInput from \"components/Forms/CustomNumberInput\";\nimport { useFormContext } from \"react-hook-form\";\nimport useExpandable from \"../../../hooks/useExpandable\";\nimport \"./AutoclosePanel.scss\";\n\n/**\n * Manual trading autoclose panel component.\n *\n * @returns {JSX.Element} Take profit panel element.\n */\nconst AutoclosePanel = () => {\n  const { expanded, expandClass, setExpanded } = useExpandable();\n  const { clearErrors, errors } = useFormContext();\n\n  /**\n   * Display property errors.\n   *\n   * @param {string} propertyName Property name to display errors for.\n   * @returns {JSX.Element|null} Errors JSX element.\n   */\n  const displayFieldErrors = (propertyName) => {\n    if (errors[propertyName]) {\n      return <span className=\"errorText\">{errors[propertyName].message}</span>;\n    }\n\n    return null;\n  };\n\n  const emptyFieldsWhenCollapsed = () => {\n    if (!expanded) {\n      clearErrors(\"autoclose\");\n    }\n  };\n\n  useEffect(emptyFieldsWhenCollapsed, [expanded]);\n\n  return (\n    <Box className={`panel autoclosePanel ${expandClass}`}>\n      <Box alignItems=\"center\" className=\"panelHeader\" display=\"flex\" flexDirection=\"row\">\n        <Switch checked={expanded} onChange={(e) => setExpanded(e.target.checked)} size=\"small\" />\n        <Box alignItems=\"center\" className=\"title\" display=\"flex\" flexDirection=\"row\">\n          <Typography variant=\"h5\">\n            <FormattedMessage id=\"terminal.timeautoclose\" />\n          </Typography>\n        </Box>\n      </Box>\n      {expanded && (\n        <Box\n          className=\"panelContent\"\n          display=\"flex\"\n          flexDirection=\"row\"\n          flexWrap=\"wrap\"\n          justifyContent=\"space-around\"\n        >\n          <Box className=\"autoclose\" display=\"flex\" flexDirection=\"row\" flexWrap=\"wrap\">\n            <HelperLabel\n              descriptionId=\"terminal.timeautoclose.help\"\n              labelId=\"terminal.timeautoclose\"\n            />\n            <Box alignItems=\"center\" display=\"flex\">\n              <CustomNumberInput name=\"autoclose\" />\n              <div className=\"currencyBox\">\n                <FormattedMessage id=\"terminal.hours\" />\n              </div>\n            </Box>\n            {displayFieldErrors(\"autoclose\")}\n          </Box>\n        </Box>\n      )}\n    </Box>\n  );\n};\n\nexport default React.memo(AutoclosePanel);\n","import React from \"react\";\nimport TakeProfitPanel from \"../TakeProfitPanel/TakeProfitPanel\";\nimport DCAPanel from \"../DCAPanel/DCAPanel\";\nimport StopLossPanel from \"../StopLossPanel/StopLossPanel\";\nimport TrailingStopPanel from \"../TrailingStopPanel/TrailingStopPanel\";\nimport StrategyPanel from \"../StrategyPanel/StrategyPanel\";\nimport EntryExpirationPanel from \"../EntryExpirationPanel/EntryExpirationPanel\";\nimport AutoclosePanel from \"../AutoclosePanel/AutoclosePanel\";\n\n/**\n * @typedef {import(\"../../../services/tradeApiClient.types\").MarketSymbol} MarketSymbol\n */\n\n/**\n * @typedef {Object} SidebarCreatePanelsProps\n * @property {MarketSymbol} selectedSymbol\n */\n\n/**\n * Edit position sidebar edit panels.\n *\n * @param {SidebarCreatePanelsProps} props Component props.\n * @returns {JSX.Element} Strategy form element.\n */\nconst SidebarCreatePanels = (props) => {\n  const { selectedSymbol } = props;\n\n  return (\n    <>\n      <StrategyPanel symbolData={selectedSymbol} />\n      <TakeProfitPanel symbolData={selectedSymbol} />\n      <DCAPanel symbolData={selectedSymbol} />\n      <StopLossPanel symbolData={selectedSymbol} />\n      <TrailingStopPanel symbolData={selectedSymbol} />\n      <EntryExpirationPanel />\n      <AutoclosePanel />\n    </>\n  );\n};\n\nexport default React.memo(SidebarCreatePanels);\n","import React, { useEffect, useState } from \"react\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\nimport { navigate } from \"gatsby\";\nimport { Box } from \"@material-ui/core\";\nimport { useFormContext } from \"react-hook-form\";\nimport { assign, concat, isEmpty, isFunction, isObject, range, forIn, noop } from \"lodash\";\nimport { useDispatch } from \"react-redux\";\nimport { colors } from \"../../../services/theme\";\nimport { formatPrice } from \"../../../utils/formatters\";\nimport tradeApi from \"../../../services/tradeApiClient\";\nimport { mapEntryTypeToEnum, mapSideToEnum } from \"../../../services/tradeApiClient.types\";\nimport useSelectedExchange from \"hooks/useSelectedExchange\";\nimport { useStoreUserData } from \"../../../hooks/useStoreUserSelector\";\nimport { showErrorAlert, showSuccessAlert } from \"../../../store/actions/ui\";\nimport { calculateDcaPrice } from \"../../../utils/calculations\";\nimport { minToSeconds, hourToSeconds } from \"../../../utils/timeConvert\";\nimport CustomButton from \"../../CustomButton\";\nimport SidebarEditPanels from \"./SidebarEditPanels\";\nimport SidebarCreatePanels from \"./SidebarCreatePanels\";\nimport \"./StrategyForm.scss\";\n\n/**\n * @typedef {any} TVWidget\n * @typedef {any} TVChartLine\n * @typedef {import(\"../../../services/tradeApiClient.types\").CreatePositionPayload} CreatePositionPayload\n * @typedef {import(\"../../../services/tradeApiClient.types\").UpdatePositionPayload} UpdatePositionPayload\n * @typedef {import(\"../../../services/tradeApiClient.types\").MarketSymbol} MarketSymbol\n * @typedef {CreatePositionPayload[\"takeProfitTargets\"]} PositionProfitTargets\n * @typedef {CreatePositionPayload[\"reBuyTargets\"]} PositionDCATargets\n */\n\n/**\n * Compose position DCA targets payload chunk.\n *\n * @param {Object<string, any>} draftPosition React hook form submission values.\n * @returns {PositionDCATargets|boolean} Create position payload.\n */\nexport const composePositionDcaTargets = (draftPosition) => {\n  /**\n   * @type {PositionDCATargets}\n   */\n  const dcaTargets = [];\n\n  /**\n   * Compose a DCA target item for a given index.\n   *\n   * @param {Number} targetId Target index.\n   * @return {Void} None.\n   */\n  const composeTargetItem = (targetId) => {\n    const targetPricePercentage = draftPosition[`dcaTargetPricePercentage${targetId}`];\n    const targetRebuyPercentage = draftPosition[`dcaRebuyPercentage${targetId}`];\n    const targetRebuyPrice = draftPosition[`dcaRebuyPrice${targetId}`];\n    const pricePriority = draftPosition[`dcaRebuyPriority${targetId}`];\n    const postOnly = draftPosition[`dcaPostOnly${targetId}`];\n    // const pricePriority = draftPosition.DCAPriority;\n\n    if (targetRebuyPercentage) {\n      dcaTargets.push({\n        targetId,\n        priceTargetPercentage: parseFloat(targetPricePercentage),\n        priceTarget: parseFloat(targetRebuyPrice),\n        pricePriority,\n        amountPercentage: parseFloat(targetRebuyPercentage),\n        postOnly,\n      });\n    }\n  };\n\n  range(1, 51, 1).forEach(composeTargetItem);\n  range(1000, 1051, 1).forEach(composeTargetItem);\n\n  return isEmpty(dcaTargets) ? false : dcaTargets;\n};\n\n/**\n * @typedef {Object} StrategyFormProps\n * @property {number} lastPrice\n * @property {TVWidget} tradingViewWidget\n * @property {MarketSymbol} selectedSymbol\n * @property {Position} [positionEntity] Position entity (optional) for position edit trading view.\n * @property {function} [notifyPositionUpdate] Callback to notify position update.\n */\n\n/**\n * Manual trading strategy form component.\n *\n * @param {StrategyFormProps} props Component props.\n * @returns {JSX.Element} Strategy form element.\n */\nconst StrategyForm = (props) => {\n  const {\n    lastPrice,\n    notifyPositionUpdate = noop,\n    selectedSymbol,\n    tradingViewWidget,\n    positionEntity = null,\n  } = props;\n\n  const isPositionView = isObject(positionEntity);\n\n  const { errors, handleSubmit, reset, watch, setValue } = useFormContext();\n  const selectedExchange = useSelectedExchange();\n  const storeUserData = useStoreUserData();\n  const dispatch = useDispatch();\n  const [processing, setProcessing] = useState(false);\n  const { formatMessage } = useIntl();\n\n  /**\n   * @type {Object<String, TVChartLine|null>}\n   */\n  const defaultLinesTracking = {\n    price: null,\n    stopLossPrice: null,\n    trailingStopPrice: null,\n    dcaTargetPrice1: null,\n    profitTargetPrice1: null,\n  };\n  const [linesTracking, setLinesTracking] = useState(defaultLinesTracking);\n\n  /**\n   * @typedef {Object} ChartLineParams\n   * @property {string} id Line ID for tracking purposes for remove / redraw.\n   * @property {number} price Line price.\n   * @property {string} label Line label.\n   * @property {string} color Line color.\n   */\n\n  /**\n   * Remove chart line with a given ID.\n   *\n   * @param {string} id Line ID.\n   * @return {Void} None.\n   */\n  function removeLine(id) {\n    const existingChartLine = linesTracking[id] || null;\n\n    if (existingChartLine) {\n      existingChartLine.remove();\n      linesTracking[id] = null;\n\n      // Remove tracked line.\n      setLinesTracking({\n        ...linesTracking,\n      });\n    }\n  }\n\n  /**\n   * Draw price line at Trading View Chart.\n   *\n   * @param {ChartLineParams} chartLineParams Chart line parameters object.\n   * @returns {TVChartLine|null} TV chart line object.\n   */\n  function drawLine(chartLineParams) {\n    const { id, price, label, color } = chartLineParams;\n    const existingChartLine = linesTracking[id] || null;\n\n    // Avoid draw lines when widget don't expose chart API, this is the case\n    // when TV library is loaded as widget from vendor servers.\n    if (!tradingViewWidget || !isFunction(tradingViewWidget.chart)) {\n      return null;\n    }\n\n    // Skip draw when price is empty.\n    if (price === 0) {\n      return null;\n    }\n\n    // When line already exists, remove prior to draw to prevent duplication.\n    if (existingChartLine) {\n      const currentLinePrice = existingChartLine.getPrice();\n      // Update existing line only if price changed.\n      if (price !== currentLinePrice) {\n        existingChartLine.setPrice(price);\n        existingChartLine.setQuantity(price);\n      }\n\n      return existingChartLine;\n    }\n\n    const chart = tradingViewWidget.chart();\n\n    const chartLine = chart\n      .createPositionLine({})\n      .setPrice(price)\n      .setQuantity(`${price}`)\n      .setText(label)\n      // horizontal line\n      .setLineColor(color)\n      // content text\n      .setBodyTextColor(color)\n      // content text border\n      .setBodyBorderColor(color)\n      // accompanying number\n      .setQuantityBackgroundColor(color)\n      // accompanying number border\n      .setQuantityBorderColor(color);\n\n    // Track the chart line object.\n    setLinesTracking({\n      ...linesTracking,\n      [id]: chartLine,\n    });\n\n    return chartLine;\n  }\n\n  /**\n   * Compose position profit targets.\n   *\n   * @param {Object<string, any>} draftPosition React hook form submission values.\n   * @returns {PositionProfitTargets|boolean} Create position payload.\n   */\n  const composePositionTakeProfitTargets = (draftPosition) => {\n    const targetRange = range(1, 10, 1);\n    /**\n     * @type {PositionProfitTargets} takeProfitTargets\n     */\n    const takeProfitTargets = [];\n\n    targetRange.forEach((targetId) => {\n      const targetPricePercentage = draftPosition[`takeProfitTargetPricePercentage${targetId}`];\n      const targetPrice = draftPosition[`takeProfitTargetPrice${targetId}`];\n      const pricePriority = draftPosition[`takeProfitPriority${targetId}`];\n      const targetExitUnitsPercentage = draftPosition[`takeProfitExitUnitsPercentage${targetId}`];\n      const postOnly = draftPosition[`takeProfitPostOnly${targetId}`];\n\n      if (targetExitUnitsPercentage) {\n        takeProfitTargets.push({\n          targetId,\n          priceTargetPercentage: parseFloat(targetPricePercentage),\n          priceTarget: parseFloat(targetPrice),\n          pricePriority,\n          amountPercentage: parseFloat(targetExitUnitsPercentage),\n          postOnly,\n        });\n      }\n    });\n\n    return isEmpty(takeProfitTargets) ? false : takeProfitTargets;\n  };\n\n  /**\n   * @typedef {Object} PositionStrategyParams\n   * @property {CreatePositionPayload['type']} type\n   * @property {CreatePositionPayload['positionSize']} positionSize\n   * @property {CreatePositionPayload['realInvestment']} realInvestment\n   * @property {CreatePositionPayload['limitPrice']} [limitPrice]\n   * @property {string} [providerId]\n   * @property {string} [providerName]\n   * @property {string} [limitPrice_long]\n   * @property {string} [limitPrice_short]\n   * @property {string} [orderType_long]\n   * @property {string} [orderType_short]\n   */\n\n  /**\n   * Compose position strategy payload chunk.\n   *\n   * @param {Object<string, any>} draftPosition React hook form submission values.\n   * @returns {PositionStrategyParams} Create position payload.\n   */\n  const composePositionStrategy = (draftPosition) => {\n    const positionSize = parseFloat(draftPosition.positionSize) || 0;\n    const strategy = {\n      buyType: mapEntryTypeToEnum(draftPosition.entryStrategy),\n      type: mapEntryTypeToEnum(draftPosition.entryStrategy),\n      positionSize,\n      positionSizeQuote: selectedSymbol.quote,\n      realInvestment: parseFloat(draftPosition.realInvestment) || positionSize,\n      limitPrice: draftPosition.price || lastPrice,\n      ...(draftPosition.entryStrategy === \"multi\" && {\n        /* eslint-disable camelcase */\n        limitPrice_long: draftPosition.price,\n        limitPrice_short: draftPosition.priceShort,\n        orderType_long: \"limit\",\n        orderType_short: \"limit\",\n        /* eslint-enable camelcase */\n      }),\n    };\n\n    if (draftPosition.positionSizePercentage) {\n      return assign(strategy, {\n        positionSizePercentage: parseFloat(draftPosition.positionSizePercentage) || 0,\n        providerId: draftPosition.providerService || \"\",\n        providerName: draftPosition.providerName || \"\",\n      });\n    }\n\n    return strategy;\n  };\n\n  /**\n   * Compose create position payload.\n   *\n   * @param {Object<string, any>} draftPosition React hook form submission values.\n   * @returns {any} Create position payload.\n   */\n  const composePositionPayload = (draftPosition) => {\n    const exchangeName = selectedExchange.exchangeName || selectedExchange.name || \"\";\n    const buyTTL = parseFloat(draftPosition.entryExpiration);\n    const sellTTL = parseFloat(draftPosition.autoclose);\n\n    return {\n      pair: selectedSymbol.zignalyId,\n      positionSizeQuote: selectedSymbol.unitsInvestment,\n      side: mapSideToEnum(draftPosition.entryType),\n      stopLossPercentage:\n        draftPosition.stopLossPercentage !== undefined\n          ? parseFloat(draftPosition.stopLossPercentage)\n          : false,\n      stopLossPrice: parseFloat(draftPosition.stopLossPrice),\n      stopLossPriority: draftPosition.stopLossPriority || \"percentage\",\n      stopLossFollowsTakeProfit: draftPosition.stopLossType === \"stopLossFollowsTakeProfit\",\n      stopLossToBreakEven: draftPosition.stopLossType === \"stopLossToBreakEven\",\n      buyTTL: minToSeconds(buyTTL) || false,\n      buyStopPrice: parseFloat(draftPosition.stopPrice) || 0,\n      sellByTTL: hourToSeconds(sellTTL) || 0,\n      takeProfitTargets: composePositionTakeProfitTargets(draftPosition),\n      reBuyTargets: composePositionDcaTargets(draftPosition),\n      trailingStopTriggerPercentage:\n        draftPosition.trailingStopPercentage !== undefined\n          ? parseFloat(draftPosition.trailingStopPercentage)\n          : false,\n      trailingStopTriggerPrice: parseFloat(draftPosition.trailingStopPrice) || false,\n      trailingStopPercentage: parseFloat(draftPosition.trailingStopDistance) || false,\n      trailingStopTriggerPriority: draftPosition.trailingStopTriggerPriority || \"percentage\",\n      providerId: 1,\n      providerName: \"Manual Trading\",\n      exchangeName: exchangeName,\n      internalExchangeId: selectedExchange.internalId,\n      postOnly: draftPosition.postOnly,\n    };\n  };\n\n  /**\n   * Compose create position payload.\n   *\n   * @param {Object<string, any>} draftPosition React hook form submission values.\n   * @returns {CreatePositionPayload} Create position payload.\n   */\n  const composeCreatePositionPayload = (draftPosition) => {\n    return assign(composePositionPayload(draftPosition), composePositionStrategy(draftPosition), {\n      leverage: parseInt(draftPosition.leverage) || 1,\n      marginMode: draftPosition.marginMode || \"\",\n    });\n  };\n\n  /**\n   * Compose update position payload.\n   *\n   * @param {Object<string, any>} draftPosition React hook form submission values.\n   * @returns {UpdatePositionPayload} Update position payload.\n   */\n  const composeUpdatePositionPayload = (draftPosition) => {\n    const { quote } = selectedSymbol;\n    const isIncreaseUpdate = draftPosition.positionSize || draftPosition.positionSizePercentage;\n    const positionStrategy = isIncreaseUpdate ? composePositionStrategy(draftPosition) : {};\n\n    return assign(\n      {\n        positionSizeQuote: quote,\n        side: mapSideToEnum(draftPosition.entryType),\n        stopLossPercentage:\n          draftPosition.stopLossPercentage !== undefined\n            ? parseFloat(draftPosition.stopLossPercentage)\n            : false,\n        stopLossPrice: parseFloat(draftPosition.stopLossPrice),\n        stopLossPriority: draftPosition.stopLossPriority || \"percentage\",\n        stopLossFollowsTakeProfit: draftPosition.stopLossType === \"stopLossFollowsTakeProfit\",\n        stopLossToBreakEven: draftPosition.stopLossType === \"stopLossToBreakEven\",\n        buyStopPrice: parseFloat(draftPosition.stopPrice) || 0,\n        takeProfitTargets:\n          !draftPosition.reduceTargetPercentage && composePositionTakeProfitTargets(draftPosition),\n        reBuyTargets: composePositionDcaTargets(draftPosition),\n        trailingStopTriggerPercentage:\n          draftPosition.trailingStopPercentage !== undefined\n            ? parseFloat(draftPosition.trailingStopPercentage)\n            : false,\n        trailingStopPercentage: parseFloat(draftPosition.trailingStopDistance) || false,\n        trailingStopTriggerPrice: parseFloat(draftPosition.trailingStopPrice) || false,\n        trailingStopTriggerPriority: draftPosition.trailingStopTriggerPriority || \"percentage\",\n        providerId: 1,\n        providerName: \"Manual Trading\",\n        internalExchangeId: positionEntity.internalExchangeId,\n        positionId: positionEntity.positionId,\n        reduceTargetPercentage: parseFloat(draftPosition.reduceTargetPercentage),\n        reduceAvailablePercentage: parseFloat(draftPosition.reduceAvailablePercentage),\n        reduceOrderType: draftPosition.reduceOrderType,\n        reduceRecurring: draftPosition.reduceRecurring,\n        reducePersistent: draftPosition.reducePersistent,\n        removeReduceRecurringPersistent: draftPosition.reduceRecurringPersistent === false,\n        removeReduceOrder: draftPosition.removeReduceOrder,\n        postOnly: draftPosition.postOnly,\n      },\n      positionStrategy,\n    );\n  };\n\n  /**\n   * Submit manual position create request to Trade API.\n   *\n   * @param {CreatePositionPayload} payload Create position payload.\n   * @return {Void} None.\n   */\n  const createPosition = (payload) => {\n    setProcessing(true);\n    tradeApi\n      .manualPositionCreate(payload)\n      .then((positionId) => {\n        reset();\n        dispatch(showSuccessAlert(\"\", formatMessage({ id: \"terminal.open.success\" })));\n        // mixpanelPositionCreated();\n        navigate(`/position/${positionId}`);\n      })\n      .catch((e) => {\n        dispatch(showErrorAlert(e));\n      })\n      .finally(() => {\n        setProcessing(false);\n      });\n  };\n\n  /**\n   * Submit manual position update request to Trade API.\n   *\n   * @param {UpdatePositionPayload} payload Update position payload.\n   * @return {Void} None.\n   */\n  const updatePosition = (payload) => {\n    setProcessing(true);\n\n    tradeApi\n      .manualPositionUpdate(payload)\n      .then(() => {\n        dispatch(\n          showSuccessAlert(\n            \"terminal.updated.title\",\n            formatMessage(\n              { id: \"terminal.updated.body\" },\n              { positionId: positionEntity.positionId },\n            ),\n          ),\n        );\n        notifyPositionUpdate();\n      })\n      .catch((e) => {\n        dispatch(showErrorAlert(e));\n      })\n      .finally(() => {\n        setProcessing(false);\n      });\n  };\n\n  /**\n   * Handle create position form submission.\n   *\n   * @param {Object<string, any>} draftPosition React hook form submission values.\n   * @returns {Void} None.\n   */\n  const onSubmit = (draftPosition) => {\n    if (positionEntity) {\n      const payload = composeUpdatePositionPayload(draftPosition);\n      updatePosition(payload);\n    } else {\n      const payload = composeCreatePositionPayload(draftPosition);\n      createPosition(payload);\n    }\n  };\n\n  const updatePriceField = () => {\n    // Update price (selected symbol changed)\n    setValue(\"price\", lastPrice);\n    // Multi order\n    setValue(\"priceShort\", lastPrice);\n  };\n  useEffect(updatePriceField, [lastPrice]);\n\n  // Use position buyPrice for edit or strategy price for create position.\n  const strategyPrice = watch(\"price\");\n  const entryPrice = positionEntity ? positionEntity.buyPrice : parseFloat(strategyPrice);\n  const drawEntryPriceLine = () => {\n    drawLine({\n      id: \"price\",\n      price: entryPrice || 0,\n      label: formatMessage({ id: \"terminal.line.price.label\" }),\n      color: colors.purple,\n    });\n  };\n  useEffect(drawEntryPriceLine, [strategyPrice]);\n\n  const stopLossPrice = watch(\"stopLossPrice\");\n  const drawStopLossPriceLine = () => {\n    const price = parseFloat(stopLossPrice);\n    if (price) {\n      drawLine({\n        id: \"stopLossPrice\",\n        price: price || 0,\n        label: formatMessage({ id: \"terminal.line.stoploss.label\" }),\n        color: colors.yellow,\n      });\n    } else {\n      removeLine(\"stopLossPrice\");\n    }\n  };\n  useEffect(drawStopLossPriceLine, [stopLossPrice]);\n\n  const trailingStopPrice = watch(\"trailingStopPrice\");\n  const drawTrailingStopPriceLine = () => {\n    const price = parseFloat(trailingStopPrice);\n    if (price) {\n      drawLine({\n        id: \"trailingStopPrice\",\n        price: price || 0,\n        label: formatMessage({ id: \"terminal.line.trailingstop.label\" }),\n        color: colors.blue,\n      });\n    } else {\n      removeLine(\"trailingStopPrice\");\n    }\n  };\n  useEffect(drawTrailingStopPriceLine, [trailingStopPrice]);\n\n  const targetGroupIndexes = concat(range(1, 51, 1), range(1000, 1051, 1));\n  const takeProfitFields = targetGroupIndexes.map((id) => `takeProfitTargetPrice${id}`);\n  const takeProfitTargetPrices = watch(takeProfitFields);\n  const drawTakeProfitTargetPriceLines = () => {\n    forIn(takeProfitTargetPrices, (/** @type {string} */ targetPrice, targetFieldName) => {\n      const index = targetFieldName.substr(targetFieldName.length - 1);\n      const price = parseFloat(targetPrice);\n      if (price) {\n        drawLine({\n          id: targetFieldName,\n          price: price || 0,\n          label: formatMessage({ id: \"terminal.line.takeprofit.label\" }, { index: index }),\n          color: colors.green,\n        });\n      } else {\n        removeLine(targetFieldName);\n      }\n    });\n  };\n  useEffect(drawTakeProfitTargetPriceLines, [takeProfitTargetPrices]);\n\n  const dcaTargetPercentage1 = watch(\"dcaTargetPricePercentage1\");\n  const drawDCATargetPriceLines = () => {\n    const percentage = parseFloat(dcaTargetPercentage1);\n    if (dcaTargetPercentage1) {\n      const dcaTargetPrice1 = calculateDcaPrice(entryPrice, percentage);\n      drawLine({\n        id: \"dcaTargetPricePercentage1\",\n        price: Number(formatPrice(dcaTargetPrice1, \"\", \"\")) || 0,\n        label: formatMessage({ id: \"terminal.line.dca.label\" }, { index: 1 }),\n        color: colors.black,\n      });\n    } else {\n      removeLine(\"dcaTargetPricePercentage1\");\n    }\n  };\n  useEffect(drawDCATargetPriceLines, [dcaTargetPercentage1]);\n\n  const isClosed = positionEntity ? positionEntity.closed : false;\n  const isCopy = positionEntity ? positionEntity.isCopyTrading : false;\n  const isCopyTrader = positionEntity\n    ? positionEntity.providerOwnerUserId === storeUserData.userId\n    : false;\n  const isUpdating = positionEntity ? positionEntity.updating : false;\n  const isOpening = positionEntity ? positionEntity.status === 1 : false;\n  const isReadOnly = (isCopy && !isCopyTrader) || isClosed || isUpdating || isOpening;\n\n  return (\n    <Box bgcolor=\"grid.content\" className=\"strategyForm\" textAlign=\"center\">\n      <form method=\"post\" onSubmit={handleSubmit(onSubmit)}>\n        {isPositionView ? (\n          <SidebarEditPanels\n            isReadOnly={isReadOnly}\n            positionEntity={positionEntity}\n            selectedSymbol={selectedSymbol}\n          />\n        ) : (\n          <SidebarCreatePanels selectedSymbol={selectedSymbol} />\n        )}\n        {!isReadOnly && (\n          <CustomButton\n            className={\"full submitButton\"}\n            disabled={!isEmpty(errors) || processing}\n            loading={processing}\n            type=\"submit\"\n          >\n            {isPositionView ? (\n              <FormattedMessage id=\"terminal.update\" />\n            ) : (\n              <FormattedMessage id=\"terminal.open\" />\n            )}\n          </CustomButton>\n        )}\n      </form>\n    </Box>\n  );\n};\n\nexport default React.memo(StrategyForm);\n","import React, { useContext, useEffect, useState } from \"react\";\nimport { size } from \"lodash\";\nimport { Box, Typography } from \"@material-ui/core\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\nimport { Controller, useFormContext } from \"react-hook-form\";\nimport CustomSelect from \"../../CustomSelect/CustomSelect\";\nimport useOwnCopyTraderProviders from \"../../../hooks/useOwnCopyTraderProviders\";\nimport useStoreSettingsSelector from \"../../../hooks/useStoreSettingsSelector\";\nimport { setTerminalProvider, setTerminalPair } from \"../../../store/actions/settings\";\nimport { useDispatch } from \"react-redux\";\nimport useEffectSkipFirst from \"../../../hooks/useEffectSkipFirst\";\nimport TradingViewContext from \"./TradingViewContext\";\nimport useSelectedExchange from \"hooks/useSelectedExchange\";\n\n/**\n * @typedef {import(\"../../../services/tradeApiClient.types\").MarketSymbolsCollection} MarketSymbolsCollection\n */\n/**\n * @typedef {Object} TradingViewHeaderProps\n * @property {MarketSymbolsCollection} symbolsList\n * @property {function} handleSymbolChange\n * @property {string} selectedSymbol\n */\n\n/**\n * Trading view header component.\n *\n * @param {TradingViewHeaderProps} props Component props.\n * @returns {JSX.Element} Trading view header element.\n */\nconst TradingViewHeader = (props) => {\n  const { symbolsList, handleSymbolChange, selectedSymbol } = props;\n  const { control, watch } = useFormContext();\n  const { ownCopyTraderProviders } = useOwnCopyTraderProviders();\n  const { formatMessage } = useIntl();\n  const storeSettings = useStoreSettingsSelector();\n  const dispatch = useDispatch();\n  const { providerService, setProviderService } = useContext(TradingViewContext);\n  const providerId = watch(\"providerService\");\n  const [symbolsOptions, setSymbolsOptions] = useState(null);\n  const selectedExchange = useSelectedExchange();\n\n  const providerOptions = ownCopyTraderProviders.map((provider) => {\n    return {\n      label: provider.providerName,\n      val: String(provider.providerId),\n    };\n  });\n\n  // Filter valid symbols\n  const filterSymbols = () => {\n    return symbolsList.reduce((result, symbol) => {\n      let valid = true;\n      // Check if symbol can be used for selected provider\n      if (\n        providerService &&\n        providerId &&\n        providerId !== \"1\" &&\n        selectedExchange.exchangeName.toLowerCase() !== \"bitmex\"\n      ) {\n        const { providerQuote } = providerService;\n        if (!providerQuote && !symbol.short.includes(\"/\" + providerQuote)) {\n          valid = false;\n        }\n      }\n\n      if (valid) {\n        result.push(symbol.short);\n      }\n      return result;\n    }, []);\n  };\n\n  // Select saved provider or default to first option\n  const initialProviderId = providerOptions.find(\n    (o) => o.val === storeSettings.tradingTerminal.provider,\n  )\n    ? storeSettings.tradingTerminal.provider\n    : providerOptions[0]\n    ? providerOptions[0].val\n    : \"\";\n\n  useEffect(() => {\n    // Update current provider service to context\n    if (!ownCopyTraderProviders) return;\n\n    const provider = ownCopyTraderProviders.find((p) => p.providerId === providerId) || {\n      providerPayableBalance: 0,\n      providerConsumedBalance: 0,\n      providerConsumedBalancePercentage: 0,\n      providerName: formatMessage({\n        id: \"terminal.provider.manual\",\n      }),\n      providerQuote: \"\",\n      providerId: \"1\",\n    };\n    setProviderService(provider);\n  }, [providerId, ownCopyTraderProviders]);\n\n  useEffect(() => {\n    // Filter symbols matching provider\n    if (symbolsList) {\n      setSymbolsOptions(filterSymbols());\n    }\n  }, [providerId]);\n\n  // Save filters to store when changed\n  const saveSelectedSymbol = () => {\n    dispatch(\n      setTerminalPair({\n        exchangeId: selectedExchange.exchangeId,\n        pair: selectedSymbol,\n      }),\n    );\n  };\n  useEffectSkipFirst(saveSelectedSymbol, [selectedSymbol]);\n\n  return (\n    <Box bgcolor=\"grid.content\" className=\"controlsBar\" display=\"flex\" flexDirection=\"row\">\n      {providerService && symbolsOptions && (\n        <>\n          <Box\n            alignContent=\"left\"\n            className=\"symbolsSelector\"\n            display=\"flex\"\n            flexDirection=\"column\"\n          >\n            <Typography variant=\"body1\">\n              <FormattedMessage id=\"terminal.browsecoins\" />\n            </Typography>\n            <CustomSelect\n              label=\"\"\n              onChange={handleSymbolChange}\n              options={symbolsOptions}\n              search={true}\n              value={selectedSymbol}\n            />\n          </Box>\n          {size(ownCopyTraderProviders) > 1 && (\n            <Box\n              alignContent=\"left\"\n              className=\"providersSelector\"\n              display=\"flex\"\n              flexDirection=\"column\"\n            >\n              <Typography variant=\"body1\">\n                <FormattedMessage id=\"terminal.providers\" />\n              </Typography>\n              <Controller\n                control={control}\n                defaultValue={initialProviderId}\n                name=\"providerService\"\n                render={({ onChange, value }) => (\n                  <CustomSelect\n                    label=\"\"\n                    onChange={(/** @type {string} **/ v) => {\n                      // Save provider settings\n                      dispatch(setTerminalProvider(v));\n                      onChange(v);\n                    }}\n                    options={providerOptions}\n                    value={value}\n                  />\n                )}\n              />\n            </Box>\n          )}\n        </>\n      )}\n    </Box>\n  );\n};\n\nexport default TradingViewHeader;\n","// @ts-nocheck\n/* eslint-disable */\nfunction e(t, i) { const n = Object.assign({}, t); for (const o in i) \"object\" != typeof t[o] || null === t[o] || Array.isArray(t[o]) ? void 0 !== i[o] && (n[o] = i[o]) : n[o] = e(t[o], i[o]); return n } const t = { mobile: { disabled_features: [\"left_toolbar\", \"header_widget\", \"timeframes_toolbar\", \"edit_buttons_in_legend\", \"context_menus\", \"control_bar\", \"border_around_the_chart\"], enabled_features: [] } }, i = { width: 800, height: 500, interval: \"1D\", timezone: \"Etc/UTC\", container: \"\", library_path: \"\", locale: \"en\", widgetbar: { details: !1, watchlist: !1, watchlist_settings: { default_symbols: [] } }, overrides: { \"mainSeriesProperties.showCountdown\": !1 }, studies_overrides: {}, trading_customization: { position: {}, order: {} }, brokerConfig: { configFlags: {} }, fullscreen: !1, autosize: !1, disabled_features: [], enabled_features: [], debug: !1, logo: {}, time_frames: [{ text: \"5y\", resolution: \"1W\" }, { text: \"1y\", resolution: \"1W\" }, { text: \"6m\", resolution: \"120\" }, { text: \"3m\", resolution: \"60\" }, { text: \"1m\", resolution: \"30\" }, { text: \"5d\", resolution: \"5\" }, { text: \"1d\", resolution: \"1\" }], client_id: \"0\", user_id: \"0\", charts_storage_api_version: \"1.0\", favorites: { intervals: [], chartTypes: [] } }; function n() { return \"CL v20.030 (internal id 93881eb6 @ 2021-10-01T13:05:17.158Z)\" } const o = class { constructor(n) { if (this._id = `tradingview_${(1048576 * (1 + Math.random()) | 0).toString(16).substring(1)}`, this._ready = !1, this._readyHandlers = [], this._onWindowResize = this._autoResizeChart.bind(this), !n.datafeed) throw new Error(\"Datafeed is not defined\"); if (this._options = e(i, n), n.preset) { const e = t[n.preset]; e ? (void 0 !== this._options.disabled_features ? this._options.disabled_features = this._options.disabled_features.concat(e.disabled_features) : this._options.disabled_features = e.disabled_features, void 0 !== this._options.enabled_features ? this._options.enabled_features = this._options.enabled_features.concat(e.enabled_features) : this._options.enabled_features = e.enabled_features) : console.warn(\"Unknown preset: `\" + n.preset + \"`\") } \"Dark\" === this._options.theme && void 0 === this._options.loading_screen && (this._options.loading_screen = { backgroundColor: \"#131722\" }), this._create() } onChartReady(e) { this._ready ? e.call(this) : this._readyHandlers.push(e) } headerReady() { return this._innerWindowLoaded.then((() => this._innerWindow().headerReady())) } onGrayedObjectClicked(e) { this._innerAPI().onGrayedObjectClicked(e) } onShortcut(e, t) { this._innerWindow().createShortcutAction(e, t) } subscribe(e, t) { this._innerAPI().subscribe(e, t) } unsubscribe(e, t) { this._innerAPI().unsubscribe(e, t) } chart(e) { return this._innerAPI().chart(e) } getLanguage() { return this._options.locale } setSymbol(e, t, i) { this._innerAPI().changeSymbol(e, t, i) } remove() { window.removeEventListener(\"resize\", this._onWindowResize), this._readyHandlers.splice(0, this._readyHandlers.length), delete window[this._id], this._iFrame.parentNode && this._iFrame.parentNode.removeChild(this._iFrame) } closePopupsAndDialogs() { this._innerAPI().closePopupsAndDialogs() } selectLineTool(e) { this._innerAPI().selectLineTool(e) } selectedLineTool() { return this._innerAPI().selectedLineTool() } save(e) { this._innerAPI().saveChart(e) } load(e, t) { this._innerAPI().loadChart({ json: e, extendedData: t }) } getSavedCharts(e) { this._innerAPI().getSavedCharts(e) } loadChartFromServer(e) { this._innerAPI().loadChartFromServer(e) } saveChartToServer(e, t, i) { this._innerAPI().saveChartToServer(e, t, i) } removeChartFromServer(e, t) { this._innerAPI().removeChartFromServer(e, t) } onContextMenu(e) { this._innerAPI().onContextMenu(e) } createButton(e) { return this._innerWindow().createButton(e) } showNoticeDialog(e) { this._innerAPI().showNoticeDialog(e) } showConfirmDialog(e) { this._innerAPI().showConfirmDialog(e) } showLoadChartDialog() { this._innerAPI().showLoadChartDialog() } showSaveAsChartDialog() { this._innerAPI().showSaveAsChartDialog() } symbolInterval() { return this._innerAPI().getSymbolInterval() } mainSeriesPriceFormatter() { return this._innerAPI().mainSeriesPriceFormatter() } getIntervals() { return this._innerAPI().getIntervals() } getStudiesList() { return this._innerAPI().getStudiesList() } addCustomCSSFile(e) { this._innerWindow().addCustomCSSFile(e) } applyOverrides(t) { this._options = e(this._options, { overrides: t }), this._innerWindow().applyOverrides(t) } applyStudiesOverrides(e) { this._innerWindow().applyStudiesOverrides(e) } watchList() { return this._innerAPI().watchlist() } activeChart() { return this._innerAPI().activeChart() } chartsCount() { return this._innerAPI().chartsCount() } layout() { return this._innerAPI().layout() } setLayout(e) { this._innerAPI().setLayout(e) } layoutName() { return this._innerAPI().layoutName() } changeTheme(e, t) { this._innerWindow().changeTheme(e, t) } getTheme() { return this._innerWindow().getTheme() } takeScreenshot() { this._innerAPI().takeScreenshot() } lockAllDrawingTools() { return this._innerAPI().lockAllDrawingTools() } hideAllDrawingTools() { return this._innerAPI().hideAllDrawingTools() } drawOnAllCharts(e) { this._innerAPI().drawOnAllCharts(e) } magnetEnabled() { return this._innerAPI().magnetEnabled() } magnetMode() { return this._innerAPI().magnetMode() } undoRedoState() { return this._innerAPI().undoRedoState() } setIntervalLinkingEnabled(e) { this._innerAPI().setIntervalLinkingEnabled(e) } setTimeFrame(e) { this._innerAPI().setTimeFrame(e) } symbolSync() { return this._innerAPI().symbolSync() } intervalSync() { return this._innerAPI().intervalSync() } crosshairSync() { return this._innerAPI().crosshairSync() } timeSync() { return this._innerAPI().timeSync() } getAllFeatures() { return this._innerWindow().getAllFeatures() } clearUndoHistory() { return this._innerAPI().clearUndoHistory() } undo() { return this._innerAPI().undo() } redo() { return this._innerAPI().redo() } startFullscreen() { this._innerAPI().startFullscreen() } exitFullscreen() { this._innerAPI().exitFullscreen() } takeClientScreenshot(e) { return this._innerAPI().takeClientScreenshot(e) } _innerAPI() { return this._innerWindow().tradingViewApi } _innerWindow() { return this._iFrame.contentWindow } _autoResizeChart() { this._options.fullscreen && (this._iFrame.style.height = window.innerHeight + \"px\") } _create() { const e = this._render(); this._options.container_id && console.warn(\"`container_id` is now deprecated. Please use `container` instead to either still pass a string or an `HTMLElement`.\"); const t = this._options.container_id || this._options.container, i = \"string\" == typeof t ? document.getElementById(t) : t; if (null === i) throw new Error(`There is no such element - #${this._options.container}`); i.innerHTML = e, this._iFrame = i.querySelector(`#${this._id}`); const n = this._iFrame; (this._options.autosize || this._options.fullscreen) && (n.style.width = \"100%\", this._options.fullscreen || (n.style.height = \"100%\")), window.addEventListener(\"resize\", this._onWindowResize), this._onWindowResize(), this._innerWindowLoaded = new Promise((e => { const t = () => { n.removeEventListener(\"load\", t, !1), e() }; n.addEventListener(\"load\", t, !1) })), this._innerWindowLoaded.then((() => { this._innerWindow().widgetReady((() => { this._ready = !0; for (const t of this._readyHandlers) try { t.call(this) } catch (e) { console.error(e) } this._innerWindow().initializationFinished() })) })) } _render() { const e = window; if (e[this._id] = { datafeed: this._options.datafeed, customFormatters: this._options.custom_formatters || this._options.customFormatters, brokerFactory: this._options.broker_factory || this._options.brokerFactory, overrides: this._options.overrides, studiesOverrides: this._options.studies_overrides, tradingCustomization: this._options.trading_customization, disabledFeatures: this._options.disabled_features, enabledFeatures: this._options.enabled_features, brokerConfig: this._options.broker_config || this._options.brokerConfig, restConfig: this._options.restConfig, favorites: this._options.favorites, logo: this._options.logo, numeric_formatting: this._options.numeric_formatting, rss_news_feed: this._options.rss_news_feed, newsProvider: this._options.news_provider, loadLastChart: this._options.load_last_chart, saveLoadAdapter: this._options.save_load_adapter, loading_screen: this._options.loading_screen, settingsAdapter: this._options.settings_adapter, getCustomIndicators: this._options.custom_indicators_getter, additionalSymbolInfoFields: this._options.additional_symbol_info_fields, headerWidgetButtonsMode: this._options.header_widget_buttons_mode }, this._options.saved_data) e[this._id].chartContent = { json: this._options.saved_data }, this._options.saved_data_meta_info && (e[this._id].chartContentExtendedData = this._options.saved_data_meta_info); else if (!this._options.load_last_chart && !this._options.symbol) throw new Error(\"Symbol is not defined: either 'symbol' or 'load_last_chart' option must be set\"); const t = (this._options.library_path || \"\") + `${encodeURIComponent(this._options.locale)}-tv-chart.93881eb6.html#symbol=` + encodeURIComponent(this._options.symbol || \"\") + \"&interval=\" + encodeURIComponent(this._options.interval) + (this._options.timeframe ? \"&timeframe=\" + encodeURIComponent(this._options.timeframe) : \"\") + (this._options.toolbar_bg ? \"&toolbarbg=\" + encodeURIComponent(this._options.toolbar_bg.replace(\"#\", \"\")) : \"\") + (this._options.studies_access ? \"&studiesAccess=\" + encodeURIComponent(JSON.stringify(this._options.studies_access)) : \"\") + \"&widgetbar=\" + encodeURIComponent(JSON.stringify(this._options.widgetbar)) + (this._options.drawings_access ? \"&drawingsAccess=\" + encodeURIComponent(JSON.stringify(this._options.drawings_access)) : \"\") + \"&timeFrames=\" + encodeURIComponent(JSON.stringify(this._options.time_frames)) + \"&locale=\" + encodeURIComponent(this._options.locale) + \"&uid=\" + encodeURIComponent(this._id) + \"&clientId=\" + encodeURIComponent(String(this._options.client_id)) + \"&userId=\" + encodeURIComponent(String(this._options.user_id)) + (this._options.charts_storage_url ? \"&chartsStorageUrl=\" + encodeURIComponent(this._options.charts_storage_url) : \"\") + (this._options.charts_storage_api_version ? \"&chartsStorageVer=\" + encodeURIComponent(this._options.charts_storage_api_version) : \"\") + (this._options.custom_css_url ? \"&customCSS=\" + encodeURIComponent(this._options.custom_css_url) : \"\") + (this._options.auto_save_delay ? \"&autoSaveDelay=\" + encodeURIComponent(String(this._options.auto_save_delay)) : \"\") + \"&debug=\" + encodeURIComponent(String(this._options.debug)) + (this._options.snapshot_url ? \"&snapshotUrl=\" + encodeURIComponent(this._options.snapshot_url) : \"\") + (this._options.timezone ? \"&timezone=\" + encodeURIComponent(this._options.timezone) : \"\") + (this._options.study_count_limit ? \"&studyCountLimit=\" + encodeURIComponent(String(this._options.study_count_limit)) : \"\") + (this._options.symbol_search_request_delay ? \"&ssreqdelay=\" + encodeURIComponent(String(this._options.symbol_search_request_delay)) : \"\") + (this._options.compare_symbols ? \"&compareSymbols=\" + encodeURIComponent(JSON.stringify(this._options.compare_symbols)) : \"\") + (this._options.theme ? \"&theme=\" + encodeURIComponent(String(this._options.theme)) : \"\") + (this._options.header_widget_buttons_mode ? \"&header_widget_buttons_mode=\" + encodeURIComponent(String(this._options.header_widget_buttons_mode)) : \"\") + (this._options.time_scale ? \"&time_scale=\" + encodeURIComponent(JSON.stringify(this._options.time_scale)) : \"\"); return '<iframe id=\"' + this._id + '\" name=\"' + this._id + '\"  src=\"' + t + '\"' + (this._options.autosize || this._options.fullscreen ? \"\" : ' width=\"' + this._options.width + '\" height=\"' + this._options.height + '\"') + ' frameborder=\"0\" allowTransparency=\"true\" scrolling=\"no\" allowfullscreen style=\"display:block;\"></iframe>' } }; window.TradingView = window.TradingView || {}, window.TradingView.version = n; export { n as version, o as widget };\n","import { useState, useEffect, useRef } from \"react\";\nimport { isString, isObject, isNumber } from \"lodash\";\nimport { widget as PrivateTradingViewWidget } from \"tradingView/charting_library/charting_library.esm\";\nimport { getTradingViewExchangeSymbol } from \"tradingView/tradingViewOptions\";\nimport { formatPrice } from \"utils/formatters\";\n\n/**\n *\n * @typedef {import(\"tradingView/charting_library/charting_library\").IBasicDataFeed} IBasicDataFeed\n * @typedef {import(\"tradingView/charting_library/charting_library\").ChartingLibraryWidgetOptions} ChartingLibraryWidgetOptions\n * @typedef {import(\"../services/tradeApiClient.types\").ExchangeConnectionEntity} ExchangeConnectionEntity\n */\n\n/**\n * @typedef {Object} TradingTerminalHook\n * @property {function} instantiateWidget\n * @property {function} changeSymbol\n * @property {function} removeWidget\n * @property {any} tradingViewWidget\n * @property {boolean} isSelfHosted\n */\n\n/**\n * @typedef {any} TVWidget\n */\n\n/**\n * Trading terminal handlers and state control hook.\n *\n * @param {function} setLastPrice Update last price callback.\n * @returns {TradingTerminalHook} Trading View hook object.\n */\nconst useTradingTerminal = (setLastPrice) => {\n  const [tradingView, setTradingView] = useState({\n    widget: null,\n    options: null,\n    isSelfHosted: false,\n  });\n  const readyCallback = useRef(null);\n\n  /**\n   * Instantiate external trading view library\n   *\n   * @param {ChartingLibraryWidgetOptions} widgetOptions Trading view widget options.\n   * @return {void}\n   */\n  const instantiateExternalLibrary = (widgetOptions) => {\n    // @ts-ignore\n    // eslint-disable-next-line new-cap\n    const externalWidget = new window.TradingView.widget(widgetOptions);\n\n    let eventSymbol = \"\";\n    // @ts-ignore\n    const handleWidgetReady = (event) => {\n      if (isString(event.data)) {\n        try {\n          const dataParsed = JSON.parse(event.data);\n          // @ts-ignore\n          if (dataParsed.name === \"widgetReady\") {\n            setTradingView({\n              widget: externalWidget,\n              options: widgetOptions,\n              isSelfHosted: false,\n            });\n          }\n\n          if (dataParsed.name === \"quoteUpdate\" && dataParsed.data) {\n            if (eventSymbol !== dataParsed.data.original_name) {\n              const receivedPrice = isNumber(dataParsed.data.last_price)\n                ? formatPrice(dataParsed.data.last_price, \"\", \"\")\n                : dataParsed.data.last_price;\n              setLastPrice(receivedPrice);\n              eventSymbol = dataParsed.data.original_name;\n            }\n          }\n        } catch (e) {\n          // Not a valid JSON, skip event.\n          return;\n        }\n      }\n\n      // Symbol data not found by Trading View widget.\n      if (isObject(event.data) && event.data.name === \"tv-widget-no-data\") {\n        setTradingView({\n          widget: externalWidget,\n          options: widgetOptions,\n          isSelfHosted: false,\n        });\n        setLastPrice(null);\n      }\n    };\n    readyCallback.current = handleWidgetReady;\n    window.addEventListener(\"message\", handleWidgetReady);\n  };\n\n  /**\n   * Instantiate trading view widget and initialize price.\n   *\n   * @param {ChartingLibraryWidgetOptions} widgetOptions Trading view widget options.\n   * @return {void}\n   */\n  const instantiateWidget = (widgetOptions) => {\n    const isSelfHosted = Boolean(widgetOptions.datafeed);\n\n    if (isSelfHosted) {\n      // @ts-ignore\n      const widgetInstance = new PrivateTradingViewWidget(widgetOptions);\n      // window.externalWidget = widgetInstance;\n      widgetInstance.onChartReady(() => {\n        setTradingView({\n          widget: widgetInstance,\n          options: widgetOptions,\n          isSelfHosted: true,\n        });\n        // Update price\n        // @ts-ignore\n        const price = widgetOptions.datafeed.getLastPrice();\n        setLastPrice(parseFloat(price));\n      });\n    } else {\n      // @ts-ignore\n      const isLibraryLoaded = () => Boolean(window.TradingView && window.TradingView.widget);\n\n      const checkExist = setInterval(() => {\n        // Wait until external library is loaded before initializing\n        if (isLibraryLoaded()) {\n          instantiateExternalLibrary(widgetOptions);\n          clearInterval(checkExist);\n        }\n      }, 100);\n    }\n  };\n\n  /**\n   * Update TradingView selected symbol\n   * @param {string} symbol .\n   * @param {ExchangeConnectionEntity} exchange Exchange connection entity.\n   * @returns {void}\n   */\n  const changeSymbol = (symbol, exchange) => {\n    if (!tradingView.widget || (!tradingView.isSelfHosted && !tradingView.widget.iframe)) {\n      // eslint-disable-next-line no-console\n      console.error(\"LOG: tradingViewWidget wasn't initialized before symbol change\");\n      return;\n    }\n\n    if (tradingView.widget.iframe) {\n      const symbolTV = getTradingViewExchangeSymbol(symbol, exchange);\n      tradingView.widget.iframe.contentWindow.postMessage(\n        { name: \"set-symbol\", data: { symbol: symbolTV } },\n        \"*\",\n      );\n    } else {\n      const chart = tradingView.widget.chart();\n      chart.setSymbol(symbol, () => {\n        // @ts-ignore\n        const price = tradingView.options.datafeed.getLastPrice();\n        setLastPrice(parseFloat(price));\n      });\n    }\n  };\n\n  useEffect(() => {\n    const cleanupWidget = () => {\n      if (readyCallback.current) {\n        window.removeEventListener(\"message\", readyCallback.current);\n        readyCallback.current = null;\n      }\n      if (tradingView.widget) {\n        removeWidget();\n      }\n    };\n    return cleanupWidget;\n  }, []);\n\n  const removeWidget = () => {\n    if (tradingView && tradingView.widget) {\n      tradingView.widget.remove();\n    }\n    setTradingView((tv) => ({ ...tv, widget: null }));\n  };\n\n  return {\n    instantiateWidget,\n    tradingViewWidget: tradingView.widget,\n    changeSymbol,\n    removeWidget,\n    isSelfHosted: tradingView.isSelfHosted,\n  };\n};\n\nexport default useTradingTerminal;\n","import { useState } from \"react\";\n\n/**\n * @typedef {import(\"components/TradingTerminal/TradingView/TradingViewContext\").TradingViewContext} TradingViewContext\n */\n\n/**\n * Handle the state management for the trading view data that is shared via context.\n *\n * @returns {TradingViewContext} Modal path state object.\n */\nconst useTradingViewContext = () => {\n  const [providerService, setProviderService] = useState(null);\n  const [updatedAt, setUpdatedAt] = useState(null);\n  const [lastPrice, setLastPrice] = useState(null);\n\n  return {\n    providerService,\n    setProviderService,\n    updatedAt,\n    setUpdatedAt,\n    lastPrice,\n    setLastPrice,\n  };\n};\n\nexport default useTradingViewContext;\n","import React, { useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { FormProvider, useForm } from \"react-hook-form\";\nimport tradeApi from \"../../../services/tradeApiClient\";\nimport { createWidgetOptions } from \"../../../tradingView/tradingViewOptions\";\nimport StrategyForm from \"../StrategyForm/StrategyForm\";\nimport { Box, CircularProgress, Typography } from \"@material-ui/core\";\nimport TradingViewHeader from \"./TradingViewHeader\";\nimport useStoreSettingsSelector from \"../../../hooks/useStoreSettingsSelector\";\nimport { useStoreUserSelector } from \"../../../hooks/useStoreUserSelector\";\nimport { showErrorAlert } from \"../../../store/actions/ui\";\nimport ConnectExchange from \"../../Modal/ConnectExchange\";\nimport useTradingTerminal from \"../../../hooks/useTradingTerminal\";\nimport \"./TradingView.scss\";\nimport TradingViewContext from \"./TradingViewContext\";\nimport useTradingViewContext from \"hooks/useTradingViewContext\";\nimport useSelectedExchange from \"hooks/useSelectedExchange\";\n\n/**\n * @typedef {any} TVWidget\n * @typedef {import('../../../services/tradeApiClient.types').MarketSymbol} MarketSymbol\n * @typedef {import('../../../services/tradeApiClient.types').MarketSymbolsCollection} MarketSymbolsCollection\n */\n\n/**\n * @type {Object<string, string>}\n */\nconst defaultExchangeSymbol = {\n  kucoin: \"BTC/USDT\",\n  binance: \"BTC/USDT\",\n  zignaly: \"BTC/USDT\",\n  bitmex: \"XBTUSD\",\n  fallback: \"BTC/USDT\",\n};\n\n/**\n * Trading terminal component.\n *\n * @returns {JSX.Element} Trading terminal element.\n */\nconst TradingView = () => {\n  const tradingViewContext = useTradingViewContext();\n  const { lastPrice, setLastPrice } = tradingViewContext;\n  const { instantiateWidget, tradingViewWidget, changeSymbol, removeWidget, isSelfHosted } =\n    useTradingTerminal(setLastPrice);\n  const storeSettings = useStoreSettingsSelector();\n  const [symbols, setSymbols] = useState(/** @type {MarketSymbolsCollection} */ (null));\n  const dispatch = useDispatch();\n  const selectedExchange = useSelectedExchange();\n\n  const getMarketData = async () => {\n    const marketDataPayload = {\n      exchangeInternalId: selectedExchange.internalId,\n    };\n\n    try {\n      const data = await tradeApi.exchangeConnectionMarketDataGet(marketDataPayload);\n      setSymbols(data);\n    } catch (e) {\n      dispatch(showErrorAlert(e));\n    }\n  };\n\n  /**\n   * Resolve exchange name from selected exchange.\n   *\n   * @returns {string} Exchange name.\n   */\n  const resolveExchangeName = () => {\n    return selectedExchange.exchangeName || selectedExchange.name;\n  };\n\n  const exchangeName = resolveExchangeName();\n\n  /**\n   * Get symbol data\n   * @param {string} symbol Symbol\n   * @returns {MarketSymbol} Symbol data\n   */\n  const resolveSymbolData = (symbol) =>\n    symbol && symbols ? symbols.find((d) => d.short === symbol) : null;\n\n  /**\n   * Resolve last selected or default symbol for selected exchange.\n   *\n   * In case of not default symbol for the exchange resolves BTCUSDT.\n   *\n   * @returns {MarketSymbol} Symbol ID.\n   */\n  const defaultSelectedSymbol = () => {\n    const symbolOptions = [\n      storeSettings.tradingTerminal.pair[selectedExchange.exchangeId],\n      defaultExchangeSymbol[exchangeName.toLowerCase()],\n      defaultExchangeSymbol.fallback,\n    ];\n    for (const s of symbolOptions) {\n      if (s) {\n        const symbolData = resolveSymbolData(s);\n        if (symbolData) {\n          return symbolData;\n        }\n      }\n    }\n    return null;\n  };\n  const [selectedSymbol, setSelectedSymbol] = useState(/** @type {MarketSymbol} */ (null));\n  useEffect(() => {\n    // Load default symbol when symbols are ready\n    if (symbols) {\n      setSelectedSymbol(defaultSelectedSymbol());\n    }\n  }, [symbols]);\n\n  const [selectedExchangeId, setSelectedExchangeId] = useState(selectedExchange.internalId);\n  const isLoading = tradingViewWidget === null || selectedSymbol === null;\n  const isLastPriceLoading = lastPrice === null;\n\n  const onExchangeChange = () => {\n    // Load dependencies\n    setSymbols(null);\n    setSelectedSymbol(null);\n    getMarketData();\n\n    // Reload widget on exchange change\n    if (selectedExchangeId !== selectedExchange.internalId) {\n      setLastPrice(null);\n      removeWidget();\n      setSelectedExchangeId(selectedExchangeId);\n    }\n  };\n  useEffect(onExchangeChange, [selectedExchangeId]);\n\n  useEffect(() => {\n    // Reload widget on theme change\n    removeWidget();\n    bootstrapWidget();\n  }, [storeSettings.darkStyle]);\n\n  const bootstrapWidget = () => {\n    // Initialize widget when symbols loaded or when instance removed\n    if (!selectedSymbol || tradingViewWidget) {\n      return;\n    }\n\n    const options = {\n      exchange: selectedExchange,\n      symbolsData: symbols,\n      symbol: selectedSymbol.tradeViewSymbol,\n      darkStyle: storeSettings.darkStyle,\n    };\n\n    const widgetOptions = createWidgetOptions(options);\n    instantiateWidget(widgetOptions);\n  };\n\n  // Create Trading View widget when TV external library is ready.\n  useEffect(bootstrapWidget, [tradingViewWidget, selectedSymbol]);\n\n  useEffect(() => {\n    if (isSelfHosted || !tradingViewWidget) return;\n\n    // Force initial price notification.\n    const checkExist = setInterval(() => {\n      if (\n        tradingViewWidget &&\n        tradingViewWidget.iframe &&\n        tradingViewWidget.iframe.contentWindow &&\n        selectedSymbol\n      ) {\n        changeSymbol(selectedSymbol.tradeViewSymbol, selectedExchange);\n        clearInterval(checkExist);\n      }\n    }, 100);\n  }, [tradingViewWidget]);\n\n  /**\n   * @typedef {Object} OptionValue\n   * @property {string} label\n   * @property {string} value\n   */\n\n  /**\n   * Change selected symbol.\n   *\n   * @param {string} selectedOption Selected symbol option object.\n   * @returns {Void} None.\n   */\n  const handleSymbolChange = (selectedOption) => {\n    const newSymbol = resolveSymbolData(selectedOption);\n    setSelectedSymbol(newSymbol);\n    changeSymbol(newSymbol.tradeViewSymbol, selectedExchange);\n  };\n\n  const methods = useForm({\n    mode: \"onChange\",\n    defaultValues: {\n      entryType: \"LONG\",\n      leverage: 1,\n      positionSize: \"\",\n      realInvestment: \"\",\n      stopLossPrice: \"\",\n      trailingStopPrice: \"\",\n      units: \"\",\n      dcaTargetPricePercentage1: \"\",\n    },\n  });\n\n  return (\n    <TradingViewContext.Provider value={tradingViewContext}>\n      <FormProvider {...methods}>\n        <Box className=\"tradingTerminal\" display=\"flex\" flexDirection=\"column\" width={1}>\n          {!isLoading && (\n            <TradingViewHeader\n              handleSymbolChange={handleSymbolChange}\n              selectedSymbol={selectedSymbol.short}\n              symbolsList={symbols}\n            />\n          )}\n          <Box\n            className=\"tradingViewContainer\"\n            display=\"flex\"\n            flexDirection=\"row\"\n            flexWrap=\"wrap\"\n            width={1}\n          >\n            {isLoading && (\n              <Box\n                className=\"loadProgress\"\n                display=\"flex\"\n                flexDirection=\"row\"\n                justifyContent=\"center\"\n              >\n                <CircularProgress disableShrink />\n              </Box>\n            )}\n            <Box className=\"tradingViewChart\">\n              <div id=\"trading_view_chart\" />\n              {!isLoading && (\n                <Typography color=\"textSecondary\">\n                  <a\n                    href={`https://www.tradingview.com/symbols/${selectedSymbol.tradeViewSymbol}`}\n                    target=\"_blank\"\n                    rel=\"noreferrer\"\n                  >\n                    {selectedSymbol.symbol} by TradingView\n                  </a>\n                </Typography>\n              )}\n            </Box>\n            {!isLoading && !isLastPriceLoading && lastPrice && (\n              <StrategyForm\n                lastPrice={lastPrice}\n                selectedSymbol={selectedSymbol}\n                tradingViewWidget={tradingViewWidget}\n              />\n            )}\n          </Box>\n        </Box>\n      </FormProvider>\n    </TradingViewContext.Provider>\n  );\n};\n\nconst TradingViewWrapper = () => {\n  const selectedExchange = useSelectedExchange();\n  const storeUser = useStoreUserSelector();\n\n  if (!storeUser.loaded) {\n    return (\n      <Box\n        alignItems=\"center\"\n        className=\"loadingBox\"\n        display=\"flex\"\n        flexDirection=\"row\"\n        justifyContent=\"center\"\n      >\n        <CircularProgress size={50} />\n      </Box>\n    );\n  }\n\n  if (!selectedExchange.internalId) {\n    return <ConnectExchange />;\n  }\n\n  return <TradingView />;\n};\n\nexport default React.memo(TradingViewWrapper);\n","import React, { useEffect, useState } from \"react\";\nimport { isArray, isEqual, pick } from \"lodash\";\nimport { FormProvider, useForm } from \"react-hook-form\";\nimport { createWidgetOptions } from \"../../../tradingView/tradingViewOptions\";\nimport tradeApi from \"../../../services/tradeApiClient\";\nimport StrategyForm from \"../StrategyForm/StrategyForm\";\nimport { Box, CircularProgress, Typography } from \"@material-ui/core\";\nimport PositionsTable from \"../../Dashboard/PositionsTable/PositionsTable\";\nimport { useDispatch } from \"react-redux\";\nimport { showErrorAlert, showSuccessAlert } from \"../../../store/actions/ui\";\nimport useStoreSettingsSelector from \"../../../hooks/useStoreSettingsSelector\";\nimport {\n  useStoreUserData,\n  useStoreUserExchangeConnections,\n} from \"../../../hooks/useStoreUserSelector\";\nimport useTradingTerminal from \"../../../hooks/useTradingTerminal\";\nimport \"./TradingView.scss\";\nimport {\n  createExchangeConnectionEmptyEntity,\n  createMarketSymbolEmptyValueObject,\n} from \"../../../services/tradeApiClient.types\";\nimport TradingViewContext from \"./TradingViewContext\";\nimport useTradingViewContext from \"hooks/useTradingViewContext\";\nimport CustomButton from \"components/CustomButton\";\nimport useSelectedExchange from \"hooks/useSelectedExchange\";\n\n/**\n * @typedef {any} TVWidget\n * @typedef {import(\"../../../services/tradeApiClient.types\").UserPositionsCollection} UserPositionsCollection\n * @typedef {import(\"../../../services/tradeApiClient.types\").MarketSymbolsCollection} MarketSymbolsCollection\n * @typedef {import(\"../../../services/tradeApiClient.types\").DefaultProviderGetObject} ProviderEntity\n * @typedef {import(\"../../../hooks/usePositionsList\").PositionsCollectionType} PositionsCollectionType\n * @typedef {import('services/tradeApiClient.types').MarketSymbol} MarketSymbol\n */\n\n/**\n * @typedef {Object} TradingViewProps\n *\n * @property {string} positionId Position id (optional) for trading view edit mode.\n */\n\n/**\n * Trading terminal component.\n *\n * @param {TradingViewProps} props Component props.\n *\n * @returns {JSX.Element} Trading terminal element.\n */\nconst TradingViewEdit = (props) => {\n  const { positionId } = props;\n  const tradingViewContext = useTradingViewContext();\n  const { setLastPrice, lastPrice, setUpdatedAt } = tradingViewContext;\n  const { instantiateWidget, tradingViewWidget, isSelfHosted, changeSymbol, removeWidget } =\n    useTradingTerminal(setLastPrice);\n\n  const [positionEntity, setPosition] = useState(/** @type {Position} */ (null));\n  // Raw position entity (for debug)\n  const [positionRawData, setPositionRawData] = useState(/** @type {*} */ (null));\n  const [selectedSymbol, setSelectedSymbol] = useState(/** @type {MarketSymbol} */ (null));\n  const [recoverPositionLoading, setRecoverPositionLoading] = useState(false);\n  const [exchange, setExchange] = useState(createExchangeConnectionEmptyEntity());\n  const storeSettings = useStoreSettingsSelector();\n  const selectedExchange = useSelectedExchange();\n  const exchangeConnections = useStoreUserExchangeConnections();\n  const storeUserData = useStoreUserData();\n  const dispatch = useDispatch();\n\n  /**\n   * Initialize state variables that depend on loaded position.\n   *\n   * @param {Position} responseData Position entity retrieved from Trade API response.\n   * @returns {Void} None.\n   */\n  const initializePosition = (responseData) => {\n    setPosition(responseData);\n  };\n\n  /**\n   * Load position symbol exchange market data.\n   *\n   * @param {Position} positionData The position entity to load dependent data for.\n   *\n   * @returns {Void} None.\n   */\n  const getMarketData = (positionData) => {\n    const marketDataPayload = {\n      exchangeInternalId: positionData.exchangeInternalId,\n      exchange: positionData.exchange,\n      exchangeType: positionData.exchangeType,\n    };\n\n    tradeApi\n      .exchangeConnectionMarketDataGet(marketDataPayload)\n      .then((data) => {\n        let symbolData = data.find((d) => d.short === positionData.short);\n        if (!symbolData) {\n          // When symbol is delisted rely on position symbol data.\n          symbolData = {\n            ...createMarketSymbolEmptyValueObject(),\n            id: positionData.symbol,\n            base: positionData.base,\n            baseId: positionData.base,\n            quote: positionData.quote,\n            quoteId: positionData.quote,\n            short: positionData.short,\n            tradeViewSymbol: positionData.tradeViewSymbol,\n            // @ts-ignore\n            limits: {},\n          };\n        }\n        setSelectedSymbol(symbolData);\n      })\n      .catch((e) => {\n        dispatch(showErrorAlert(e));\n      });\n    // if (!positionData.closed) {\n    // } else {\n    //   // When position is closed avoid get market data and rely on position symbol data.\n    //   const symbolData = assign(createMarketSymbolEmptyValueObject(), {\n    //     id: positionData.symbol,\n    //     base: positionData.base,\n    //     baseId: positionData.base,\n    //     quote: positionData.quote,\n    //     quoteId: positionData.quote,\n    //     short: positionData.short,\n    //     tradeViewSymbol: positionData.tradeViewSymbol,\n    //     limits: {},\n    //   });\n    //   setSelectedSymbol(symbolData);\n    // }\n  };\n\n  /**\n   *\n   * @param {String} exchangeInternalId Exchange internal id.\n   * @returns {Void} None.\n   */\n  const filterExchange = (exchangeInternalId) => {\n    let found = exchangeConnections.find((item) => item.internalId === exchangeInternalId);\n    if (found) {\n      setExchange(found);\n    }\n  };\n\n  /**\n   * Fetch a position on position edit mode.\n   *\n   * @returns {Void} None.\n   */\n  const fetchPosition = () => {\n    const payload = {\n      positionId,\n      internalExchangeId: selectedExchange.internalId,\n    };\n\n    tradeApi\n      .positionGet(payload)\n      .then((data) => {\n        initializePosition(data);\n        getMarketData(data);\n        filterExchange(data.internalExchangeId);\n      })\n      .catch((e) => {\n        dispatch(showErrorAlert(e));\n      });\n\n    if (storeUserData.isAdmin) {\n      // Get position raw data for debug\n      tradeApi.positionRawGet(payload).then((data) => {\n        setPositionRawData(data);\n      });\n    }\n  };\n\n  useEffect(() => {\n    fetchPosition();\n  }, []);\n\n  useEffect(() => {\n    // Reload widget on theme change\n    removeWidget();\n    bootstrapWidget();\n  }, [storeSettings.darkStyle]);\n\n  /**\n   * Callback that to be notified when position updates are performed.\n   *\n   * @returns {Void} None.\n   */\n  const notifyPositionUpdate = () => {\n    fetchPosition();\n    setUpdatedAt(new Date());\n  };\n\n  const isDelisted = selectedSymbol === undefined;\n  const isLoading = !positionEntity || (!selectedSymbol && !isDelisted);\n\n  const bootstrapWidget = () => {\n    // Skip if TV widget already exists or TV library is not ready.\n    if (!selectedSymbol || tradingViewWidget) return;\n\n    const options = {\n      exchange: selectedExchange,\n      symbolsData: [selectedSymbol],\n      symbol: positionEntity.tradeViewSymbol,\n      darkStyle: storeSettings.darkStyle,\n    };\n\n    const widgetOptions = createWidgetOptions(options);\n    instantiateWidget(widgetOptions);\n  };\n\n  // Create Trading View widget when TV external library is ready.\n  useEffect(bootstrapWidget, [selectedSymbol, tradingViewWidget]);\n\n  // Force initial price notification.\n  const initDataFeedSymbol = () => {\n    if (isSelfHosted || !tradingViewWidget) return;\n\n    const checkExist = setInterval(() => {\n      if (\n        tradingViewWidget &&\n        tradingViewWidget.iframe &&\n        tradingViewWidget.iframe.contentWindow &&\n        selectedSymbol\n      ) {\n        changeSymbol(selectedSymbol.tradeViewSymbol, exchange);\n        clearInterval(checkExist);\n      }\n    }, 100);\n  };\n  useEffect(initDataFeedSymbol, [tradingViewWidget]);\n\n  const methods = useForm({\n    mode: \"onChange\",\n    defaultValues: {\n      entryType: \"LONG\",\n      leverage: 1,\n      positionSize: \"\",\n      realInvestment: \"\",\n      stopLossPrice: \"\",\n      trailingStopPrice: \"\",\n      units: \"\",\n      dcaTargetPricePercentage1: \"\",\n      dcaRebuyPercentage1: \"\",\n      priceDifference: 0,\n    },\n  });\n\n  /**\n   * Determine the current position status.\n   *\n   * @returns {PositionsCollectionType} Position type.\n   */\n  const getPositionStatusType = () => {\n    if (positionEntity.closed && positionEntity.type === \"closed\") {\n      return \"closed\";\n    } else if (positionEntity.closed && positionEntity.type === \"log\") {\n      return \"log\";\n    }\n\n    return \"open\";\n  };\n\n  /**\n   * Propagate position change when affect the edit panels read-only mode.\n   *\n   * @param {UserPositionsCollection} positionsList Positions fetch interval notification.\n   * @returns {Void} None.\n   */\n  const processPositionsUpdate = (positionsList) => {\n    if (isArray(positionsList)) {\n      const newPosition = positionsList[0];\n      const compareFields = [\n        \"updating\",\n        \"closed\",\n        \"status\",\n        \"reBuyTargets\",\n        \"positionSizeQuote\",\n        \"reduceOrders\",\n        // todo: we could use profitPercentage price here, to update validation for stop loss etc.\n        // If there are no more issues of panels reloading everytime.\n        // \"sellPrice\",\n      ];\n      const propagateChange = !isEqual(\n        pick(positionEntity, compareFields),\n        pick(newPosition, compareFields),\n      );\n\n      if (propagateChange) {\n        setPosition(newPosition);\n      }\n\n      // todo: doesn't seem to do anything\n      methods.setValue(\"priceDifference\", newPosition.priceDifference);\n    }\n  };\n\n  const recoverPositionAsSupportUser = () => {\n    setRecoverPositionLoading(true);\n    const payload = {\n      internalExchangeId: selectedExchange.internalId,\n      positionId: positionId,\n    };\n\n    tradeApi\n      .recoverPosition(payload)\n      .then(() => {\n        dispatch(showSuccessAlert(\"\", \"request submitted to recover position\"));\n      })\n      .catch((e) => {\n        dispatch(showErrorAlert(e));\n      })\n      .finally(() => {\n        setRecoverPositionLoading(false);\n      });\n  };\n\n  return (\n    <TradingViewContext.Provider value={tradingViewContext}>\n      <FormProvider {...methods}>\n        <Box className=\"tradingTerminal\" display=\"flex\" flexDirection=\"column\" width={1}>\n          {positionEntity && (\n            <PositionsTable\n              notifyPositionsUpdate={processPositionsUpdate}\n              positionEntity={positionEntity}\n              type={getPositionStatusType()}\n            />\n          )}\n          <Box\n            bgcolor=\"grid.content\"\n            className=\"tradingViewContainer\"\n            display=\"flex\"\n            flexDirection=\"row\"\n            flexWrap=\"wrap\"\n            width={1}\n          >\n            {isLoading && (\n              <Box\n                className=\"loadProgress\"\n                display=\"flex\"\n                flexDirection=\"row\"\n                justifyContent=\"center\"\n              >\n                <CircularProgress disableShrink />\n              </Box>\n            )}\n            <Box className=\"tradingViewChart\">\n              <div id=\"trading_view_chart\" />\n              {!isLoading && (\n                <Typography color=\"textSecondary\">\n                  <a\n                    href={`https://www.tradingview.com/symbols/${selectedSymbol.tradeViewSymbol}`}\n                    target=\"_blank\"\n                    rel=\"noreferrer\"\n                  >\n                    {selectedSymbol.symbol} by TradingView\n                  </a>\n                </Typography>\n              )}\n            </Box>\n            {!isLoading && (\n              <StrategyForm\n                lastPrice={lastPrice}\n                notifyPositionUpdate={notifyPositionUpdate}\n                positionEntity={positionEntity}\n                selectedSymbol={selectedSymbol}\n                tradingViewWidget={tradingViewWidget}\n              />\n            )}\n          </Box>\n          {storeUserData.isAdmin && positionId && (\n            <Box marginTop={2} maxWidth=\"300px\" minWidth=\"300px\">\n              <CustomButton\n                className=\"submitButton\"\n                loading={recoverPositionLoading}\n                onClick={recoverPositionAsSupportUser}\n              >\n                Recover Position\n              </CustomButton>\n            </Box>\n          )}\n          {positionRawData && (\n            <Box alignItems=\"center\" display=\"flex\" flexDirection=\"column\" mt=\"24px\">\n              <Typography variant=\"h6\">Debug</Typography>\n              <pre>{JSON.stringify(positionRawData, null, 2)}</pre>\n            </Box>\n          )}\n        </Box>\n      </FormProvider>\n    </TradingViewContext.Provider>\n  );\n};\n\nexport default React.memo(TradingViewEdit);\n","import { useState, useEffect } from \"react\";\nimport tradeApi from \"../services/tradeApiClient\";\nimport { useDispatch } from \"react-redux\";\nimport { showErrorAlert } from \"../store/actions/ui\";\n\n/**\n * @typedef {import(\"services/tradeApiClient.types\").ExchangeConnectionEntity} ExchangeConnectionEntity\n * @typedef {Object} HookData\n * @property {*} balance\n * @property {Boolean} loading\n */\n\n/**\n * Provides balance summary for exchange.\n * @param {ExchangeConnectionEntity} selectedExchange Exchange account object.\n * @param {boolean} [shouldExecute] Flag to indicate if we should execute the request, demo accounts are bypassed.\n * @returns {HookData} Balance.\n */\nconst useAvailableBalance = (selectedExchange, shouldExecute = true) => {\n  const [balance, setBalance] = useState({});\n  const [loading, setLoading] = useState(false);\n  const dispatch = useDispatch();\n\n  const loadData = () => {\n    // Skip balance fetch for paper trading exchanges.\n    if (selectedExchange.internalId && !selectedExchange.paperTrading && shouldExecute) {\n      setLoading(true);\n\n      tradeApi\n        .userAvailableBalanceGet(selectedExchange.internalId)\n        .then((data) => {\n          setBalance(data);\n        })\n        .catch((e) => {\n          dispatch(showErrorAlert(e));\n        })\n        .finally(() => {\n          setLoading(false);\n        });\n    }\n  };\n\n  useEffect(loadData, [selectedExchange.internalId]);\n\n  return { balance, loading };\n};\n\nexport default useAvailableBalance;\n","import { useState, useRef } from \"react\";\nimport { assign, isEqual } from \"lodash\";\nimport { setFilters as setFiltersAction } from \"../store/actions/settings\";\nimport { useDispatch } from \"react-redux\";\nimport { extractVal } from \"../components/CustomSelect\";\n\n/**\n * @typedef {import(\"../store/actions/settings\").Filter} Filter\n * @typedef {import(\"../components/CustomSelect/CustomSelect\").Option} Option\n */\n\n/**\n * @typedef {Object} UseFiltersOptions\n * @property {Object} defaultValues\n * @property {Object} storeValues\n * @property {Object} optionsFilters\n */\n\n/**\n * @typedef {Object} FiltersData\n * @property {function} clearFilters\n * @property {function} setFilters\n * @property {number} modifiedFilters\n * @property {Filter} filters\n */\n\n/**\n * Hook to handle filters update/saving.\n *\n * @param {Filter} defaultValues Default filter values\n * @param {Filter} [storeValues] Filter store object\n * @param {Object<string, Array<Option>>} [optionsFilters] Object with each available filter options\n * @param {string} [page] Page key\n * @returns {FiltersData} Filters data\n */\nconst useFilters = (\n  defaultValues,\n  storeValues,\n  optionsFilters,\n  page,\n  // eslint-disable-next-line max-params\n) => {\n  /**\n   * Initial filters values using the saved values or falling back to default if not in options values\n   * @returns {Filter} filters\n   */\n  const initialValues = () => {\n    /**\n     * @type {Filter}\n     */\n    // @ts-ignore\n    const values = {};\n    Object.keys(defaultValues).forEach((/** @type {keyof Filter} */ key) => {\n      values[key] = defaultValues[key];\n      if (storeValues && storeValues[key]) {\n        // Check that saved value is of correct type\n        const typeCorrect = typeof storeValues[key] === typeof defaultValues[key];\n        // Check if available options are loaded\n        const optionsReady = Boolean(optionsFilters[key] && optionsFilters[key].length);\n        // Check that saved value exists in options\n        const valueCorrect =\n          !optionsReady ||\n          optionsFilters[key].find((o) => extractVal(o) === extractVal(storeValues[key]));\n        if (typeCorrect && valueCorrect) {\n          values[key] = storeValues[key];\n        }\n      }\n    });\n    return values;\n  };\n  const [filters, setFilters] = useState(initialValues());\n  const dispatch = useDispatch();\n\n  // If options have changed then check the filters again right away\n  const lastOptionsFilters = useRef(optionsFilters);\n  let filtersChecked = filters;\n  if (!isEqual(lastOptionsFilters.current, optionsFilters)) {\n    filtersChecked = initialValues();\n    lastOptionsFilters.current = optionsFilters;\n    setFilters(filtersChecked);\n  }\n\n  const modifiedFilters = () => {\n    let count = 0;\n    Object.entries(filters).forEach((/** @type {[keyof Filter, string]} */ [key, value]) => {\n      if (value !== defaultValues[key]) {\n        count++;\n      }\n    });\n    return count;\n  };\n\n  /**\n   * Save filters to store\n   * @param {Filter} newFilters filters\n   * @returns {void}\n   */\n  const persistFilters = (newFilters) => {\n    dispatch(\n      setFiltersAction({\n        filters: newFilters,\n        // @ts-ignore\n        page,\n      }),\n    );\n  };\n\n  /**\n   * Combine external state filters with local state.\n   *\n   * @param {Filter} values External filter values.\n   *\n   * @returns {Void} None.\n   */\n  const combineFilters = (values) => {\n    const newFilters = assign({}, filters, values);\n    setFilters(newFilters);\n    persistFilters(newFilters);\n  };\n\n  const clearFilters = () => {\n    /**\n     * @type {Filter}\n     */\n    // @ts-ignore\n    const newFilters = {};\n    Object.keys(filters).forEach((/** @type {keyof Filter} */ key) => {\n      newFilters[key] = defaultValues[key];\n    });\n    setFilters(newFilters);\n    persistFilters(newFilters);\n  };\n\n  return {\n    filters: filtersChecked,\n    setFilters: combineFilters,\n    clearFilters,\n    modifiedFilters: modifiedFilters(),\n  };\n};\n\nexport default useFilters;\n","/**\n * A specialized version of `_.reduce` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {*} [accumulator] The initial value.\n * @param {boolean} [initAccum] Specify using the first element of `array` as\n *  the initial value.\n * @returns {*} Returns the accumulated value.\n */\nfunction arrayReduce(array, iteratee, accumulator, initAccum) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  if (initAccum && length) {\n    accumulator = array[++index];\n  }\n  while (++index < length) {\n    accumulator = iteratee(accumulator, array[index], index, array);\n  }\n  return accumulator;\n}\n\nmodule.exports = arrayReduce;\n","/** Used to match words composed of alphanumeric characters. */\nvar reAsciiWord = /[^\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7f]+/g;\n\n/**\n * Splits an ASCII `string` into an array of its words.\n *\n * @private\n * @param {string} The string to inspect.\n * @returns {Array} Returns the words of `string`.\n */\nfunction asciiWords(string) {\n  return string.match(reAsciiWord) || [];\n}\n\nmodule.exports = asciiWords;\n","/**\n * The base implementation of `_.gt` which doesn't coerce arguments.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if `value` is greater than `other`,\n *  else `false`.\n */\nfunction baseGt(value, other) {\n  return value > other;\n}\n\nmodule.exports = baseGt;\n","/**\n * The base implementation of `_.lt` which doesn't coerce arguments.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if `value` is less than `other`,\n *  else `false`.\n */\nfunction baseLt(value, other) {\n  return value < other;\n}\n\nmodule.exports = baseLt;\n","var basePickBy = require('./_basePickBy'),\n    hasIn = require('./hasIn');\n\n/**\n * The base implementation of `_.pick` without support for individual\n * property identifiers.\n *\n * @private\n * @param {Object} object The source object.\n * @param {string[]} paths The property paths to pick.\n * @returns {Object} Returns the new object.\n */\nfunction basePick(object, paths) {\n  return basePickBy(object, paths, function(value, path) {\n    return hasIn(object, path);\n  });\n}\n\nmodule.exports = basePick;\n","/**\n * The base implementation of `_.propertyOf` without support for deep paths.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyOf(object) {\n  return function(key) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nmodule.exports = basePropertyOf;\n","/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeCeil = Math.ceil,\n    nativeMax = Math.max;\n\n/**\n * The base implementation of `_.range` and `_.rangeRight` which doesn't\n * coerce arguments.\n *\n * @private\n * @param {number} start The start of the range.\n * @param {number} end The end of the range.\n * @param {number} step The value to increment or decrement by.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Array} Returns the range of numbers.\n */\nfunction baseRange(start, end, step, fromRight) {\n  var index = -1,\n      length = nativeMax(nativeCeil((end - start) / (step || 1)), 0),\n      result = Array(length);\n\n  while (length--) {\n    result[fromRight ? length : ++index] = start;\n    start += step;\n  }\n  return result;\n}\n\nmodule.exports = baseRange;\n","var baseEach = require('./_baseEach');\n\n/**\n * The base implementation of `_.some` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction baseSome(collection, predicate) {\n  var result;\n\n  baseEach(collection, function(value, index, collection) {\n    result = predicate(value, index, collection);\n    return !result;\n  });\n  return !!result;\n}\n\nmodule.exports = baseSome;\n","/**\n * The base implementation of `_.sum` and `_.sumBy` without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {number} Returns the sum.\n */\nfunction baseSum(array, iteratee) {\n  var result,\n      index = -1,\n      length = array.length;\n\n  while (++index < length) {\n    var current = iteratee(array[index]);\n    if (current !== undefined) {\n      result = result === undefined ? current : (result + current);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseSum;\n","var arrayMap = require('./_arrayMap');\n\n/**\n * The base implementation of `_.values` and `_.valuesIn` which creates an\n * array of `object` property values corresponding to the property names\n * of `props`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array} props The property names to get values for.\n * @returns {Object} Returns the array of property values.\n */\nfunction baseValues(object, props) {\n  return arrayMap(props, function(key) {\n    return object[key];\n  });\n}\n\nmodule.exports = baseValues;\n","var identity = require('./identity');\n\n/**\n * Casts `value` to `identity` if it's not a function.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Function} Returns cast function.\n */\nfunction castFunction(value) {\n  return typeof value == 'function' ? value : identity;\n}\n\nmodule.exports = castFunction;\n","var arrayReduce = require('./_arrayReduce'),\n    deburr = require('./deburr'),\n    words = require('./words');\n\n/** Used to compose unicode capture groups. */\nvar rsApos = \"['\\u2019]\";\n\n/** Used to match apostrophes. */\nvar reApos = RegExp(rsApos, 'g');\n\n/**\n * Creates a function like `_.camelCase`.\n *\n * @private\n * @param {Function} callback The function to combine each word.\n * @returns {Function} Returns the new compounder function.\n */\nfunction createCompounder(callback) {\n  return function(string) {\n    return arrayReduce(words(deburr(string).replace(reApos, '')), callback, '');\n  };\n}\n\nmodule.exports = createCompounder;\n","var baseRange = require('./_baseRange'),\n    isIterateeCall = require('./_isIterateeCall'),\n    toFinite = require('./toFinite');\n\n/**\n * Creates a `_.range` or `_.rangeRight` function.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new range function.\n */\nfunction createRange(fromRight) {\n  return function(start, end, step) {\n    if (step && typeof step != 'number' && isIterateeCall(start, end, step)) {\n      end = step = undefined;\n    }\n    // Ensure the sign of `-0` is preserved.\n    start = toFinite(start);\n    if (end === undefined) {\n      end = start;\n      start = 0;\n    } else {\n      end = toFinite(end);\n    }\n    step = step === undefined ? (start < end ? 1 : -1) : toFinite(step);\n    return baseRange(start, end, step, fromRight);\n  };\n}\n\nmodule.exports = createRange;\n","var toNumber = require('./toNumber');\n\n/**\n * Creates a function that performs a relational operation on two values.\n *\n * @private\n * @param {Function} operator The function to perform the operation.\n * @returns {Function} Returns the new relational operation function.\n */\nfunction createRelationalOperation(operator) {\n  return function(value, other) {\n    if (!(typeof value == 'string' && typeof other == 'string')) {\n      value = toNumber(value);\n      other = toNumber(other);\n    }\n    return operator(value, other);\n  };\n}\n\nmodule.exports = createRelationalOperation;\n","var basePropertyOf = require('./_basePropertyOf');\n\n/** Used to map Latin Unicode letters to basic Latin letters. */\nvar deburredLetters = {\n  // Latin-1 Supplement block.\n  '\\xc0': 'A',  '\\xc1': 'A', '\\xc2': 'A', '\\xc3': 'A', '\\xc4': 'A', '\\xc5': 'A',\n  '\\xe0': 'a',  '\\xe1': 'a', '\\xe2': 'a', '\\xe3': 'a', '\\xe4': 'a', '\\xe5': 'a',\n  '\\xc7': 'C',  '\\xe7': 'c',\n  '\\xd0': 'D',  '\\xf0': 'd',\n  '\\xc8': 'E',  '\\xc9': 'E', '\\xca': 'E', '\\xcb': 'E',\n  '\\xe8': 'e',  '\\xe9': 'e', '\\xea': 'e', '\\xeb': 'e',\n  '\\xcc': 'I',  '\\xcd': 'I', '\\xce': 'I', '\\xcf': 'I',\n  '\\xec': 'i',  '\\xed': 'i', '\\xee': 'i', '\\xef': 'i',\n  '\\xd1': 'N',  '\\xf1': 'n',\n  '\\xd2': 'O',  '\\xd3': 'O', '\\xd4': 'O', '\\xd5': 'O', '\\xd6': 'O', '\\xd8': 'O',\n  '\\xf2': 'o',  '\\xf3': 'o', '\\xf4': 'o', '\\xf5': 'o', '\\xf6': 'o', '\\xf8': 'o',\n  '\\xd9': 'U',  '\\xda': 'U', '\\xdb': 'U', '\\xdc': 'U',\n  '\\xf9': 'u',  '\\xfa': 'u', '\\xfb': 'u', '\\xfc': 'u',\n  '\\xdd': 'Y',  '\\xfd': 'y', '\\xff': 'y',\n  '\\xc6': 'Ae', '\\xe6': 'ae',\n  '\\xde': 'Th', '\\xfe': 'th',\n  '\\xdf': 'ss',\n  // Latin Extended-A block.\n  '\\u0100': 'A',  '\\u0102': 'A', '\\u0104': 'A',\n  '\\u0101': 'a',  '\\u0103': 'a', '\\u0105': 'a',\n  '\\u0106': 'C',  '\\u0108': 'C', '\\u010a': 'C', '\\u010c': 'C',\n  '\\u0107': 'c',  '\\u0109': 'c', '\\u010b': 'c', '\\u010d': 'c',\n  '\\u010e': 'D',  '\\u0110': 'D', '\\u010f': 'd', '\\u0111': 'd',\n  '\\u0112': 'E',  '\\u0114': 'E', '\\u0116': 'E', '\\u0118': 'E', '\\u011a': 'E',\n  '\\u0113': 'e',  '\\u0115': 'e', '\\u0117': 'e', '\\u0119': 'e', '\\u011b': 'e',\n  '\\u011c': 'G',  '\\u011e': 'G', '\\u0120': 'G', '\\u0122': 'G',\n  '\\u011d': 'g',  '\\u011f': 'g', '\\u0121': 'g', '\\u0123': 'g',\n  '\\u0124': 'H',  '\\u0126': 'H', '\\u0125': 'h', '\\u0127': 'h',\n  '\\u0128': 'I',  '\\u012a': 'I', '\\u012c': 'I', '\\u012e': 'I', '\\u0130': 'I',\n  '\\u0129': 'i',  '\\u012b': 'i', '\\u012d': 'i', '\\u012f': 'i', '\\u0131': 'i',\n  '\\u0134': 'J',  '\\u0135': 'j',\n  '\\u0136': 'K',  '\\u0137': 'k', '\\u0138': 'k',\n  '\\u0139': 'L',  '\\u013b': 'L', '\\u013d': 'L', '\\u013f': 'L', '\\u0141': 'L',\n  '\\u013a': 'l',  '\\u013c': 'l', '\\u013e': 'l', '\\u0140': 'l', '\\u0142': 'l',\n  '\\u0143': 'N',  '\\u0145': 'N', '\\u0147': 'N', '\\u014a': 'N',\n  '\\u0144': 'n',  '\\u0146': 'n', '\\u0148': 'n', '\\u014b': 'n',\n  '\\u014c': 'O',  '\\u014e': 'O', '\\u0150': 'O',\n  '\\u014d': 'o',  '\\u014f': 'o', '\\u0151': 'o',\n  '\\u0154': 'R',  '\\u0156': 'R', '\\u0158': 'R',\n  '\\u0155': 'r',  '\\u0157': 'r', '\\u0159': 'r',\n  '\\u015a': 'S',  '\\u015c': 'S', '\\u015e': 'S', '\\u0160': 'S',\n  '\\u015b': 's',  '\\u015d': 's', '\\u015f': 's', '\\u0161': 's',\n  '\\u0162': 'T',  '\\u0164': 'T', '\\u0166': 'T',\n  '\\u0163': 't',  '\\u0165': 't', '\\u0167': 't',\n  '\\u0168': 'U',  '\\u016a': 'U', '\\u016c': 'U', '\\u016e': 'U', '\\u0170': 'U', '\\u0172': 'U',\n  '\\u0169': 'u',  '\\u016b': 'u', '\\u016d': 'u', '\\u016f': 'u', '\\u0171': 'u', '\\u0173': 'u',\n  '\\u0174': 'W',  '\\u0175': 'w',\n  '\\u0176': 'Y',  '\\u0177': 'y', '\\u0178': 'Y',\n  '\\u0179': 'Z',  '\\u017b': 'Z', '\\u017d': 'Z',\n  '\\u017a': 'z',  '\\u017c': 'z', '\\u017e': 'z',\n  '\\u0132': 'IJ', '\\u0133': 'ij',\n  '\\u0152': 'Oe', '\\u0153': 'oe',\n  '\\u0149': \"'n\", '\\u017f': 's'\n};\n\n/**\n * Used by `_.deburr` to convert Latin-1 Supplement and Latin Extended-A\n * letters to basic Latin letters.\n *\n * @private\n * @param {string} letter The matched letter to deburr.\n * @returns {string} Returns the deburred letter.\n */\nvar deburrLetter = basePropertyOf(deburredLetters);\n\nmodule.exports = deburrLetter;\n","var flatten = require('./flatten'),\n    overRest = require('./_overRest'),\n    setToString = require('./_setToString');\n\n/**\n * A specialized version of `baseRest` which flattens the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @returns {Function} Returns the new function.\n */\nfunction flatRest(func) {\n  return setToString(overRest(func, undefined, flatten), func + '');\n}\n\nmodule.exports = flatRest;\n","/** Used to detect strings that need a more robust regexp to match words. */\nvar reHasUnicodeWord = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;\n\n/**\n * Checks if `string` contains a word composed of Unicode symbols.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {boolean} Returns `true` if a word is found, else `false`.\n */\nfunction hasUnicodeWord(string) {\n  return reHasUnicodeWord.test(string);\n}\n\nmodule.exports = hasUnicodeWord;\n","/** Used to compose unicode character classes. */\nvar rsAstralRange = '\\\\ud800-\\\\udfff',\n    rsComboMarksRange = '\\\\u0300-\\\\u036f',\n    reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f',\n    rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff',\n    rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange,\n    rsDingbatRange = '\\\\u2700-\\\\u27bf',\n    rsLowerRange = 'a-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xff',\n    rsMathOpRange = '\\\\xac\\\\xb1\\\\xd7\\\\xf7',\n    rsNonCharRange = '\\\\x00-\\\\x2f\\\\x3a-\\\\x40\\\\x5b-\\\\x60\\\\x7b-\\\\xbf',\n    rsPunctuationRange = '\\\\u2000-\\\\u206f',\n    rsSpaceRange = ' \\\\t\\\\x0b\\\\f\\\\xa0\\\\ufeff\\\\n\\\\r\\\\u2028\\\\u2029\\\\u1680\\\\u180e\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200a\\\\u202f\\\\u205f\\\\u3000',\n    rsUpperRange = 'A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde',\n    rsVarRange = '\\\\ufe0e\\\\ufe0f',\n    rsBreakRange = rsMathOpRange + rsNonCharRange + rsPunctuationRange + rsSpaceRange;\n\n/** Used to compose unicode capture groups. */\nvar rsApos = \"['\\u2019]\",\n    rsBreak = '[' + rsBreakRange + ']',\n    rsCombo = '[' + rsComboRange + ']',\n    rsDigits = '\\\\d+',\n    rsDingbat = '[' + rsDingbatRange + ']',\n    rsLower = '[' + rsLowerRange + ']',\n    rsMisc = '[^' + rsAstralRange + rsBreakRange + rsDigits + rsDingbatRange + rsLowerRange + rsUpperRange + ']',\n    rsFitz = '\\\\ud83c[\\\\udffb-\\\\udfff]',\n    rsModifier = '(?:' + rsCombo + '|' + rsFitz + ')',\n    rsNonAstral = '[^' + rsAstralRange + ']',\n    rsRegional = '(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}',\n    rsSurrPair = '[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]',\n    rsUpper = '[' + rsUpperRange + ']',\n    rsZWJ = '\\\\u200d';\n\n/** Used to compose unicode regexes. */\nvar rsMiscLower = '(?:' + rsLower + '|' + rsMisc + ')',\n    rsMiscUpper = '(?:' + rsUpper + '|' + rsMisc + ')',\n    rsOptContrLower = '(?:' + rsApos + '(?:d|ll|m|re|s|t|ve))?',\n    rsOptContrUpper = '(?:' + rsApos + '(?:D|LL|M|RE|S|T|VE))?',\n    reOptMod = rsModifier + '?',\n    rsOptVar = '[' + rsVarRange + ']?',\n    rsOptJoin = '(?:' + rsZWJ + '(?:' + [rsNonAstral, rsRegional, rsSurrPair].join('|') + ')' + rsOptVar + reOptMod + ')*',\n    rsOrdLower = '\\\\d*(?:1st|2nd|3rd|(?![123])\\\\dth)(?=\\\\b|[A-Z_])',\n    rsOrdUpper = '\\\\d*(?:1ST|2ND|3RD|(?![123])\\\\dTH)(?=\\\\b|[a-z_])',\n    rsSeq = rsOptVar + reOptMod + rsOptJoin,\n    rsEmoji = '(?:' + [rsDingbat, rsRegional, rsSurrPair].join('|') + ')' + rsSeq;\n\n/** Used to match complex or compound words. */\nvar reUnicodeWord = RegExp([\n  rsUpper + '?' + rsLower + '+' + rsOptContrLower + '(?=' + [rsBreak, rsUpper, '$'].join('|') + ')',\n  rsMiscUpper + '+' + rsOptContrUpper + '(?=' + [rsBreak, rsUpper + rsMiscLower, '$'].join('|') + ')',\n  rsUpper + '?' + rsMiscLower + '+' + rsOptContrLower,\n  rsUpper + '+' + rsOptContrUpper,\n  rsOrdUpper,\n  rsOrdLower,\n  rsDigits,\n  rsEmoji\n].join('|'), 'g');\n\n/**\n * Splits a Unicode `string` into an array of its words.\n *\n * @private\n * @param {string} The string to inspect.\n * @returns {Array} Returns the words of `string`.\n */\nfunction unicodeWords(string) {\n  return string.match(reUnicodeWord) || [];\n}\n\nmodule.exports = unicodeWords;\n","var capitalize = require('./capitalize'),\n    createCompounder = require('./_createCompounder');\n\n/**\n * Converts `string` to [camel case](https://en.wikipedia.org/wiki/CamelCase).\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category String\n * @param {string} [string=''] The string to convert.\n * @returns {string} Returns the camel cased string.\n * @example\n *\n * _.camelCase('Foo Bar');\n * // => 'fooBar'\n *\n * _.camelCase('--foo-bar--');\n * // => 'fooBar'\n *\n * _.camelCase('__FOO_BAR__');\n * // => 'fooBar'\n */\nvar camelCase = createCompounder(function(result, word, index) {\n  word = word.toLowerCase();\n  return result + (index ? capitalize(word) : word);\n});\n\nmodule.exports = camelCase;\n","var arrayPush = require('./_arrayPush'),\n    baseFlatten = require('./_baseFlatten'),\n    copyArray = require('./_copyArray'),\n    isArray = require('./isArray');\n\n/**\n * Creates a new array concatenating `array` with any additional arrays\n * and/or values.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Array\n * @param {Array} array The array to concatenate.\n * @param {...*} [values] The values to concatenate.\n * @returns {Array} Returns the new concatenated array.\n * @example\n *\n * var array = [1];\n * var other = _.concat(array, 2, [3], [[4]]);\n *\n * console.log(other);\n * // => [1, 2, 3, [4]]\n *\n * console.log(array);\n * // => [1]\n */\nfunction concat() {\n  var length = arguments.length;\n  if (!length) {\n    return [];\n  }\n  var args = Array(length - 1),\n      array = arguments[0],\n      index = length;\n\n  while (index--) {\n    args[index - 1] = arguments[index];\n  }\n  return arrayPush(isArray(array) ? copyArray(array) : [array], baseFlatten(args, 1));\n}\n\nmodule.exports = concat;\n","var deburrLetter = require('./_deburrLetter'),\n    toString = require('./toString');\n\n/** Used to match Latin Unicode letters (excluding mathematical operators). */\nvar reLatin = /[\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\xff\\u0100-\\u017f]/g;\n\n/** Used to compose unicode character classes. */\nvar rsComboMarksRange = '\\\\u0300-\\\\u036f',\n    reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f',\n    rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff',\n    rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange;\n\n/** Used to compose unicode capture groups. */\nvar rsCombo = '[' + rsComboRange + ']';\n\n/**\n * Used to match [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks) and\n * [combining diacritical marks for symbols](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks_for_Symbols).\n */\nvar reComboMark = RegExp(rsCombo, 'g');\n\n/**\n * Deburrs `string` by converting\n * [Latin-1 Supplement](https://en.wikipedia.org/wiki/Latin-1_Supplement_(Unicode_block)#Character_table)\n * and [Latin Extended-A](https://en.wikipedia.org/wiki/Latin_Extended-A)\n * letters to basic Latin letters and removing\n * [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks).\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category String\n * @param {string} [string=''] The string to deburr.\n * @returns {string} Returns the deburred string.\n * @example\n *\n * _.deburr('dj vu');\n * // => 'deja vu'\n */\nfunction deburr(string) {\n  string = toString(string);\n  return string && string.replace(reLatin, deburrLetter).replace(reComboMark, '');\n}\n\nmodule.exports = deburr;\n","var baseFlatten = require('./_baseFlatten');\n\n/**\n * Flattens `array` a single level deep.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to flatten.\n * @returns {Array} Returns the new flattened array.\n * @example\n *\n * _.flatten([1, [2, [3, [4]], 5]]);\n * // => [1, 2, [3, [4]], 5]\n */\nfunction flatten(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? baseFlatten(array, 1) : [];\n}\n\nmodule.exports = flatten;\n","var baseFor = require('./_baseFor'),\n    castFunction = require('./_castFunction'),\n    keysIn = require('./keysIn');\n\n/**\n * Iterates over own and inherited enumerable string keyed properties of an\n * object and invokes `iteratee` for each property. The iteratee is invoked\n * with three arguments: (value, key, object). Iteratee functions may exit\n * iteration early by explicitly returning `false`.\n *\n * @static\n * @memberOf _\n * @since 0.3.0\n * @category Object\n * @param {Object} object The object to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Object} Returns `object`.\n * @see _.forInRight\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.forIn(new Foo, function(value, key) {\n *   console.log(key);\n * });\n * // => Logs 'a', 'b', then 'c' (iteration order is not guaranteed).\n */\nfunction forIn(object, iteratee) {\n  return object == null\n    ? object\n    : baseFor(object, castFunction(iteratee), keysIn);\n}\n\nmodule.exports = forIn;\n","var baseGt = require('./_baseGt'),\n    createRelationalOperation = require('./_createRelationalOperation');\n\n/**\n * Checks if `value` is greater than `other`.\n *\n * @static\n * @memberOf _\n * @since 3.9.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if `value` is greater than `other`,\n *  else `false`.\n * @see _.lt\n * @example\n *\n * _.gt(3, 1);\n * // => true\n *\n * _.gt(3, 3);\n * // => false\n *\n * _.gt(1, 3);\n * // => false\n */\nvar gt = createRelationalOperation(baseGt);\n\nmodule.exports = gt;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar numberTag = '[object Number]';\n\n/**\n * Checks if `value` is classified as a `Number` primitive or object.\n *\n * **Note:** To exclude `Infinity`, `-Infinity`, and `NaN`, which are\n * classified as numbers, use the `_.isFinite` method.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a number, else `false`.\n * @example\n *\n * _.isNumber(3);\n * // => true\n *\n * _.isNumber(Number.MIN_VALUE);\n * // => true\n *\n * _.isNumber(Infinity);\n * // => true\n *\n * _.isNumber('3');\n * // => false\n */\nfunction isNumber(value) {\n  return typeof value == 'number' ||\n    (isObjectLike(value) && baseGetTag(value) == numberTag);\n}\n\nmodule.exports = isNumber;\n","/**\n * Gets the last element of `array`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to query.\n * @returns {*} Returns the last element of `array`.\n * @example\n *\n * _.last([1, 2, 3]);\n * // => 3\n */\nfunction last(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? array[length - 1] : undefined;\n}\n\nmodule.exports = last;\n","var baseLt = require('./_baseLt'),\n    createRelationalOperation = require('./_createRelationalOperation');\n\n/**\n * Checks if `value` is less than `other`.\n *\n * @static\n * @memberOf _\n * @since 3.9.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if `value` is less than `other`,\n *  else `false`.\n * @see _.gt\n * @example\n *\n * _.lt(1, 3);\n * // => true\n *\n * _.lt(3, 3);\n * // => false\n *\n * _.lt(3, 1);\n * // => false\n */\nvar lt = createRelationalOperation(baseLt);\n\nmodule.exports = lt;\n","var basePick = require('./_basePick'),\n    flatRest = require('./_flatRest');\n\n/**\n * Creates an object composed of the picked `object` properties.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The source object.\n * @param {...(string|string[])} [paths] The property paths to pick.\n * @returns {Object} Returns the new object.\n * @example\n *\n * var object = { 'a': 1, 'b': '2', 'c': 3 };\n *\n * _.pick(object, ['a', 'c']);\n * // => { 'a': 1, 'c': 3 }\n */\nvar pick = flatRest(function(object, paths) {\n  return object == null ? {} : basePick(object, paths);\n});\n\nmodule.exports = pick;\n","var createRange = require('./_createRange');\n\n/**\n * Creates an array of numbers (positive and/or negative) progressing from\n * `start` up to, but not including, `end`. A step of `-1` is used if a negative\n * `start` is specified without an `end` or `step`. If `end` is not specified,\n * it's set to `start` with `start` then set to `0`.\n *\n * **Note:** JavaScript follows the IEEE-754 standard for resolving\n * floating-point values which can produce unexpected results.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {number} [start=0] The start of the range.\n * @param {number} end The end of the range.\n * @param {number} [step=1] The value to increment or decrement by.\n * @returns {Array} Returns the range of numbers.\n * @see _.inRange, _.rangeRight\n * @example\n *\n * _.range(4);\n * // => [0, 1, 2, 3]\n *\n * _.range(-4);\n * // => [0, -1, -2, -3]\n *\n * _.range(1, 5);\n * // => [1, 2, 3, 4]\n *\n * _.range(0, 20, 5);\n * // => [0, 5, 10, 15]\n *\n * _.range(0, -4, -1);\n * // => [0, -1, -2, -3]\n *\n * _.range(1, 4, 0);\n * // => [1, 1, 1]\n *\n * _.range(0);\n * // => []\n */\nvar range = createRange();\n\nmodule.exports = range;\n","var arraySome = require('./_arraySome'),\n    baseIteratee = require('./_baseIteratee'),\n    baseSome = require('./_baseSome'),\n    isArray = require('./isArray'),\n    isIterateeCall = require('./_isIterateeCall');\n\n/**\n * Checks if `predicate` returns truthy for **any** element of `collection`.\n * Iteration is stopped once `predicate` returns truthy. The predicate is\n * invoked with three arguments: (value, index|key, collection).\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n * @example\n *\n * _.some([null, 0, 'yes', false], Boolean);\n * // => true\n *\n * var users = [\n *   { 'user': 'barney', 'active': true },\n *   { 'user': 'fred',   'active': false }\n * ];\n *\n * // The `_.matches` iteratee shorthand.\n * _.some(users, { 'user': 'barney', 'active': false });\n * // => false\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.some(users, ['active', false]);\n * // => true\n *\n * // The `_.property` iteratee shorthand.\n * _.some(users, 'active');\n * // => true\n */\nfunction some(collection, predicate, guard) {\n  var func = isArray(collection) ? arraySome : baseSome;\n  if (guard && isIterateeCall(collection, predicate, guard)) {\n    predicate = undefined;\n  }\n  return func(collection, baseIteratee(predicate, 3));\n}\n\nmodule.exports = some;\n","var baseSum = require('./_baseSum'),\n    identity = require('./identity');\n\n/**\n * Computes the sum of the values in `array`.\n *\n * @static\n * @memberOf _\n * @since 3.4.0\n * @category Math\n * @param {Array} array The array to iterate over.\n * @returns {number} Returns the sum.\n * @example\n *\n * _.sum([4, 2, 8, 6]);\n * // => 20\n */\nfunction sum(array) {\n  return (array && array.length)\n    ? baseSum(array, identity)\n    : 0;\n}\n\nmodule.exports = sum;\n","var baseValues = require('./_baseValues'),\n    keys = require('./keys');\n\n/**\n * Creates an array of the own enumerable string keyed property values of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property values.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.values(new Foo);\n * // => [1, 2] (iteration order is not guaranteed)\n *\n * _.values('hi');\n * // => ['h', 'i']\n */\nfunction values(object) {\n  return object == null ? [] : baseValues(object, keys(object));\n}\n\nmodule.exports = values;\n","var asciiWords = require('./_asciiWords'),\n    hasUnicodeWord = require('./_hasUnicodeWord'),\n    toString = require('./toString'),\n    unicodeWords = require('./_unicodeWords');\n\n/**\n * Splits `string` into an array of its words.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category String\n * @param {string} [string=''] The string to inspect.\n * @param {RegExp|string} [pattern] The pattern to match words.\n * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n * @returns {Array} Returns the words of `string`.\n * @example\n *\n * _.words('fred, barney, & pebbles');\n * // => ['fred', 'barney', 'pebbles']\n *\n * _.words('fred, barney, & pebbles', /[^, ]+/g);\n * // => ['fred', 'barney', '&', 'pebbles']\n */\nfunction words(string, pattern, guard) {\n  string = toString(string);\n  pattern = guard ? undefined : pattern;\n\n  if (pattern === undefined) {\n    return hasUnicodeWord(string) ? unicodeWords(string) : asciiWords(string);\n  }\n  return string.match(pattern) || [];\n}\n\nmodule.exports = words;\n"],"names":["Collapse","props","ref","children","classes","className","collapsedHeight","_props$collapsedSize","collapsedSize","collapsedSizeProp","_props$component","component","Component","_props$disableStrictM","disableStrictModeCompat","inProp","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","_props$timeout","timeout","_props$TransitionComp","TransitionComponent","other","theme","timer","wrapperRef","autoTransitionDuration","concat","clearTimeout","current","enableStrictModeCompat","unstable_strictMode","nodeRef","handleRef","undefined","normalizedTransitionCallback","callback","nodeOrAppearing","maybeAppearing","_ref","_ref2","node","isAppearing","handleEnter","height","handleEntering","wrapperHeight","clientHeight","transitionDuration","mode","duration","duration2","transitions","getAutoHeightDuration","handleEntered","handleExit","handleExited","handleExiting","addEndListener","nodeOrNext","maybeNext","next","setTimeout","state","childProps","root","container","entered","hidden","minHeight","wrapper","wrapperInner","muiSupportAuto","overflow","transition","create","visibility","display","width","name","onClose","onClear","title","open","ConditionalWrapper","condition","_children","unmountOnExit","Box","alignItems","flexDirection","justifyContent","onClick","startIcon","src","id","exchanges","useExchangeList","Typography","variant","values","getExchangeNamesCombined","CustomButton","navigateReach","DataFeed","options","this","symbolsData","exchange","exchangeName","baseUrl","process","replace","allCandles","onReady","resolutions","supports_marks","supports_timescale_marks","supports_time","supported_resolutions","resolveSymbol","symbol","onSymbolResolvedCallback","onResolveErrorCallback","symbolData","symbolBaseQuote","base","quote","pricescale","Math","round","limits","price","min","tradeViewSymbol","toLowerCase","symbolFound","base_name","unitsAmount","unitsInvestment","description","full_name","has_daily","has_intraday","has_weekly_and_monthly","listed_exchange","minmov","session","data_status","ticker","type","getBarsRequest","resolution","periodParams","Error","getBars","onHistoryCallback","onErrorCallback","startDate","from","firstDataRequest","then","formattedCandles","length","noData","notifyPricesData","catch","e","message","subscribeBars","onRealtimeCallback","candleSubscription","setInterval","refreshBarRequest","candle","console","error","unsubscribeBars","clearInterval","getLastPrice","close","VcceDataFeed","getCandlesData","startTime","endTime","endpointPath","requestUrl","fetch","response","json","candles","parseOHLCV","time","parseFloat","high","low","volume","endDate","to","resolutionToMilliseconds","dayjs","startOf","unix","newCandles","map","lastCandle","AscendexDataFeed","ts","o","h","l","c","v","toUpperCase","valueOf","data","d","createWidgetOptions","darkStyle","feed","dataFeed","createDataFeed","datafeed","library_path","autosize","charts_storage_api_version","charts_storage_url","client_id","container_id","disabled_features","enabled_features","fullscreen","hide_side_toolbar","interval","locale","studies_overrides","user_id","timezone","Intl","DateTimeFormat","resolvedOptions","timeZone","calculateDcaPrice","dcaPercentage","calculateUnits","positionSize","contractType","multiplier","createSvgIcon","HelperLabel","labelId","descriptionId","intl","useIntl","Tooltip","arrow","enterTouchDelay","placement","formatMessage","FormHelperText","React","ProfitTargetStatus","profitTarget","iconColor","colors","done","orderId","skipped","Help","fill","defaultExpand","useState","expanded","expandClass","setExpanded","simulateInputChangeEvent","elementName","item","document","getElementsByName","_valueTracker","setValue","event","Event","bubbles","dispatchEvent","groupName","defaultCardinality","cardinality","setCardinality","useFormContext","getValues","cardinalityRange","String","useEffect","composeTargetPropertyName","propertyName","targetId","getGroupTargetId","target","closest","getAttribute","getTargetPropertyValue","draftPosition","targetPropertyName","getTargetPropertyRawValue","handleTargetAdd","handleTargetRemove","setTargetPropertyValue","value","positionEntity","watch","lastPrice","useContext","TradingViewContext","strategyPrice","units","priceDifference","currentPrice","getEntryPrice","buyPrice","getEntryPricePercentChange","getEntrySize","amount","getEntrySizeQuote","positionSizeQuote","getProfitPercentage","profitPercentage","lessThan","compare","side","errorId","errorValues","sideErrorText","greaterThan","validPercentage","validateCostLimits","cost","errorMessageGroup","limitsCost","max","validateUnitsLimits","limitsAmount","validateTargetPriceLimits","targetPrice","disabled","control","selectedExchange","useSelectedExchange","includes","FormControlLabel","defaultValue","render","onChange","Checkbox","checked","label","percentage","priorityName","defaultPriority","labelDescriptionId","status","errors","register","priorityValue","togglePriority","flexWrap","CustomNumberInput","allowNegative","Boolean","rules","validate","positive","showErrorMessage","TakeProfitPanel","isReadOnly","positionTargetsCardinality","takeProfitTargets","targetIndexes","useExpandable","useValidation","useSymbolLimitsValidate","clearErrors","trigger","dirtyFields","formState","useTargetGroup","entryType","strategyUnits","providerService","isCopyProvider","providerId","isCopyTrader","usePositionEntry","targetsDone","takeProfitTargetsCountSuccess","disableRemoveAction","isClosed","closed","isDisabled","parseInt","fieldsDisabled","forEach","index","getFieldsDisabledStatus","profitTargets","targetPricePercentageChange","priceProperty","targetPercentage","pricePercentageProperty","formatPrice","targetPriceChange","format2Dec","validateCumulativePercentage","exitUnitsPercentageFields","exitUnitsPercentages","Number","exitUnitsPercentageChange","unitsProperty","exitUnitsPercentageProperty","unitsPercentage","targetUnits","exitUnitsChange","unitsPercentageProperty","exitUnits","exitUnitsProperty","priceTargetPercentage","priceTarget","amountPercentage","pricePriority","postOnly","chainedPriceUpdates","currentValue","newValue","abs","sign","isNaN","useEffectSkipFirst","entrySize","displayTargetFieldErrors","targetProperty","validateTargetPricePercentage","Switch","size","key","sum","limit","validateUnitCostLimits","Button","RemoveCircle","AddCircle","DCATargetStatus","dcaTarget","cancel","errorMSG","dependencies","useRef","DCAPanel","rebuyTargets","reBuyTargets","dcaAllIndexes","dcaRebuyIndexes","filter","dcaIncreaseIndexes","dcaRebuyDoneCount","resolveDcaIndexes","activeDcaIncreaseIndexes","setActiveDCAIncreaseIndexes","strategyPositionSize","pricePriorityInit","Object","handleDcaIncreaseRemove","currentTarget","newDcaIncreaseIndexes","dcaExecutionIndex","validateDCAPriceLimit","targetPricePercentageRaw","targetPricePercentage","useDeepCompareEffect","triggerPercentage","formatFloat2Dec","quantityPercentage","quantity","targetPricePriority","targetPercentageProperty","rebuyPercentageProperty","getDcaExecutionIndex","getDCAPriority","displayDcaTarget","showRemove","rebuyPositionSize","validateUnits","rebuyPercentage","RadioGroup","row","Radio","StopLossStatus","selectedSymbol","defaultLeverage","leverage","entryStrategy","currentPriceShort","strategyPriceShort","providerAllocatedBalance","providerPayableBalance","updateUnits","toFixed","unitsShort","positionSizeChange","realInvestment","positionSizePercentageChange","positionSizePercentage","priceChange","realInvestmentChange","isValid","unitsChange","validatePositionSize","validatePrice","multiSide","validateSellAmount","composePositionDcaTargets","StopLossPanel","existsStopLoss","stopLossPrice","stopLossPercentage","entrySizeQuote","usePositionSizeHandlers","stopLossFollowsTakeProfit","stopLossToBreakEven","hasReachedTp","tp","stopLossTypeOptions","val","stopLossType","stopLossPriority","updateStopLoss","initialStopLossPercentage","valid","priceDiff","exchangeType","stopLossOrderId","mt","as","CustomSelect","TrailingStopPanel","existsTrailingStop","trailingStopPercentage","trailingStopDistanceRaw","trailingStopDistance","trailingStopPercentageRaw","trailingStopTriggerPercentage","isTriggered","trailingStopTriggered","trailingStopPrice","newPercentage","newDistance","percentageSign","distanceSign","trailingStopTriggerPrice","trailingStopTriggerPriority","newTrailingStopPercentage","exchangeInternalId","loading","setLoading","ownCopyTraderProviders","setOwnCopyTradersProviders","dispatch","useDispatch","payload","internalExchangeId","internalId","tradeApi","Array","isArray","digestedProviders","provider","providerName","showErrorAlert","finally","IncreaseStrategyPanel","expand","setExpand","reset","useAvailableBalance","balance","useStoreUserExchangeConnections","find","useOwnCopyTraderProviders","loadingProviders","baseBalance","quoteBalance","updatedAt","setProviderService","providerConsumedBalance","providerConsumedBalancePercentage","entryStrategyOptions","stopPrice","p","targetElement","FormControl","placeholder","CircularProgress","color","required","readOnly","ReduceOrderStatus","order","ReduceOrders","unregister","reduceOrders","removeReduceOrder","isRecurringPersistent","recurring","persistent","ids","displayReduceOrder","i","availablePercentage","newRemoveReduceOrder","ReduceStrategyPanel","reduceTargetPrice","setReduceTargetPrice","reduceTargetUnits","setReduceTargetUnits","remainAmount","reduceRecurring","reduceOrderType","reduceTargetPercentage","reduceAvailablePercentage","reducePersistent","orderTypeOptions","push","Alert","severity","entryPrice","toString","availableAmount","SidebarEditPanels","LeverageForm","setVal","useStoreSettingsSelector","onBlur","Slider","mark","thumb","track","markLabel","marks","step","marginMode","modalVisible","setModalVisible","showCross","leverageEditable","Modal","persist","maxLeverage","PriceControl","UnitsControl","StrategyPanel","bgcolor","EntryExpirationPanel","AutoclosePanel","SidebarCreatePanels","dcaTargets","composeTargetItem","targetRebuyPercentage","targetRebuyPrice","StrategyForm","notifyPositionUpdate","tradingViewWidget","isPositionView","handleSubmit","storeUserData","useStoreUserData","processing","setProcessing","dcaTargetPrice1","profitTargetPrice1","linesTracking","setLinesTracking","removeLine","existingChartLine","remove","drawLine","chartLineParams","chart","getPrice","setPrice","setQuantity","chartLine","createPositionLine","setText","setLineColor","setBodyTextColor","setBodyBorderColor","setQuantityBackgroundColor","setQuantityBorderColor","composePositionTakeProfitTargets","targetRange","targetExitUnitsPercentage","composePositionStrategy","strategy","buyType","mapEntryTypeToEnum","limitPrice","limitPrice_long","limitPrice_short","priceShort","orderType_long","orderType_short","composeCreatePositionPayload","buyTTL","entryExpiration","sellTTL","autoclose","pair","zignalyId","mapSideToEnum","minToSeconds","buyStopPrice","sellByTTL","hourToSeconds","composePositionPayload","takeProfitTargetPrices","targetFieldName","substr","dcaTargetPercentage1","isCopy","isCopyTrading","providerOwnerUserId","userId","isUpdating","updating","isOpening","textAlign","method","onSubmit","positionStrategy","positionId","removeReduceRecurringPersistent","reduceRecurringPersistent","composeUpdatePositionPayload","showSuccessAlert","updatePosition","navigate","createPosition","symbolsList","handleSymbolChange","storeSettings","symbolsOptions","setSymbolsOptions","providerOptions","initialProviderId","tradingTerminal","providerQuote","reduce","result","short","setTerminalPair","exchangeId","alignContent","search","setTerminalProvider","t","n","assign","mobile","widgetbar","details","watchlist","watchlist_settings","default_symbols","overrides","trading_customization","position","brokerConfig","configFlags","debug","logo","time_frames","text","favorites","intervals","chartTypes","_id","random","substring","_ready","_readyHandlers","_onWindowResize","_autoResizeChart","bind","_options","preset","warn","loading_screen","backgroundColor","_create","onChartReady","call","headerReady","_innerWindowLoaded","_innerWindow","onGrayedObjectClicked","_innerAPI","onShortcut","createShortcutAction","subscribe","unsubscribe","getLanguage","setSymbol","changeSymbol","window","removeEventListener","splice","_iFrame","parentNode","removeChild","closePopupsAndDialogs","selectLineTool","selectedLineTool","save","saveChart","load","loadChart","extendedData","getSavedCharts","loadChartFromServer","saveChartToServer","removeChartFromServer","onContextMenu","createButton","showNoticeDialog","showConfirmDialog","showLoadChartDialog","showSaveAsChartDialog","symbolInterval","getSymbolInterval","mainSeriesPriceFormatter","getIntervals","getStudiesList","addCustomCSSFile","applyOverrides","applyStudiesOverrides","watchList","activeChart","chartsCount","layout","setLayout","layoutName","changeTheme","getTheme","takeScreenshot","lockAllDrawingTools","hideAllDrawingTools","drawOnAllCharts","magnetEnabled","magnetMode","undoRedoState","setIntervalLinkingEnabled","setTimeFrame","symbolSync","intervalSync","crosshairSync","timeSync","getAllFeatures","clearUndoHistory","undo","redo","startFullscreen","exitFullscreen","takeClientScreenshot","tradingViewApi","contentWindow","innerHeight","_render","getElementById","innerHTML","querySelector","addEventListener","Promise","widgetReady","initializationFinished","customFormatters","custom_formatters","brokerFactory","broker_factory","studiesOverrides","tradingCustomization","disabledFeatures","enabledFeatures","broker_config","restConfig","numeric_formatting","rss_news_feed","newsProvider","news_provider","loadLastChart","load_last_chart","saveLoadAdapter","save_load_adapter","settingsAdapter","settings_adapter","getCustomIndicators","custom_indicators_getter","additionalSymbolInfoFields","additional_symbol_info_fields","headerWidgetButtonsMode","header_widget_buttons_mode","saved_data","chartContent","saved_data_meta_info","chartContentExtendedData","encodeURIComponent","timeframe","toolbar_bg","studies_access","JSON","stringify","drawings_access","custom_css_url","auto_save_delay","snapshot_url","study_count_limit","symbol_search_request_delay","compare_symbols","time_scale","TradingView","version","setLastPrice","widget","isSelfHosted","tradingView","setTradingView","readyCallback","removeWidget","tv","instantiateWidget","widgetOptions","widgetInstance","PrivateTradingViewWidget","checkExist","externalWidget","eventSymbol","handleWidgetReady","dataParsed","parse","original_name","receivedPrice","last_price","instantiateExternalLibrary","iframe","symbolTV","symbolCode","exchangeNameNormalized","mapExchangeConnectionToTradingViewId","getTradingViewExchangeSymbol","postMessage","setUpdatedAt","defaultExchangeSymbol","kucoin","binance","zignaly","bitmex","fallback","tradingViewContext","useTradingViewContext","useTradingTerminal","symbols","setSymbols","getMarketData","marketDataPayload","resolveSymbolData","setSelectedSymbol","s","defaultSelectedSymbol","selectedExchangeId","setSelectedExchangeId","isLoading","isLastPriceLoading","bootstrapWidget","methods","useForm","defaultValues","dcaTargetPricePercentage1","Provider","selectedOption","newSymbol","disableShrink","href","rel","TradingViewWrapper","useStoreUserSelector","loaded","ConnectExchange","TradingViewEdit","setPosition","positionRawData","setPositionRawData","recoverPositionLoading","setRecoverPositionLoading","createExchangeConnectionEmptyEntity","setExchange","exchangeConnections","fetchPosition","positionData","found","createMarketSymbolEmptyValueObject","baseId","quoteId","isAdmin","dcaRebuyPercentage1","PositionsTable","notifyPositionsUpdate","positionsList","newPosition","compareFields","Date","marginTop","maxWidth","minWidth","shouldExecute","setBalance","paperTrading","storeValues","optionsFilters","page","initialValues","keys","typeCorrect","valueCorrect","extractVal","filters","setFilters","lastOptionsFilters","filtersChecked","count","persistFilters","newFilters","setFiltersAction","clearFilters","modifiedFilters","entries","module","exports","array","iteratee","accumulator","initAccum","reAsciiWord","string","match","basePickBy","hasIn","object","paths","path","nativeCeil","ceil","nativeMax","start","end","fromRight","baseEach","collection","predicate","arrayMap","identity","arrayReduce","deburr","words","reApos","RegExp","baseRange","isIterateeCall","toFinite","toNumber","operator","deburrLetter","basePropertyOf","flatten","overRest","setToString","func","reHasUnicodeWord","test","rsDingbatRange","rsLowerRange","rsUpperRange","rsBreakRange","rsMathOpRange","rsBreak","rsDigits","rsDingbat","rsLower","rsMisc","rsRegional","rsSurrPair","rsUpper","rsMiscLower","rsMiscUpper","rsOptContrLower","rsOptContrUpper","reOptMod","rsModifier","rsOptVar","rsSeq","join","rsEmoji","reUnicodeWord","capitalize","camelCase","createCompounder","word","arrayPush","baseFlatten","copyArray","arguments","args","reLatin","reComboMark","baseFor","castFunction","keysIn","baseGt","gt","createRelationalOperation","baseGetTag","isObjectLike","baseLt","lt","basePick","pick","flatRest","range","createRange","arraySome","baseIteratee","baseSome","guard","baseSum","baseValues","asciiWords","hasUnicodeWord","unicodeWords","pattern"],"sourceRoot":""}